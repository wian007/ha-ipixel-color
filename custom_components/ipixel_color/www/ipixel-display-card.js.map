{
  "version": 3,
  "sources": ["src/version.js", "src/base.js", "src/styles.js", "src/font.js", "src/canvas-font.js", "lib/bdfparser.bundle.js", "src/bdf-font.js", "src/effects/text-effects.js", "src/effects/ambient-effects.js", "src/effects/color-effects.js", "src/effects/index.js", "src/canvas-renderer.js", "src/state.js", "src/cards/display-card.js", "src/cards/controls-card.js", "src/cards/text-card.js", "src/cards/playlist-card.js", "src/cards/schedule-card.js", "src/cards/editor-card.js", "src/editor.js", "src/index.js"],
  "sourcesContent": ["/**\n * Version information\n */\nexport const CARD_VERSION = '2.11.1';\n", "/**\n * Base class for all iPIXEL cards\n * Provides common functionality for entity management, service calls, etc.\n */\n\nexport class iPIXELCardBase extends HTMLElement {\n  constructor() {\n    super();\n    this.attachShadow({ mode: 'open' });\n    this._config = {};\n    this._hass = null;\n  }\n\n  set hass(hass) {\n    this._hass = hass;\n    this.render();\n  }\n\n  setConfig(config) {\n    if (!config.entity) throw new Error('Please define an entity');\n    this._config = config;\n    this.render();\n  }\n\n  getEntity() {\n    if (!this._hass || !this._config.entity) return null;\n    return this._hass.states[this._config.entity];\n  }\n\n  getRelatedEntity(domain, suffix = '') {\n    if (!this._hass || !this._config.entity) return null;\n\n    // Extract base name from config entity\n    const baseName = this._config.entity.replace(/^[^.]+\\./, '').replace(/_?(text|display|gif_url)$/i, '');\n\n    // Try exact match first\n    const exactId = `${domain}.${baseName}${suffix}`;\n    if (this._hass.states[exactId]) return this._hass.states[exactId];\n\n    // Search for matching entities in the domain\n    const matches = Object.keys(this._hass.states).filter(id => {\n      if (!id.startsWith(`${domain}.`)) return false;\n      const entityName = id.replace(/^[^.]+\\./, '');\n      return entityName.includes(baseName) || baseName.includes(entityName.replace(suffix, ''));\n    });\n\n    // Prefer entities without suffix for power switch, with suffix for others\n    if (suffix) {\n      const withSuffix = matches.find(id => id.endsWith(suffix));\n      if (withSuffix) return this._hass.states[withSuffix];\n    } else {\n      const sorted = matches.sort((a, b) => a.length - b.length);\n      if (sorted.length > 0) return this._hass.states[sorted[0]];\n    }\n\n    return matches.length > 0 ? this._hass.states[matches[0]] : null;\n  }\n\n  async callService(domain, service, data = {}) {\n    if (!this._hass) return;\n    try {\n      await this._hass.callService(domain, service, data);\n    } catch (err) {\n      console.error(`iPIXEL service call failed: ${domain}.${service}`, err);\n    }\n  }\n\n  getResolution() {\n    const widthEntity = this.getRelatedEntity('sensor', '_width') || this._hass?.states['sensor.display_width'];\n    const heightEntity = this.getRelatedEntity('sensor', '_height') || this._hass?.states['sensor.display_height'];\n    if (widthEntity && heightEntity) {\n      const w = parseInt(widthEntity.state), h = parseInt(heightEntity.state);\n      if (!isNaN(w) && !isNaN(h) && w > 0 && h > 0) return [w, h];\n    }\n    return [64, 16];\n  }\n\n  isOn() {\n    return this.getRelatedEntity('switch')?.state === 'on';\n  }\n\n  hexToRgb(hex) {\n    const r = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hex);\n    return r ? [parseInt(r[1], 16), parseInt(r[2], 16), parseInt(r[3], 16)] : [255, 255, 255];\n  }\n\n  render() { /* Override in subclasses */ }\n  getCardSize() { return 2; }\n}\n", "/**\n * Shared styles for all iPIXEL cards\n */\nexport const iPIXELCardStyles = `\n  :host {\n    --ipixel-primary: var(--primary-color, #03a9f4);\n    --ipixel-accent: var(--accent-color, #ff9800);\n    --ipixel-text: var(--primary-text-color, #fff);\n    --ipixel-bg: var(--ha-card-background, #1c1c1c);\n    --ipixel-border: var(--divider-color, #333);\n  }\n\n  .card-content { padding: 16px; }\n\n  .card-header {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    margin-bottom: 12px;\n  }\n\n  .card-title {\n    font-size: 1.1em;\n    font-weight: 500;\n    display: flex;\n    align-items: center;\n    gap: 8px;\n  }\n\n  .status-dot {\n    width: 8px;\n    height: 8px;\n    border-radius: 50%;\n    background: #4caf50;\n  }\n  .status-dot.off { background: #f44336; }\n  .status-dot.unavailable { background: #9e9e9e; }\n\n  .section-title {\n    font-size: 0.85em;\n    font-weight: 500;\n    margin-bottom: 8px;\n    opacity: 0.8;\n  }\n\n  .control-row { margin-bottom: 12px; }\n\n  /* Buttons */\n  .btn {\n    padding: 8px 16px;\n    border: none;\n    border-radius: 6px;\n    cursor: pointer;\n    font-size: 0.85em;\n    font-weight: 500;\n    transition: all 0.2s;\n  }\n  .btn-primary { background: var(--ipixel-primary); color: #fff; }\n  .btn-primary:hover { opacity: 0.9; }\n  .btn-secondary {\n    background: rgba(255,255,255,0.1);\n    color: var(--ipixel-text);\n    border: 1px solid var(--ipixel-border);\n  }\n  .btn-secondary:hover { background: rgba(255,255,255,0.15); }\n  .btn-danger { background: #f44336; color: #fff; }\n  .btn-success { background: #4caf50; color: #fff; }\n\n  .icon-btn {\n    width: 36px;\n    height: 36px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    background: rgba(255,255,255,0.1);\n    border: 1px solid var(--ipixel-border);\n    border-radius: 6px;\n    cursor: pointer;\n    color: inherit;\n  }\n  .icon-btn:hover { background: rgba(255,255,255,0.15); }\n  .icon-btn.active {\n    background: rgba(3, 169, 244, 0.3);\n    border-color: var(--ipixel-primary);\n  }\n  .icon-btn svg { width: 20px; height: 20px; fill: currentColor; }\n\n  /* Slider */\n  .slider-row { display: flex; align-items: center; gap: 12px; }\n  .slider-label { min-width: 70px; font-size: 0.85em; }\n  .slider {\n    flex: 1;\n    -webkit-appearance: none;\n    appearance: none;\n    height: 8px;\n    border-radius: 4px;\n    background: linear-gradient(to right,\n      var(--ipixel-primary) 0%,\n      var(--ipixel-primary) var(--value, 50%),\n      rgba(255,255,255,0.25) var(--value, 50%),\n      rgba(255,255,255,0.25) 100%);\n    outline: none;\n    cursor: pointer;\n  }\n  .slider::-webkit-slider-thumb {\n    -webkit-appearance: none;\n    width: 20px;\n    height: 20px;\n    border-radius: 50%;\n    background: #fff;\n    border: 3px solid var(--ipixel-primary);\n    cursor: pointer;\n    box-shadow: 0 2px 4px rgba(0,0,0,0.3);\n  }\n  .slider::-moz-range-thumb {\n    width: 20px;\n    height: 20px;\n    border-radius: 50%;\n    background: #fff;\n    border: 3px solid var(--ipixel-primary);\n    cursor: pointer;\n  }\n  .slider-value { min-width: 40px; text-align: right; font-size: 0.85em; font-weight: 500; }\n\n  /* Dropdown */\n  .dropdown {\n    width: 100%;\n    padding: 8px 12px;\n    background: rgba(255,255,255,0.08);\n    border: 1px solid var(--ipixel-border);\n    border-radius: 6px;\n    color: inherit;\n    font-size: 0.9em;\n    cursor: pointer;\n  }\n\n  /* Input */\n  .text-input {\n    width: 100%;\n    padding: 10px 12px;\n    background: rgba(255,255,255,0.08);\n    border: 1px solid var(--ipixel-border);\n    border-radius: 6px;\n    color: inherit;\n    font-size: 0.9em;\n    box-sizing: border-box;\n  }\n  .text-input:focus { outline: none; border-color: var(--ipixel-primary); }\n\n  /* Button Grid */\n  .button-grid { display: grid; gap: 8px; }\n  .button-grid-4 { grid-template-columns: repeat(4, 1fr); }\n  .button-grid-3 { grid-template-columns: repeat(3, 1fr); }\n  .button-grid-2 { grid-template-columns: repeat(2, 1fr); }\n\n  /* Mode buttons */\n  .mode-btn {\n    padding: 10px 8px;\n    background: rgba(255,255,255,0.08);\n    border: 1px solid var(--ipixel-border);\n    border-radius: 6px;\n    cursor: pointer;\n    text-align: center;\n    font-size: 0.8em;\n    color: inherit;\n    transition: all 0.2s;\n  }\n  .mode-btn:hover { background: rgba(255,255,255,0.12); }\n  .mode-btn.active { background: rgba(3, 169, 244, 0.25); border-color: var(--ipixel-primary); }\n\n  /* Color picker */\n  .color-row { display: flex; align-items: center; gap: 12px; }\n  .color-picker {\n    width: 40px;\n    height: 32px;\n    padding: 0;\n    border: 1px solid var(--ipixel-border);\n    border-radius: 4px;\n    cursor: pointer;\n    background: none;\n  }\n\n  /* List items */\n  .list-item {\n    display: flex;\n    align-items: center;\n    padding: 10px 12px;\n    background: rgba(255,255,255,0.05);\n    border-radius: 6px;\n    margin-bottom: 8px;\n    gap: 12px;\n  }\n  .list-item:last-child { margin-bottom: 0; }\n  .list-item-info { flex: 1; }\n  .list-item-name { font-weight: 500; font-size: 0.9em; }\n  .list-item-meta { font-size: 0.75em; opacity: 0.6; margin-top: 2px; }\n  .list-item-actions { display: flex; gap: 4px; }\n\n  /* Empty state */\n  .empty-state { text-align: center; padding: 24px; opacity: 0.6; font-size: 0.9em; }\n\n  @media (max-width: 400px) {\n    .button-grid-4 { grid-template-columns: repeat(2, 1fr); }\n  }\n`;\n", "/**\n * 5x7 Pixel font for LED display rendering\n * Each character is represented as 5 bytes (columns), with bits representing rows\n */\n\nexport const pixelFont = {\n  // Uppercase letters (full height)\n  'A': [0x7C,0x12,0x11,0x12,0x7C], 'B': [0x7F,0x49,0x49,0x49,0x36], 'C': [0x3E,0x41,0x41,0x41,0x22],\n  'D': [0x7F,0x41,0x41,0x22,0x1C], 'E': [0x7F,0x49,0x49,0x49,0x41], 'F': [0x7F,0x09,0x09,0x09,0x01],\n  'G': [0x3E,0x41,0x49,0x49,0x7A], 'H': [0x7F,0x08,0x08,0x08,0x7F], 'I': [0x00,0x41,0x7F,0x41,0x00],\n  'J': [0x20,0x40,0x41,0x3F,0x01], 'K': [0x7F,0x08,0x14,0x22,0x41], 'L': [0x7F,0x40,0x40,0x40,0x40],\n  'M': [0x7F,0x02,0x0C,0x02,0x7F], 'N': [0x7F,0x04,0x08,0x10,0x7F], 'O': [0x3E,0x41,0x41,0x41,0x3E],\n  'P': [0x7F,0x09,0x09,0x09,0x06], 'Q': [0x3E,0x41,0x51,0x21,0x5E], 'R': [0x7F,0x09,0x19,0x29,0x46],\n  'S': [0x46,0x49,0x49,0x49,0x31], 'T': [0x01,0x01,0x7F,0x01,0x01], 'U': [0x3F,0x40,0x40,0x40,0x3F],\n  'V': [0x1F,0x20,0x40,0x20,0x1F], 'W': [0x3F,0x40,0x38,0x40,0x3F], 'X': [0x63,0x14,0x08,0x14,0x63],\n  'Y': [0x07,0x08,0x70,0x08,0x07], 'Z': [0x61,0x51,0x49,0x45,0x43],\n\n  // Lowercase letters (smaller x-height, with ascenders/descenders)\n  'a': [0x20,0x54,0x54,0x54,0x78], 'b': [0x7F,0x48,0x44,0x44,0x38], 'c': [0x38,0x44,0x44,0x44,0x20],\n  'd': [0x38,0x44,0x44,0x48,0x7F], 'e': [0x38,0x54,0x54,0x54,0x18], 'f': [0x08,0x7E,0x09,0x01,0x02],\n  'g': [0x0C,0x52,0x52,0x52,0x3E], 'h': [0x7F,0x08,0x04,0x04,0x78], 'i': [0x00,0x44,0x7D,0x40,0x00],\n  'j': [0x20,0x40,0x44,0x3D,0x00], 'k': [0x7F,0x10,0x28,0x44,0x00], 'l': [0x00,0x41,0x7F,0x40,0x00],\n  'm': [0x7C,0x04,0x18,0x04,0x78], 'n': [0x7C,0x08,0x04,0x04,0x78], 'o': [0x38,0x44,0x44,0x44,0x38],\n  'p': [0x7C,0x14,0x14,0x14,0x08], 'q': [0x08,0x14,0x14,0x18,0x7C], 'r': [0x7C,0x08,0x04,0x04,0x08],\n  's': [0x48,0x54,0x54,0x54,0x20], 't': [0x04,0x3F,0x44,0x40,0x20], 'u': [0x3C,0x40,0x40,0x20,0x7C],\n  'v': [0x1C,0x20,0x40,0x20,0x1C], 'w': [0x3C,0x40,0x30,0x40,0x3C], 'x': [0x44,0x28,0x10,0x28,0x44],\n  'y': [0x0C,0x50,0x50,0x50,0x3C], 'z': [0x44,0x64,0x54,0x4C,0x44],\n\n  // Numbers\n  '0': [0x3E,0x51,0x49,0x45,0x3E], '1': [0x00,0x42,0x7F,0x40,0x00], '2': [0x42,0x61,0x51,0x49,0x46],\n  '3': [0x21,0x41,0x45,0x4B,0x31], '4': [0x18,0x14,0x12,0x7F,0x10], '5': [0x27,0x45,0x45,0x45,0x39],\n  '6': [0x3C,0x4A,0x49,0x49,0x30], '7': [0x01,0x71,0x09,0x05,0x03], '8': [0x36,0x49,0x49,0x49,0x36],\n  '9': [0x06,0x49,0x49,0x29,0x1E],\n\n  // Punctuation & symbols\n  ' ': [0x00,0x00,0x00,0x00,0x00], '.': [0x00,0x60,0x60,0x00,0x00], ',': [0x00,0x80,0x60,0x00,0x00],\n  ':': [0x00,0x36,0x36,0x00,0x00], ';': [0x00,0x80,0x36,0x00,0x00], '!': [0x00,0x00,0x5F,0x00,0x00],\n  '?': [0x02,0x01,0x51,0x09,0x06], '-': [0x08,0x08,0x08,0x08,0x08], '+': [0x08,0x08,0x3E,0x08,0x08],\n  '=': [0x14,0x14,0x14,0x14,0x14], '_': [0x40,0x40,0x40,0x40,0x40], '/': [0x20,0x10,0x08,0x04,0x02],\n  '\\\\': [0x02,0x04,0x08,0x10,0x20], '(': [0x00,0x1C,0x22,0x41,0x00], ')': [0x00,0x41,0x22,0x1C,0x00],\n  '[': [0x00,0x7F,0x41,0x41,0x00], ']': [0x00,0x41,0x41,0x7F,0x00], '<': [0x08,0x14,0x22,0x41,0x00],\n  '>': [0x00,0x41,0x22,0x14,0x08], '*': [0x14,0x08,0x3E,0x08,0x14], '#': [0x14,0x7F,0x14,0x7F,0x14],\n  '@': [0x3E,0x41,0x5D,0x55,0x1E], '&': [0x36,0x49,0x55,0x22,0x50], '%': [0x23,0x13,0x08,0x64,0x62],\n  '$': [0x12,0x2A,0x7F,0x2A,0x24], \"'\": [0x00,0x00,0x07,0x00,0x00], '\"': [0x00,0x07,0x00,0x07,0x00],\n  '`': [0x00,0x01,0x02,0x00,0x00], '^': [0x04,0x02,0x01,0x02,0x04], '~': [0x08,0x04,0x08,0x10,0x08],\n};\n\n/**\n * Render text to a pixel array (centered, clipped to display width)\n * @param {string} text - Text to render\n * @param {number} width - Display width in pixels\n * @param {number} height - Display height in pixels\n * @param {string} fgColor - Foreground color (hex)\n * @param {string} bgColor - Background color (hex)\n * @returns {string[]} Array of color values for each pixel\n */\nexport function textToPixels(text, width, height, fgColor = '#ff6600', bgColor = '#111') {\n  const pixels = [];\n  const charWidth = 6; // 5 pixels + 1 space\n  const charHeight = 7;\n  const startY = Math.floor((height - charHeight) / 2);\n\n  // Initialize all pixels to background\n  for (let y = 0; y < height; y++) {\n    for (let x = 0; x < width; x++) {\n      pixels.push(bgColor);\n    }\n  }\n\n  // Calculate text width for centering (preserve original case)\n  const textWidth = text.length * charWidth - 1;\n  const startX = Math.max(1, Math.floor((width - textWidth) / 2));\n\n  // Render each character (centered, case-sensitive)\n  let xOffset = startX;\n  for (const char of text) {\n    const charData = pixelFont[char] || pixelFont[' '];\n    for (let col = 0; col < 5; col++) {\n      for (let row = 0; row < 7; row++) {\n        const pixelOn = (charData[col] >> row) & 1;\n        const px = xOffset + col;\n        const py = startY + row;\n        if (px >= 0 && px < width && py < height && py >= 0) {\n          pixels[py * width + px] = pixelOn ? fgColor : bgColor;\n        }\n      }\n    }\n    xOffset += charWidth;\n  }\n  return pixels;\n}\n\n/**\n * Render text to an extended pixel array for scrolling\n * The width is: displayWidth + textWidth + displayWidth (for seamless wrap)\n * @param {string} text - Text to render\n * @param {number} displayWidth - Display width in pixels\n * @param {number} height - Display height in pixels\n * @param {string} fgColor - Foreground color (hex)\n * @param {string} bgColor - Background color (hex)\n * @returns {{ pixels: string[], width: number }} Extended pixel array and its width\n */\nexport function textToScrollPixels(text, displayWidth, height, fgColor = '#ff6600', bgColor = '#111') {\n  const charWidth = 6; // 5 pixels + 1 space\n  const charHeight = 7;\n  const startY = Math.floor((height - charHeight) / 2);\n\n  // Calculate the text width in pixels\n  const textPixelWidth = text.length * charWidth;\n\n  // Extended width: display + text + display (for seamless loop)\n  const extendedWidth = displayWidth + textPixelWidth + displayWidth;\n\n  // Initialize all pixels to background\n  const pixels = [];\n  for (let y = 0; y < height; y++) {\n    for (let x = 0; x < extendedWidth; x++) {\n      pixels.push(bgColor);\n    }\n  }\n\n  // Render text starting after one display width of padding\n  let xOffset = displayWidth;\n  for (const char of text) {\n    const charData = pixelFont[char] || pixelFont[' '];\n    for (let col = 0; col < 5; col++) {\n      for (let row = 0; row < 7; row++) {\n        const pixelOn = (charData[col] >> row) & 1;\n        const px = xOffset + col;\n        const py = startY + row;\n        if (px >= 0 && px < extendedWidth && py < height && py >= 0) {\n          pixels[py * extendedWidth + px] = pixelOn ? fgColor : bgColor;\n        }\n      }\n    }\n    xOffset += charWidth;\n  }\n\n  return { pixels, width: extendedWidth };\n}\n", "/**\n * Canvas-based font renderer matching pypixelcolor output\n * Uses the same TTF fonts and rendering metrics as the device\n */\n\n// Font metrics from pypixelcolor JSON files\n// These match the JSON metadata in pypixelcolor/fonts/*.json\nconst FONT_METRICS = {\n  'VCR_OSD_MONO': {\n    16: { font_size: 16, offset: [0, 0], pixel_threshold: 70, var_width: true },\n    24: { font_size: 24, offset: [0, 0], pixel_threshold: 70, var_width: true },\n    32: { font_size: 28, offset: [-1, 2], pixel_threshold: 30, var_width: false }\n  },\n  'CUSONG': {\n    16: { font_size: 16, offset: [0, -1], pixel_threshold: 70, var_width: false },\n    24: { font_size: 24, offset: [0, 0], pixel_threshold: 70, var_width: false },\n    32: { font_size: 32, offset: [0, 0], pixel_threshold: 70, var_width: false }\n  }\n};\n\n// Font loading state\nconst fontLoadState = {};\nconst fontLoadPromises = {};\n\n/**\n * Get the base URL for font files\n * Handles HACS, manual installation, local preview, and GitHub Pages paths\n */\nfunction getFontUrl(fontName) {\n  // Detect Home Assistant by checking for HA-specific globals or URL patterns\n  const isHomeAssistant = typeof window.hassConnection !== 'undefined' ||\n                          window.location.pathname.includes('/lovelace') ||\n                          window.location.pathname.includes('/dashboard') ||\n                          document.querySelector('home-assistant') !== null;\n\n  if (isHomeAssistant) {\n    // HACS path for Home Assistant\n    return `/hacsfiles/ipixel_color/fonts/${fontName}.ttf`;\n  }\n\n  // For GitHub Pages, local preview, or any non-HA environment\n  // Check if we're in a subdirectory (e.g., /ha-ipixel-color/)\n  const basePath = window.location.pathname.substring(0, window.location.pathname.lastIndexOf('/') + 1);\n  return `${basePath}fonts/${fontName}.ttf`;\n}\n\n/**\n * Load TTF font as @font-face\n * @param {string} fontName - Name of the font to load (VCR_OSD_MONO, CUSONG)\n * @returns {Promise<boolean>} - True if font loaded successfully\n */\nexport async function loadFont(fontName) {\n  // Return cached result if already loaded\n  if (fontLoadState[fontName] === true) return true;\n  if (fontLoadState[fontName] === false) return false;\n\n  // Return existing promise if loading in progress\n  if (fontLoadPromises[fontName]) return fontLoadPromises[fontName];\n\n  // Start loading\n  fontLoadPromises[fontName] = (async () => {\n    const fontUrl = getFontUrl(fontName);\n\n    try {\n      const font = new FontFace(fontName, `url(${fontUrl})`);\n      const loadedFont = await font.load();\n      document.fonts.add(loadedFont);\n      fontLoadState[fontName] = true;\n      console.log(`iPIXEL: Font ${fontName} loaded successfully`);\n      return true;\n    } catch (e) {\n      console.warn(`iPIXEL: Failed to load font ${fontName}:`, e);\n      fontLoadState[fontName] = false;\n      return false;\n    }\n  })();\n\n  return fontLoadPromises[fontName];\n}\n\n/**\n * Check if a font is loaded\n * @param {string} fontName - Name of the font to check\n * @returns {boolean} - True if font is loaded\n */\nexport function isFontLoaded(fontName) {\n  return fontLoadState[fontName] === true;\n}\n\n/**\n * Get closest height key for font metrics (16, 24, or 32)\n * @param {number} height - Display height in pixels\n * @returns {number} - Closest metrics key\n */\nfunction getHeightKey(height) {\n  if (height <= 18) return 16;\n  if (height <= 28) return 24;\n  return 32;\n}\n\n/**\n * Convert hex color to RGB object\n * @param {string} hex - Hex color string (e.g., '#ff6600')\n * @returns {{r: number, g: number, b: number}} - RGB object\n */\nfunction hexToRgb(hex) {\n  const result = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hex);\n  return result ? {\n    r: parseInt(result[1], 16),\n    g: parseInt(result[2], 16),\n    b: parseInt(result[3], 16)\n  } : { r: 0, g: 0, b: 0 };\n}\n\n/**\n * Render text to pixels using Canvas (matches pypixelcolor output)\n * @param {string} text - Text to render\n * @param {number} width - Display width in pixels\n * @param {number} height - Display height in pixels\n * @param {string} fgColor - Foreground color (hex)\n * @param {string} bgColor - Background color (hex)\n * @param {string} fontName - Font name (VCR_OSD_MONO, CUSONG)\n * @returns {string[]|null} - Array of hex color strings, or null if font not available\n */\nexport function textToPixelsCanvas(text, width, height, fgColor = '#ff6600', bgColor = '#111', fontName = 'VCR_OSD_MONO') {\n  // Check if font metrics exist\n  const fontMetrics = FONT_METRICS[fontName];\n  if (!fontMetrics) {\n    console.warn(`iPIXEL: Unknown font: ${fontName}`);\n    return null;\n  }\n\n  // Check if font is loaded\n  if (!isFontLoaded(fontName)) {\n    // Try to load it (non-blocking, will return null this time)\n    loadFont(fontName);\n    return null;\n  }\n\n  // Get metrics for this height\n  const heightKey = getHeightKey(height);\n  const metrics = fontMetrics[heightKey];\n\n  // Create canvas\n  const canvas = document.createElement('canvas');\n  canvas.width = width;\n  canvas.height = height;\n  const ctx = canvas.getContext('2d');\n\n  // Disable anti-aliasing for crisp pixel rendering\n  ctx.imageSmoothingEnabled = false;\n\n  // Fill background\n  ctx.fillStyle = bgColor;\n  ctx.fillRect(0, 0, width, height);\n\n  // Handle empty text\n  if (!text || text.trim() === '') {\n    const pixels = [];\n    for (let i = 0; i < width * height; i++) {\n      pixels.push(bgColor);\n    }\n    return pixels;\n  }\n\n  // Set font\n  ctx.font = `${metrics.font_size}px \"${fontName}\"`;\n  ctx.fillStyle = fgColor;\n  ctx.textBaseline = 'top';\n\n  // Measure text for centering\n  const textMetrics = ctx.measureText(text);\n  const textWidth = textMetrics.width;\n\n  // Center text with offset from metrics\n  const x = Math.floor((width - textWidth) / 2) + metrics.offset[0];\n  const y = Math.floor((height - metrics.font_size) / 2) + metrics.offset[1];\n\n  // Draw text\n  ctx.fillText(text, x, y);\n\n  // Extract pixels with threshold\n  const imageData = ctx.getImageData(0, 0, width, height);\n  const pixels = [];\n\n  // Parse foreground and background colors\n  const fg = hexToRgb(fgColor);\n  const bg = hexToRgb(bgColor);\n\n  for (let i = 0; i < imageData.data.length; i += 4) {\n    const r = imageData.data[i];\n    const g = imageData.data[i + 1];\n    const b = imageData.data[i + 2];\n\n    // Convert to grayscale and apply threshold\n    // pypixelcolor uses simple average: (r + g + b) / 3\n    const gray = (r + g + b) / 3;\n\n    if (gray >= metrics.pixel_threshold) {\n      pixels.push(fgColor);\n    } else {\n      pixels.push(bgColor);\n    }\n  }\n\n  return pixels;\n}\n\n/**\n * Render text for scrolling (extended width for seamless loop)\n * @param {string} text - Text to render\n * @param {number} displayWidth - Display width in pixels\n * @param {number} height - Display height in pixels\n * @param {string} fgColor - Foreground color (hex)\n * @param {string} bgColor - Background color (hex)\n * @param {string} fontName - Font name\n * @returns {{pixels: string[], width: number}|null} - Extended pixel array and width, or null\n */\nexport function textToScrollPixelsCanvas(text, displayWidth, height, fgColor = '#ff6600', bgColor = '#111', fontName = 'VCR_OSD_MONO') {\n  // Check if font metrics exist\n  const fontMetrics = FONT_METRICS[fontName];\n  if (!fontMetrics) {\n    return null;\n  }\n\n  // Check if font is loaded\n  if (!isFontLoaded(fontName)) {\n    loadFont(fontName);\n    return null;\n  }\n\n  // Get metrics for this height\n  const heightKey = getHeightKey(height);\n  const metrics = fontMetrics[heightKey];\n\n  // Create temporary canvas to measure text width\n  const tempCanvas = document.createElement('canvas');\n  const tempCtx = tempCanvas.getContext('2d');\n  tempCtx.font = `${metrics.font_size}px \"${fontName}\"`;\n  const textWidth = Math.ceil(tempCtx.measureText(text).width);\n\n  // Extended width: display + text + display (for seamless loop)\n  const extendedWidth = displayWidth + textWidth + displayWidth;\n\n  // Create canvas with extended width\n  const canvas = document.createElement('canvas');\n  canvas.width = extendedWidth;\n  canvas.height = height;\n  const ctx = canvas.getContext('2d');\n  ctx.imageSmoothingEnabled = false;\n\n  // Fill background\n  ctx.fillStyle = bgColor;\n  ctx.fillRect(0, 0, extendedWidth, height);\n\n  // Handle empty text\n  if (!text || text.trim() === '') {\n    const pixels = [];\n    for (let i = 0; i < extendedWidth * height; i++) {\n      pixels.push(bgColor);\n    }\n    return { pixels, width: extendedWidth };\n  }\n\n  // Set font\n  ctx.font = `${metrics.font_size}px \"${fontName}\"`;\n  ctx.fillStyle = fgColor;\n  ctx.textBaseline = 'top';\n\n  // Draw text starting after one display width of padding\n  const x = displayWidth + metrics.offset[0];\n  const y = Math.floor((height - metrics.font_size) / 2) + metrics.offset[1];\n  ctx.fillText(text, x, y);\n\n  // Extract pixels with threshold\n  const imageData = ctx.getImageData(0, 0, extendedWidth, height);\n  const pixels = [];\n\n  for (let i = 0; i < imageData.data.length; i += 4) {\n    const r = imageData.data[i];\n    const g = imageData.data[i + 1];\n    const b = imageData.data[i + 2];\n\n    const gray = (r + g + b) / 3;\n\n    if (gray >= metrics.pixel_threshold) {\n      pixels.push(fgColor);\n    } else {\n      pixels.push(bgColor);\n    }\n  }\n\n  return { pixels, width: extendedWidth };\n}\n\n/**\n * Preload all available fonts\n */\nexport async function preloadFonts() {\n  const fonts = Object.keys(FONT_METRICS);\n  await Promise.all(fonts.map(loadFont));\n}\n\nexport { FONT_METRICS };\n", "/**\n * BDF Parser Bundle for ha-ipixel-color\n * Combines bdfparser (v2.2.5) and fetchline (v1.0.1) from jsDelivr CDN\n *\n * Sources:\n * - bdfparser: https://github.com/tomchen/bdfparser-js\n * - fetchline: https://github.com/nicehunter/fetchline\n */\n\n// ============= fetchline (v1.0.1) =============\nvar fetchline_e=function(e,n,t,r){return new(t||(t=Promise))((function(o,i){function c(e){try{l(r.next(e))}catch(e){i(e)}}function u(e){try{l(r.throw(e))}catch(e){i(e)}}function l(e){var n;e.done?o(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(c,u)}l((r=r.apply(e,n||[])).next())}))},fetchline_n=function(e){return this instanceof fetchline_n?(this.v=e,this):new fetchline_n(e)},fetchline_t=function(e,t,r){if(!Symbol.asyncIterator)throw new TypeError(\"Symbol.asyncIterator is not defined.\");var o,i=r.apply(e,t||[]),c=[];return o={},u(\"next\"),u(\"throw\"),u(\"return\"),o[Symbol.asyncIterator]=function(){return this},o;function u(e){i[e]&&(o[e]=function(n){return new Promise((function(t,r){c.push([e,n,t,r])>1||l(e,n)}))})}function l(e,t){try{(r=i[e](t)).value instanceof fetchline_n?Promise.resolve(r.value.v).then(s,a):f(c[0][2],r)}catch(e){f(c[0][3],e)}var r}function s(e){l(\"next\",e)}function a(e){l(\"throw\",e)}function f(e,n){e(n),c.shift(),c.length&&l(c[0][0],c[0][1])}};\n\nfunction $fetchline(r,{includeLastEmptyLine:o=!0,encoding:i=\"utf-8\",delimiter:c=/\\r?\\n/g}={}){return fetchline_t(this,arguments,(function*(){const t=yield fetchline_n((n=>fetchline_e(void 0,void 0,void 0,(function*(){const e=yield fetch(n);if(null===e.body)throw new Error(\"Cannot read file\");return e.body.getReader()})))(r));let{value:u,done:l}=yield fetchline_n(t.read());const s=new TextDecoder(i);let a,f=u?s.decode(u):\"\";if(\"string\"==typeof c){if(\"\"===c)throw new Error(\"delimiter cannot be empty string!\");a=new RegExp(c.replace(/[.*+\\-?^${}()|[\\]\\\\]/g,\"\\\\$&\"),\"g\")}else a=!1===/g/.test(c.flags)?new RegExp(c.source,c.flags+\"g\"):c;let d=0;for(;;){const e=a.exec(f);if(null!==e)yield yield fetchline_n(f.substring(d,e.index)),d=a.lastIndex;else{if(!0===l)break;const e=f.substring(d);({value:u,done:l}=yield fetchline_n(t.read())),f=e+(f?s.decode(u):\"\"),d=0}}(o||d<f.length)&&(yield yield fetchline_n(f.substring(d)))}))}\n\n// ============= bdfparser (v2.2.5) =============\nvar t=function(t,e,n,r){return new(n||(n=Promise))((function(i,s){function a(t){try{l(r.next(t))}catch(t){s(t)}}function o(t){try{l(r.throw(t))}catch(t){s(t)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,o)}l((r=r.apply(t,e||[])).next())}))},e=function(t){if(!Symbol.asyncIterator)throw new TypeError(\"Symbol.asyncIterator is not defined.\");var e,n=t[Symbol.asyncIterator];return n?n.call(t):(t=\"function\"==typeof __values?__values(t):t[Symbol.iterator](),e={},r(\"next\"),r(\"throw\"),r(\"return\"),e[Symbol.asyncIterator]=function(){return this},e);function r(n){e[n]=t[n]&&function(e){return new Promise((function(r,i){(function(t,e,n,r){Promise.resolve(r).then((function(e){t({value:e,done:n})}),e)})(r,i,(e=t[n](e)).done,e.value)}))}}};const n=\"[\\\\s]+\",r={glyphname:\"empty\",codepoint:8203,bbw:0,bbh:0,bbxoff:0,bbyoff:0,swx0:0,swy0:0,dwx0:0,dwy0:0,swx1:0,swy1:0,dwx1:0,dwy1:0,vvectorx:0,vvectory:0,hexdata:[]},i=[\"glyphname\",\"codepoint\",\"bbw\",\"bbh\",\"bbxoff\",\"bbyoff\",\"swx0\",\"swy0\",\"dwx0\",\"dwy0\",\"swx1\",\"swy1\",\"dwx1\",\"dwy1\",\"vvectorx\",\"vvectory\",\"hexdata\"],s={lr:\"lrtb\",rl:\"rltb\",tb:\"tbrl\",bt:\"btrl\",lrtb:void 0,lrbt:void 0,rltb:void 0,rlbt:void 0,tbrl:void 0,tblr:void 0,btrl:void 0,btlr:void 0},a={lr:1,rl:2,tb:0,bt:-1};class o{constructor(){this.headers=void 0,this.__headers={},this.props={},this.glyphs=new Map,this.__glyph_count_to_check=null,this.__curline_startchar=null,this.__curline_chars=null}load_filelines(n){var r,i;return t(this,void 0,void 0,(function*(){try{this.__f=n,yield this.__parse_headers()}finally{if(\"undefined\"!=typeof Deno&&void 0!==this.__f)try{for(var t,s=e(this.__f);!(t=yield s.next()).done;){t.value}}catch(t){r={error:t}}finally{try{t&&!t.done&&(i=s.return)&&(yield i.call(s))}finally{if(r)throw r.error}}}return this}))}__parse_headers(){var e,r;return t(this,void 0,void 0,(function*(){for(;;){const t=null===(r=yield null===(e=this.__f)||void 0===e?void 0:e.next())||void 0===r?void 0:r.value,i=t.split(/ (.+)/,2),s=i.length;let a;if(2===s){const e=i[0],r=i[1].trim();switch(e){case\"STARTFONT\":this.__headers.bdfversion=parseFloat(r);break;case\"FONT\":this.__headers.fontname=r;break;case\"SIZE\":a=r.split(\" \"),this.__headers.pointsize=parseInt(a[0],10),this.__headers.xres=parseInt(a[1],10),this.__headers.yres=parseInt(a[2],10);break;case\"FONTBOUNDINGBOX\":a=r.split(\" \"),this.__headers.fbbx=parseInt(a[0],10),this.__headers.fbby=parseInt(a[1],10),this.__headers.fbbxoff=parseInt(a[2],10),this.__headers.fbbyoff=parseInt(a[3],10);break;case\"STARTPROPERTIES\":return this.__parse_headers_after(),void(yield this.__parse_props());case\"COMMENT\":\"comment\"in this.__headers&&Array.isArray(this.__headers.comment)||(this.__headers.comment=[]),this.__headers.comment.push(r.replace(/^[\\s\"'\\t\\r\\n]+|[\\s\"'\\t\\r\\n]+$/g,\"\"));break;case\"SWIDTH\":a=r.split(\" \"),this.__headers.swx0=parseInt(a[0],10),this.__headers.swy0=parseInt(a[1],10);break;case\"DWIDTH\":a=r.split(\" \"),this.__headers.dwx0=parseInt(a[0],10),this.__headers.dwy0=parseInt(a[1],10);break;case\"SWIDTH1\":a=r.split(\" \"),this.__headers.swx1=parseInt(a[0],10),this.__headers.swy1=parseInt(a[1],10);break;case\"DWIDTH1\":a=r.split(\" \"),this.__headers.dwx1=parseInt(a[0],10),this.__headers.dwy1=parseInt(a[1],10);break;case\"VVECTOR\":a=n.split(r),this.__headers.vvectorx=parseInt(a[0],10),this.__headers.vvectory=parseInt(a[1],10);break;case\"METRICSSET\":case\"CONTENTVERSION\":this.__headers[e.toLowerCase()]=parseInt(r,10);break;case\"CHARS\":return console.warn(\"It looks like the font does not have property block beginning with 'STARTPROPERTIES' keyword\"),this.__parse_headers_after(),this.__curline_chars=t,void(yield this.__parse_glyph_count());case\"STARTCHAR\":return console.warn(\"It looks like the font does not have property block beginning with 'STARTPROPERTIES' keyword\"),console.warn(\"Cannot find 'CHARS' line\"),this.__parse_headers_after(),this.__curline_startchar=t,void(yield this.__prepare_glyphs())}}if(1===s&&\"ENDFONT\"===i[0].trim())return console.warn(\"It looks like the font does not have property block beginning with 'STARTPROPERTIES' keyword\"),void console.warn(\"This font does not have any glyphs\")}}))}__parse_headers_after(){\"metricsset\"in this.__headers||(this.__headers.metricsset=0),this.headers=this.__headers}__parse_props(){var e,n;return t(this,void 0,void 0,(function*(){for(;;){const t=(null===(n=yield null===(e=this.__f)||void 0===e?void 0:e.next())||void 0===n?void 0:n.value).split(/ (.+)/,2),r=t.length;if(2===r){const e=t[0],n=t[1].replace(/^[\\s\"'\\t\\r\\n]+|[\\s\"'\\t\\r\\n]+$/g,\"\");\"COMMENT\"===e?(\"comment\"in this.props&&Array.isArray(this.props.comment)||(this.props.comment=[]),this.props.comment.push(n.replace(/^[\\s\"'\\t\\r\\n]+|[\\s\"'\\t\\r\\n]+$/g,\"\"))):this.props[e.toLowerCase()]=n}else if(1===r){const e=t[0].trim();if(\"ENDPROPERTIES\"===e)return void(yield this.__parse_glyph_count());if(\"ENDFONT\"===e)return void console.warn(\"This font does not have any glyphs\");this.props[e]=null}}}))}__parse_glyph_count(){var e,n;return t(this,void 0,void 0,(function*(){let t;if(null===this.__curline_chars?t=null===(n=yield null===(e=this.__f)||void 0===e?void 0:e.next())||void 0===n?void 0:n.value:(t=this.__curline_chars,this.__curline_chars=null),\"ENDFONT\"===t.trim())return void console.warn(\"This font does not have any glyphs\");const r=t.split(/ (.+)/,2);\"CHARS\"===r[0]?this.__glyph_count_to_check=parseInt(r[1].trim(),10):(this.__curline_startchar=t,console.warn(\"Cannot find 'CHARS' line next to 'ENDPROPERTIES' line\")),yield this.__prepare_glyphs()}))}__prepare_glyphs(){var e,r;return t(this,void 0,void 0,(function*(){let t=0,i=[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],s=[],a=!1,o=!1;for(;;){let l;if(null===this.__curline_startchar?l=null===(r=yield null===(e=this.__f)||void 0===e?void 0:e.next())||void 0===r?void 0:r.value:(l=this.__curline_startchar,this.__curline_startchar=null),null==l)return console.warn(\"This font does not have 'ENDFONT' keyword\"),void this.__prepare_glyphs_after();const h=l.split(/ (.+)/,2),c=h.length;if(2===c){const e=h[0],r=h[1].trim();let s;switch(e){case\"STARTCHAR\":i=[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],i[0]=r,o=!1;break;case\"ENCODING\":t=parseInt(r,10),i[1]=t;break;case\"BBX\":s=r.split(\" \"),i[2]=parseInt(s[0],10),i[3]=parseInt(s[1],10),i[4]=parseInt(s[2],10),i[5]=parseInt(s[3],10);break;case\"SWIDTH\":s=r.split(\" \"),i[6]=parseInt(s[0],10),i[7]=parseInt(s[1],10);break;case\"DWIDTH\":s=r.split(\" \"),i[8]=parseInt(s[0],10),i[9]=parseInt(s[1],10);break;case\"SWIDTH1\":s=r.split(\" \"),i[10]=parseInt(s[0],10),i[11]=parseInt(s[1],10);break;case\"DWIDTH1\":s=r.split(\" \"),i[12]=parseInt(s[0],10),i[13]=parseInt(s[1],10);break;case\"VVECTOR\":s=n.split(r),i[14]=parseInt(s[0],10),i[15]=parseInt(s[1],10)}}else if(1===c){const e=h[0].trim();switch(e){case\"BITMAP\":s=[],a=!0;break;case\"ENDCHAR\":a=!1,i[16]=s,this.glyphs.set(t,i),o=!0;break;case\"ENDFONT\":if(o)return void this.__prepare_glyphs_after();default:a&&s.push(e)}}}}))}__prepare_glyphs_after(){const t=this.glyphs.size;this.__glyph_count_to_check!==t&&(null===this.__glyph_count_to_check?console.warn(\"The glyph count next to 'CHARS' keyword does not exist\"):console.warn(`The glyph count next to 'CHARS' keyword is ${this.__glyph_count_to_check.toString()}, which does not match the actual glyph count ${t.toString()}`))}get length(){return this.glyphs.size}itercps(t,e){const n=null!=t?t:1,r=null!=e?e:null;let i;const s=[...this.glyphs.keys()];switch(n){case 1:i=s.sort(((t,e)=>t-e));break;case 0:i=s;break;case 2:i=s.sort(((t,e)=>e-t));break;case-1:i=s.reverse()}if(null!==r){const t=t=>{if(\"number\"==typeof r)return t<r;if(Array.isArray(r)&&2===r.length&&\"number\"==typeof r[0]&&\"number\"==typeof r[1])return t<=r[1]&&t>=r[0];if(Array.isArray(r)&&Array.isArray(r[0]))for(const e of r){const[n,r]=e;if(t<=r&&t>=n)return!0}return!1};i=i.filter(t)}return i}*iterglyphs(t,e){for(const n of this.itercps(t,e))yield this.glyphbycp(n)}glyphbycp(t){const e=this.glyphs.get(t);if(null==e)return console.warn(`Glyph \"${String.fromCodePoint(t)}\" (codepoint ${t.toString()}) does not exist in the font. Will return 'null'`),null;{const t={};return i.forEach(((n,r)=>{var i,s,a;i=t,s=n,a=e[r],i[s]=a})),new l(t,this)}}glyph(t){const e=t.codePointAt(0);return void 0===e?null:this.glyphbycp(e)}lacksglyphs(t){const e=[],n=t.length;for(let r,i=0;i<n;i++){r=t[i];const n=r.codePointAt(0);void 0!==n&&this.glyphs.has(n)||e.push(r)}return 0!==e.length?e:null}drawcps(t,e={}){var n,i,o,c,d,_,p;const u=null!==(n=e.linelimit)&&void 0!==n?n:512,f=null!==(i=e.mode)&&void 0!==i?i:1,b=null!==(o=e.direction)&&void 0!==o?o:\"lrtb\",y=null!==(c=e.usecurrentglyphspacing)&&void 0!==c&&c,g=null!==(d=e.missing)&&void 0!==d?d:null;if(void 0===this.headers)throw new Error(\"Font is not loaded\");let v,w,m,I,S,k,x,T,E,A,R,N,O,D,P,C,$,H;const M=null!==(_=s[b])&&void 0!==_?_:b,F=M.slice(0,2),W=M.slice(2,4);F in a&&W in a?(k=a[F],x=a[W]):(k=1,x=0),0===x||2===x?v=1:1!==x&&-1!==x||(v=0),1===k||-1===k?w=1:2!==k&&0!==k||(w=0),1===f&&(T=k>0?this.headers.fbbx:this.headers.fbby,k>0?(N=\"dwx0\",O=\"dwy0\"):(N=\"dwx1\",O=\"dwy1\"),R=N in this.headers?this.headers[N]:O in this.headers?this.headers[O]:null);const j=[];I=[];const B=[];P=[],C=0;const G=()=>{j.push(I),y?P.shift():P.pop(),B.push(P)},V=t[Symbol.iterator]();for($=!1;;){if($)$=!1;else{if(S=null===(p=V.next())||void 0===p?void 0:p.value,void 0===S)break;const t=this.glyphbycp(S);E=null!==t?t:g?g instanceof l?g:new l(g,this):new l(r,this),m=E.draw(),H=m.width(),D=0,1===f&&void 0!==N&&void 0!==O&&(A=E.meta[N]||E.meta[O],null==A&&(A=R),null!=A&&void 0!==T&&(D=A-T))}if(void 0!==H&&void 0!==D&&void 0!==m&&void 0!==E&&void 0!==S)if(C+=H+D,C<=u)I.push(m),P.push(D);else{if(0===I.length)throw new Error(`\\`_linelimit\\` (${u}) is too small the line can't even contain one glyph: \"${E.chr()}\" (codepoint ${S}, width: ${H})`);G(),C=0,I=[],P=[],$=!0}}0!==I.length&&G();const z=j.map(((t,e)=>h.concatall(t,{direction:k,align:v,offsetlist:B[e]})));return h.concatall(z,{direction:x,align:w})}draw(t,e={}){const{linelimit:n,mode:r,direction:i,usecurrentglyphspacing:s,missing:a}=e;return this.drawcps(t.split(\"\").map((t=>{const e=t.codePointAt(0);return void 0===e?8203:e})),{linelimit:n,mode:r,direction:i,usecurrentglyphspacing:s,missing:a})}drawall(t={}){const{order:e,r:n,linelimit:r,mode:i,direction:s,usecurrentglyphspacing:a}=t,o=null!=i?i:0;return this.drawcps(this.itercps(e,n),{linelimit:r,mode:o,direction:s,usecurrentglyphspacing:a})}}class l{constructor(t,e){this.meta=t,this.font=e}toString(){return this.draw().toString()}repr(){var t;return\"Glyph(\"+JSON.stringify(this.meta,null,2)+\", Font(<\"+(null===(t=this.font.headers)||void 0===t?void 0:t.fontname)+\">)\"}cp(){return this.meta.codepoint}chr(){return String.fromCodePoint(this.cp())}draw(t,e){const n=null!=e?e:null;let r;switch(null!=t?t:0){case 0:r=this.__draw_fbb();break;case 1:r=this.__draw_bb();break;case 2:r=this.__draw_original();break;case-1:if(null===n)throw new Error(\"Parameter bb in draw() method must be set when mode=-1\");r=this.__draw_user_specified(n)}return r}__draw_user_specified(t){const e=this.meta.bbxoff,n=this.meta.bbyoff,[r,i,s,a]=t;return this.__draw_bb().crop(r,i,-e+s,-n+a)}__draw_original(){return new h(this.meta.hexdata.map((t=>t?parseInt(t,16).toString(2).padStart(4*t.length,\"0\"):\"\")))}__draw_bb(){const t=this.meta.bbw,e=this.meta.bbh,n=this.__draw_original(),r=n.bindata,i=r.length;return i!==e&&console.warn(`Glyph \"${this.meta.glyphname.toString()}\" (codepoint ${this.meta.codepoint.toString()})'s bbh, ${e.toString()}, does not match its hexdata line count, ${i.toString()}`),n.bindata=r.map((e=>e.slice(0,t))),n}__draw_fbb(){const t=this.font.headers;if(void 0===t)throw new Error(\"Font is not loaded\");return this.__draw_user_specified([t.fbbx,t.fbby,t.fbbxoff,t.fbbyoff])}origin(t={}){var e,n,r,i;const s=null!==(e=t.mode)&&void 0!==e?e:0,a=null!==(n=t.fromorigin)&&void 0!==n&&n,o=null!==(r=t.xoff)&&void 0!==r?r:null,l=null!==(i=t.yoff)&&void 0!==i?i:null;let h;const c=this.meta.bbxoff,d=this.meta.bbyoff;switch(s){case 0:const t=this.font.headers;if(void 0===t)throw new Error(\"Font is not loaded\");h=[t.fbbxoff,t.fbbyoff];break;case 1:case 2:h=[c,d];break;case-1:if(null===o||null===l)throw new Error(\"Parameter xoff and yoff in origin() method must be all set when mode=-1\");h=[o,l]}return a?h:[0-h[0],0-h[1]]}}class h{constructor(t){this.bindata=t}toString(){return this.bindata.join(\"\\n\").replace(/0/g,\".\").replace(/1/g,\"#\").replace(/2/g,\"&\")}repr(){return`Bitmap(${JSON.stringify(this.bindata,null,2)})`}width(){return this.bindata[0].length}height(){return this.bindata.length}clone(){return new h([...this.bindata])}static __crop_string(t,e,n){let r=t;const i=t.length;let s=0;e<0&&(s=0-e,r=r.padStart(s+i,\"0\")),e+n>i&&(r=r.padEnd(e+n-i+r.length,\"0\"));const a=e+s;return r.slice(a,a+n)}static __string_offset_concat(t,e,n){const r=null!=n?n:0;if(0===r)return t+e;const i=t.length,s=i+r,a=s+e.length,o=Math.min(0,s),l=Math.max(i,a),c=h.__crop_string(t,o,l-o),d=h.__crop_string(e,o-s,l-o);return c.split(\"\").map(((t,e)=>(parseInt(d[e],10)||parseInt(t,10)).toString())).join(\"\")}static __listofstr_offset_concat(t,e,n){const r=null!=n?n:0;let i,s;if(0===r)return t.concat(e);const a=t[0].length,o=t.length,l=o+r,h=l+e.length,c=Math.min(0,l),d=Math.max(o,h),_=[];for(let n=c;n<d;n++)i=n<0||n>=o?\"0\".repeat(a):t[n],s=n<l||n>=h?\"0\".repeat(a):e[n-l],_.push(i.split(\"\").map(((t,e)=>(parseInt(s[e],10)||parseInt(t,10)).toString())).join(\"\"));return _}static __crop_bitmap(t,e,n,r,i){let s;const a=[],o=t.length;for(let l=0;l<n;l++)s=o-i-n+l,s<0||s>=o?a.push(\"0\".repeat(e)):a.push(h.__crop_string(t[s],r,e));return a}crop(t,e,n,r){const i=null!=n?n:0,s=null!=r?r:0;return this.bindata=h.__crop_bitmap(this.bindata,t,e,i,s),this}overlay(t){const e=this.bindata,n=t.bindata;return e.length!==n.length&&console.warn(\"the bitmaps to overlay have different height\"),e[0].length!==n[0].length&&console.warn(\"the bitmaps to overlay have different width\"),this.bindata=e.map(((t,e)=>{const r=t,i=n[e];return r.split(\"\").map(((t,e)=>(parseInt(i[e],10)||parseInt(t,10)).toString())).join(\"\")})),this}static concatall(t,e={}){var n,r,i;const s=null!==(n=e.direction)&&void 0!==n?n:1,a=null!==(r=e.align)&&void 0!==r?r:1,o=null!==(i=e.offsetlist)&&void 0!==i?i:null;let l,c,d,_,p,u,f;if(s>0){d=Math.max(...t.map((t=>t.height()))),p=Array(d).fill(\"\");const e=(t,e,n)=>1===s?h.__string_offset_concat(t,e,n):h.__string_offset_concat(e,t,n);for(let n=0;n<d;n++){c=a?-n-1:n,_=0;const r=t.length;for(let i=0;i<r;i++){const r=t[i];o&&0!==i&&(_=o[i-1]),n<r.height()?c>=0?p[c]=e(p[c],r.bindata[c],_):p[d+c]=e(p[d+c],r.bindata[r.height()+c],_):c>=0?p[c]=e(p[c],\"0\".repeat(r.width()),_):p[d+c]=e(p[d+c],\"0\".repeat(r.width()),_)}}}else{d=Math.max(...t.map((t=>t.width()))),p=[],_=0;const e=t.length;for(let n=0;n<e;n++){const e=t[n];o&&0!==n&&(_=o[n-1]),l=e.bindata,u=e.width(),u!==d&&(f=a?0:u-d,l=this.__crop_bitmap(l,d,e.height(),f,0)),p=0===s?h.__listofstr_offset_concat(p,l,_):h.__listofstr_offset_concat(l,p,_)}}return new this(p)}concat(t,e={}){const{direction:n,align:r,offset:i}=e,s=null!=i?i:0;return this.bindata=h.concatall([this,t],{direction:n,align:r,offsetlist:[s]}).bindata,this}static __enlarge_bindata(t,e,n){const r=null!=e?e:1,i=null!=n?n:1;let s=[...t];return r>1&&(s=s.map((t=>t.split(\"\").reduce(((t,e)=>t.concat(Array(r).fill(e))),[]).join(\"\")))),i>1&&(s=s.reduce(((t,e)=>t.concat(Array(i).fill(e))),[])),s}enlarge(t,e){return this.bindata=h.__enlarge_bindata(this.bindata,t,e),this}replace(t,e){const n=\"number\"==typeof t?t.toString():t,r=\"number\"==typeof e?e.toString():e;return this.bindata=this.bindata.map((t=>((t,e,n)=>{if(\"replaceAll\"in String.prototype)return t.replaceAll(e,n);{const r=t=>t.replace(/[.*+\\-?^${}()|[\\]\\\\]/g,\"\\\\$&\");return t.replace(new RegExp(r(e),\"g\"),n)}})(t,n,r))),this}shadow(t,e){const n=null!=t?t:1,r=null!=e?e:-1;let i,s,a,o,l,h;const c=this.clone();return h=this.width(),i=this.height(),h+=Math.abs(n),i+=Math.abs(r),c.bindata=c.bindata.map((t=>t.replace(/1/g,\"2\"))),n>0?(s=0,o=-n):(s=n,o=0),r>0?(a=0,l=-r):(a=r,l=0),this.crop(h,i,s,a),c.crop(h,i,o,l),c.overlay(this),this.bindata=c.bindata,this}glow(t){var e,n,r,i,s,a,o,l,h,c,d,_,p,u;const f=null!=t?t:0;let b,y,g,v;g=this.width(),v=this.height(),g+=2,v+=2,this.crop(g,v,-1,-1);const w=this.todata(2),m=w.length;for(let t=0;t<m;t++){b=w[t];const g=b.length;for(let v=0;v<g;v++)y=b[v],1===y&&((e=w[t])[n=v-1]||(e[n]=2),(r=w[t])[i=v+1]||(r[i]=2),(s=w[t-1])[v]||(s[v]=2),(a=w[t+1])[v]||(a[v]=2),1===f&&((o=w[t-1])[l=v-1]||(o[l]=2),(h=w[t-1])[c=v+1]||(h[c]=2),(d=w[t+1])[_=v-1]||(d[_]=2),(p=w[t+1])[u=v+1]||(p[u]=2)))}return this.bindata=w.map((t=>t.map((t=>t.toString())).join(\"\"))),this}bytepad(t){const e=null!=t?t:8,n=this.width(),r=this.height(),i=n%e;return 0===i?this:this.crop(n+e-i,r)}todata(t){let e;switch(null!=t?t:1){case 0:e=this.bindata.join(\"\\n\");break;case 1:e=this.bindata;break;case 2:e=this.bindata.map((t=>t.split(\"\").map((t=>parseInt(t,10)))));break;case 3:e=[].concat(...this.todata(2));break;case 4:e=this.bindata.map((t=>{if(!/^[01]+$/.test(t))throw new Error(`Invalid binary string: ${t}`);return parseInt(t,2).toString(16).padStart(-1*Math.floor(-1*this.width()/4),\"0\")}));break;case 5:e=this.bindata.map((t=>{if(!/^[01]+$/.test(t))throw new Error(`Invalid binary string: ${t}`);return parseInt(t,2)}))}return e}draw2canvas(t,e){const n=null!=e?e:{0:null,1:\"black\",2:\"red\"};return this.todata(2).forEach(((e,r)=>{e.forEach(((e,i)=>{const s=e.toString();if(\"0\"===s||\"1\"===s||\"2\"===s){const e=n[s];null!=e&&(t.fillStyle=e,t.fillRect(i,r,1,1))}}))})),this}}const $Font=e=>t(void 0,void 0,void 0,(function*(){return yield(new o).load_filelines(e)})),$Glyph=(t,e)=>new l(t,e),$Bitmap=t=>new h(t);\n\n// Export for ES modules\nexport { $Font, $Glyph, $Bitmap, $fetchline, o as Font, l as Glyph, h as Bitmap };\n", "/**\n * BDF font renderer for LED matrix displays\n * Uses bdfparser-js for pixel-perfect bitmap font rendering\n *\n * This provides an alternative to Canvas-based TTF rendering,\n * offering exact pixel output without anti-aliasing threshold ambiguity.\n */\n\nimport { $Font, $fetchline } from '../lib/bdfparser.bundle.js';\n\n// BDF font configuration - maps font names to files for each height\nconst BDF_FONT_CONFIG = {\n  'VCR_OSD_MONO': {\n    16: { file: 'VCR_OSD_MONO_16.bdf', yOffset: 0 },\n    24: { file: 'VCR_OSD_MONO_24.bdf', yOffset: 0 },\n    32: { file: 'VCR_OSD_MONO_32.bdf', yOffset: 2 }  // Match pypixelcolor offset\n  },\n  'CUSONG': {\n    16: { file: 'CUSONG_16.bdf', yOffset: -1 },  // Match pypixelcolor offset\n    24: { file: 'CUSONG_24.bdf', yOffset: 0 },\n    32: { file: 'CUSONG_32.bdf', yOffset: 0 }\n  }\n};\n\n// Font loading cache\nconst fontCache = new Map();\nconst fontLoadPromises = new Map();\n\n/**\n * Get the base URL for BDF font files\n * Handles HACS, manual installation, local preview, and GitHub Pages paths\n */\nfunction getBdfFontUrl(filename) {\n  // Detect Home Assistant by checking for HA-specific globals or URL patterns\n  const isHomeAssistant = typeof window.hassConnection !== 'undefined' ||\n                          window.location.pathname.includes('/lovelace') ||\n                          window.location.pathname.includes('/dashboard') ||\n                          document.querySelector('home-assistant') !== null;\n\n  if (isHomeAssistant) {\n    // HACS path for Home Assistant\n    return `/hacsfiles/ipixel_color/fonts/${filename}`;\n  }\n\n  // For GitHub Pages, local preview, or any non-HA environment\n  // Check if we're in a subdirectory (e.g., /ha-ipixel-color/)\n  const basePath = window.location.pathname.substring(0, window.location.pathname.lastIndexOf('/') + 1);\n  return `${basePath}fonts/${filename}`;\n}\n\n/**\n * Get closest height key for font metrics (16, 24, or 32)\n * @param {number} height - Display height in pixels\n * @returns {number} - Closest metrics key\n */\nfunction getHeightKey(height) {\n  if (height <= 18) return 16;\n  if (height <= 28) return 24;\n  return 32;\n}\n\n/**\n * Load a BDF font for a specific size\n * @param {string} fontName - Name of the font (VCR_OSD_MONO, CUSONG)\n * @param {number} heightKey - Height key (16, 24, or 32)\n * @returns {Promise<{font: Font, config: object}|null>}\n */\nexport async function loadBdfFont(fontName, heightKey = 16) {\n  const cacheKey = `${fontName}_${heightKey}`;\n\n  // Return cached font if available\n  if (fontCache.has(cacheKey)) {\n    return fontCache.get(cacheKey);\n  }\n\n  // Return existing promise if loading in progress\n  if (fontLoadPromises.has(cacheKey)) {\n    return fontLoadPromises.get(cacheKey);\n  }\n\n  // Get font config\n  const fontConfig = BDF_FONT_CONFIG[fontName];\n  if (!fontConfig || !fontConfig[heightKey]) {\n    console.warn(`iPIXEL BDF: No config for font ${fontName} at height ${heightKey}`);\n    return null;\n  }\n\n  const config = fontConfig[heightKey];\n\n  // Start loading\n  const loadPromise = (async () => {\n    try {\n      const fontUrl = getBdfFontUrl(config.file);\n      console.log(`iPIXEL BDF: Loading ${fontUrl}...`);\n\n      const font = await $Font($fetchline(fontUrl));\n\n      const result = { font, config };\n      fontCache.set(cacheKey, result);\n      console.log(`iPIXEL BDF: Font ${fontName} (${heightKey}px) loaded successfully`);\n      return result;\n    } catch (e) {\n      console.warn(`iPIXEL BDF: Failed to load font ${fontName} (${heightKey}px):`, e);\n      fontLoadPromises.delete(cacheKey);\n      return null;\n    }\n  })();\n\n  fontLoadPromises.set(cacheKey, loadPromise);\n  return loadPromise;\n}\n\n/**\n * Check if a BDF font is loaded\n * @param {string} fontName - Name of the font\n * @param {number} heightKey - Height key (16, 24, or 32)\n * @returns {boolean}\n */\nexport function isBdfFontLoaded(fontName, heightKey = 16) {\n  const cacheKey = `${fontName}_${heightKey}`;\n  return fontCache.has(cacheKey);\n}\n\n/**\n * Render text to pixels using BDF font\n * @param {string} text - Text to render\n * @param {number} width - Display width in pixels\n * @param {number} height - Display height in pixels\n * @param {string} fgColor - Foreground color (hex)\n * @param {string} bgColor - Background color (hex)\n * @param {string} fontName - Font name (VCR_OSD_MONO, CUSONG)\n * @returns {string[]|null} - Array of hex color strings, or null if font not available\n */\nexport function textToPixelsBdf(text, width, height, fgColor = '#ff6600', bgColor = '#111', fontName = 'VCR_OSD_MONO') {\n  const heightKey = getHeightKey(height);\n  const cacheKey = `${fontName}_${heightKey}`;\n  const cached = fontCache.get(cacheKey);\n\n  if (!cached) {\n    // Trigger async load, return null for now\n    loadBdfFont(fontName, heightKey);\n    return null;\n  }\n\n  const { font, config } = cached;\n\n  // Initialize pixel array with background color\n  const pixels = new Array(width * height).fill(bgColor);\n\n  // Handle empty text\n  if (!text || text.trim() === '') {\n    return pixels;\n  }\n\n  try {\n    // Render text to bitmap using bdfparser\n    // mode: 1 = use glyph bounding box (tight), direction: 'lrtb' = left-to-right, top-to-bottom\n    const bitmap = font.draw(text, { direction: 'lrtb', mode: 1 });\n    const bindata = bitmap.bindata;\n    const textWidth = bitmap.width();\n    const textHeight = bitmap.height();\n\n    // Calculate centering offsets\n    const xOffset = Math.floor((width - textWidth) / 2);\n    const yOffset = Math.floor((height - textHeight) / 2) + (config.yOffset || 0);\n\n    // Map bitmap to pixel array\n    for (let row = 0; row < textHeight; row++) {\n      const rowData = bindata[row] || '';\n      for (let col = 0; col < rowData.length; col++) {\n        const px = xOffset + col;\n        const py = yOffset + row;\n\n        // Check bounds\n        if (px >= 0 && px < width && py >= 0 && py < height) {\n          const idx = py * width + px;\n          // '1' = foreground (lit pixel), '0' = background\n          pixels[idx] = rowData[col] === '1' ? fgColor : bgColor;\n        }\n      }\n    }\n  } catch (e) {\n    console.warn('iPIXEL BDF: Error rendering text:', e);\n    return null;\n  }\n\n  return pixels;\n}\n\n/**\n * Render text for scrolling (extended width for seamless loop)\n * @param {string} text - Text to render\n * @param {number} displayWidth - Display width in pixels\n * @param {number} height - Display height in pixels\n * @param {string} fgColor - Foreground color (hex)\n * @param {string} bgColor - Background color (hex)\n * @param {string} fontName - Font name\n * @returns {{pixels: string[], width: number}|null}\n */\nexport function textToScrollPixelsBdf(text, displayWidth, height, fgColor = '#ff6600', bgColor = '#111', fontName = 'VCR_OSD_MONO') {\n  const heightKey = getHeightKey(height);\n  const cacheKey = `${fontName}_${heightKey}`;\n  const cached = fontCache.get(cacheKey);\n\n  if (!cached) {\n    loadBdfFont(fontName, heightKey);\n    return null;\n  }\n\n  const { font, config } = cached;\n\n  // Handle empty text\n  if (!text || text.trim() === '') {\n    const extendedWidth = displayWidth * 3;\n    const pixels = new Array(extendedWidth * height).fill(bgColor);\n    return { pixels, width: extendedWidth };\n  }\n\n  try {\n    // Render text to bitmap\n    const bitmap = font.draw(text, { direction: 'lrtb', mode: 1 });\n    const bindata = bitmap.bindata;\n    const textWidth = bitmap.width();\n    const textHeight = bitmap.height();\n\n    // Extended width: display + text + display (for seamless scrolling)\n    const extendedWidth = displayWidth + textWidth + displayWidth;\n    const pixels = new Array(extendedWidth * height).fill(bgColor);\n\n    // Place text starting after one display width of padding\n    const xStart = displayWidth;\n    const yOffset = Math.floor((height - textHeight) / 2) + (config.yOffset || 0);\n\n    // Map bitmap to pixel array\n    for (let row = 0; row < textHeight; row++) {\n      const rowData = bindata[row] || '';\n      for (let col = 0; col < rowData.length; col++) {\n        const px = xStart + col;\n        const py = yOffset + row;\n\n        if (px >= 0 && px < extendedWidth && py >= 0 && py < height) {\n          const idx = py * extendedWidth + px;\n          pixels[idx] = rowData[col] === '1' ? fgColor : bgColor;\n        }\n      }\n    }\n\n    return { pixels, width: extendedWidth };\n  } catch (e) {\n    console.warn('iPIXEL BDF: Error rendering scroll text:', e);\n    return null;\n  }\n}\n\n/**\n * Preload all BDF fonts for common heights\n * @returns {Promise<void>}\n */\nexport async function preloadBdfFonts() {\n  const fonts = Object.keys(BDF_FONT_CONFIG);\n  const heights = [16, 24, 32];\n\n  const promises = [];\n  for (const fontName of fonts) {\n    for (const height of heights) {\n      if (BDF_FONT_CONFIG[fontName][height]) {\n        promises.push(loadBdfFont(fontName, height));\n      }\n    }\n  }\n\n  await Promise.all(promises);\n}\n\n/**\n * Get list of available BDF fonts\n * @returns {string[]}\n */\nexport function getAvailableBdfFonts() {\n  return Object.keys(BDF_FONT_CONFIG);\n}\n\n// Export config for debugging\nexport { BDF_FONT_CONFIG, getHeightKey };\n", "/**\n * Text Effects Module\n * Effects that modify how text is displayed on the LED matrix\n */\n\n/**\n * Text Effects class - handles text-based visual effects\n */\nexport class TextEffects {\n  constructor(renderer) {\n    this.renderer = renderer;\n  }\n\n  /**\n   * Initialize effect state\n   */\n  init(effectName, state) {\n    const { width, height } = this.renderer;\n\n    switch (effectName) {\n      case 'scroll_ltr':\n      case 'scroll_rtl':\n        state.offset = 0;\n        break;\n\n      case 'blink':\n        state.visible = true;\n        break;\n\n      case 'snow':\n      case 'breeze':\n        state.phases = [];\n        for (let i = 0; i < width * height; i++) {\n          state.phases[i] = Math.random() * Math.PI * 2;\n        }\n        break;\n\n      case 'laser':\n        state.position = 0;\n        break;\n\n      case 'fade':\n        state.opacity = 0;\n        state.direction = 1; // 1 = fading in, -1 = fading out\n        break;\n\n      case 'typewriter':\n        state.charIndex = 0;\n        state.cursorVisible = true;\n        break;\n\n      case 'bounce':\n        state.offset = 0;\n        state.direction = 1;\n        break;\n\n      case 'sparkle':\n        state.sparkles = [];\n        // Pre-generate sparkle positions\n        for (let i = 0; i < Math.floor(width * height * 0.1); i++) {\n          state.sparkles.push({\n            x: Math.floor(Math.random() * width),\n            y: Math.floor(Math.random() * height),\n            brightness: Math.random(),\n            speed: 0.05 + Math.random() * 0.1\n          });\n        }\n        break;\n    }\n  }\n\n  /**\n   * Step effect forward\n   */\n  step(effectName, state) {\n    const { width, extendedWidth } = this.renderer;\n\n    switch (effectName) {\n      case 'scroll_ltr':\n        state.offset -= 1;\n        if (state.offset <= -(extendedWidth || width)) {\n          state.offset = width;\n        }\n        break;\n\n      case 'scroll_rtl':\n        state.offset += 1;\n        if (state.offset >= (extendedWidth || width)) {\n          state.offset = -width;\n        }\n        break;\n\n      case 'blink':\n        state.visible = !state.visible;\n        break;\n\n      case 'laser':\n        state.position = (state.position + 1) % width;\n        break;\n\n      case 'fade':\n        state.opacity += state.direction * 0.05;\n        if (state.opacity >= 1) {\n          state.opacity = 1;\n          state.direction = -1;\n        } else if (state.opacity <= 0) {\n          state.opacity = 0;\n          state.direction = 1;\n        }\n        break;\n\n      case 'typewriter':\n        if (state.tick % 3 === 0) {\n          state.charIndex++;\n        }\n        state.cursorVisible = state.tick % 10 < 5;\n        break;\n\n      case 'bounce':\n        state.offset += state.direction;\n        const maxOffset = Math.max(0, (extendedWidth || width) - width);\n        if (state.offset >= maxOffset) {\n          state.offset = maxOffset;\n          state.direction = -1;\n        } else if (state.offset <= 0) {\n          state.offset = 0;\n          state.direction = 1;\n        }\n        break;\n\n      case 'sparkle':\n        // Update sparkle brightnesses\n        for (const sparkle of state.sparkles) {\n          sparkle.brightness += sparkle.speed;\n          if (sparkle.brightness > 1) {\n            sparkle.brightness = 0;\n            sparkle.x = Math.floor(Math.random() * width);\n            sparkle.y = Math.floor(Math.random() * this.renderer.height);\n          }\n        }\n        break;\n    }\n  }\n\n  /**\n   * Render effect to buffer\n   */\n  render(effectName, state, pixels, extendedPixels, extendedWidth) {\n    const { width, height } = this.renderer;\n    const srcPixels = extendedPixels || pixels || [];\n    const displayPixels = pixels || [];\n    const srcWidth = extendedWidth || width;\n\n    for (let y = 0; y < height; y++) {\n      for (let x = 0; x < width; x++) {\n        let color;\n        let sourceX = x;\n\n        // Get source pixel (with offset for scrolling effects)\n        if (effectName === 'scroll_ltr' || effectName === 'scroll_rtl' || effectName === 'bounce') {\n          sourceX = x - (state.offset || 0);\n          while (sourceX < 0) sourceX += srcWidth;\n          while (sourceX >= srcWidth) sourceX -= srcWidth;\n          color = srcPixels[y * srcWidth + sourceX] || '#111';\n        } else if (effectName === 'typewriter') {\n          // Only show characters up to charIndex\n          const charWidth = 6;\n          const maxX = (state.charIndex || 0) * charWidth;\n          if (x < maxX) {\n            color = displayPixels[y * width + x] || '#111';\n          } else if (x === maxX && state.cursorVisible) {\n            color = '#ffffff'; // Cursor\n          } else {\n            color = '#111';\n          }\n        } else {\n          color = displayPixels[y * width + x] || '#111';\n        }\n\n        // Convert to RGB\n        let [r, g, b] = this._hexToRgb(color);\n        const isLit = r > 20 || g > 20 || b > 20;\n\n        // Apply effect modifiers\n        if (isLit) {\n          switch (effectName) {\n            case 'blink':\n              if (!state.visible) {\n                r = g = b = 17;\n              }\n              break;\n\n            case 'snow': {\n              const phase = state.phases?.[y * width + x] || 0;\n              const tick = state.tick || 0;\n              const factor = 0.3 + 0.7 * Math.abs(Math.sin(phase + tick * 0.3));\n              r *= factor;\n              g *= factor;\n              b *= factor;\n              break;\n            }\n\n            case 'breeze': {\n              const phase = state.phases?.[y * width + x] || 0;\n              const tick = state.tick || 0;\n              const factor = 0.4 + 0.6 * Math.abs(Math.sin(phase + tick * 0.15 + x * 0.2));\n              r *= factor;\n              g *= factor;\n              b *= factor;\n              break;\n            }\n\n            case 'laser': {\n              const pos = state.position || 0;\n              const dist = Math.abs(x - pos);\n              const factor = dist < 3 ? 1 : 0.3;\n              r *= factor;\n              g *= factor;\n              b *= factor;\n              break;\n            }\n\n            case 'fade': {\n              const opacity = state.opacity || 1;\n              r *= opacity;\n              g *= opacity;\n              b *= opacity;\n              break;\n            }\n          }\n        }\n\n        // Sparkle overlay (add sparkles on top of lit pixels)\n        if (effectName === 'sparkle' && state.sparkles) {\n          for (const sparkle of state.sparkles) {\n            if (sparkle.x === x && sparkle.y === y) {\n              const sparkleIntensity = Math.sin(sparkle.brightness * Math.PI);\n              r = Math.min(255, r + sparkleIntensity * 200);\n              g = Math.min(255, g + sparkleIntensity * 200);\n              b = Math.min(255, b + sparkleIntensity * 200);\n            }\n          }\n        }\n\n        this.renderer.setPixel(x, y, [r, g, b]);\n      }\n    }\n  }\n\n  /**\n   * Convert hex color to RGB array\n   */\n  _hexToRgb(hex) {\n    if (!hex || hex === '#111' || hex === '#000') return [17, 17, 17];\n    if (hex === '#050505') return [5, 5, 5];\n\n    const result = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hex);\n    return result\n      ? [parseInt(result[1], 16), parseInt(result[2], 16), parseInt(result[3], 16)]\n      : [17, 17, 17];\n  }\n}\n", "/**\n * Ambient Effects Module\n * Standalone visual effects that don't depend on text content\n */\n\n/**\n * Convert HSV to RGB\n */\nfunction hsvToRgb(h, s, v) {\n  let r, g, b;\n  const i = Math.floor(h * 6);\n  const f = h * 6 - i;\n  const p = v * (1 - s);\n  const q = v * (1 - f * s);\n  const t = v * (1 - (1 - f) * s);\n\n  switch (i % 6) {\n    case 0: r = v; g = t; b = p; break;\n    case 1: r = q; g = v; b = p; break;\n    case 2: r = p; g = v; b = t; break;\n    case 3: r = p; g = q; b = v; break;\n    case 4: r = t; g = p; b = v; break;\n    case 5: r = v; g = p; b = q; break;\n  }\n\n  return [r * 255, g * 255, b * 255];\n}\n\n/**\n * Ambient Effects class - standalone visual effects\n */\nexport class AmbientEffects {\n  constructor(renderer) {\n    this.renderer = renderer;\n  }\n\n  /**\n   * Initialize effect state\n   */\n  init(effectName, state) {\n    const { width, height } = this.renderer;\n\n    switch (effectName) {\n      case 'rainbow':\n        state.position = 0;\n        break;\n\n      case 'matrix':\n        // Random color mode\n        const colorModes = [\n          [0, 255, 0],    // Matrix green\n          [0, 255, 255],  // Cyan\n          [255, 0, 255],  // Purple\n        ];\n        state.colorMode = colorModes[Math.floor(Math.random() * colorModes.length)];\n        // Create 2D buffer for rain trails\n        state.buffer = [];\n        for (let y = 0; y < height; y++) {\n          state.buffer.push(Array(width).fill(null).map(() => [0, 0, 0]));\n        }\n        break;\n\n      case 'plasma':\n        state.time = 0;\n        break;\n\n      case 'gradient':\n        state.time = 0;\n        break;\n\n      case 'fire':\n        // Fire simulation buffer (heat values 0-255)\n        state.heat = [];\n        for (let i = 0; i < width * height; i++) {\n          state.heat[i] = 0;\n        }\n        // Fire palette (black -> red -> yellow -> white)\n        state.palette = this._createFirePalette();\n        break;\n\n      case 'water':\n        // Ripple simulation\n        state.current = [];\n        state.previous = [];\n        for (let i = 0; i < width * height; i++) {\n          state.current[i] = 0;\n          state.previous[i] = 0;\n        }\n        state.damping = 0.95;\n        break;\n\n      case 'stars':\n        // Star positions and brightnesses\n        state.stars = [];\n        const numStars = Math.floor(width * height * 0.15);\n        for (let i = 0; i < numStars; i++) {\n          state.stars.push({\n            x: Math.floor(Math.random() * width),\n            y: Math.floor(Math.random() * height),\n            brightness: Math.random(),\n            speed: 0.02 + Math.random() * 0.05,\n            phase: Math.random() * Math.PI * 2\n          });\n        }\n        break;\n\n      case 'confetti':\n        // Falling particles\n        state.particles = [];\n        for (let i = 0; i < 20; i++) {\n          state.particles.push(this._createConfettiParticle(width, height, true));\n        }\n        break;\n\n      // Shader-inspired effects (from ipixel-shader project)\n      case 'plasma_wave':\n        state.time = 0;\n        break;\n\n      case 'radial_pulse':\n        state.time = 0;\n        break;\n\n      case 'hypnotic':\n        state.time = 0;\n        break;\n\n      case 'lava':\n        state.time = 0;\n        // Create noise seed for organic movement\n        state.noise = [];\n        for (let i = 0; i < width * height; i++) {\n          state.noise[i] = Math.random() * Math.PI * 2;\n        }\n        break;\n\n      case 'aurora':\n        state.time = 0;\n        break;\n    }\n  }\n\n  /**\n   * Step effect forward\n   */\n  step(effectName, state) {\n    const { width, height } = this.renderer;\n\n    switch (effectName) {\n      case 'rainbow':\n        state.position = (state.position + 0.01) % 1;\n        break;\n\n      case 'matrix':\n        this._stepMatrix(state, width, height);\n        break;\n\n      case 'plasma':\n      case 'gradient':\n        state.time = (state.time || 0) + 0.05;\n        break;\n\n      case 'fire':\n        this._stepFire(state, width, height);\n        break;\n\n      case 'water':\n        this._stepWater(state, width, height);\n        break;\n\n      case 'stars':\n        // Twinkle stars\n        for (const star of state.stars) {\n          star.phase += star.speed;\n        }\n        break;\n\n      case 'confetti':\n        // Update particles\n        for (let i = 0; i < state.particles.length; i++) {\n          const p = state.particles[i];\n          p.y += p.speed;\n          p.x += p.drift;\n          p.rotation += p.rotationSpeed;\n\n          // Reset if off screen\n          if (p.y > height) {\n            state.particles[i] = this._createConfettiParticle(width, height, false);\n          }\n        }\n        break;\n\n      // Shader-inspired effects\n      case 'plasma_wave':\n      case 'radial_pulse':\n      case 'hypnotic':\n      case 'lava':\n      case 'aurora':\n        state.time = (state.time || 0) + 0.03;\n        break;\n    }\n  }\n\n  /**\n   * Render effect to buffer\n   */\n  render(effectName, state) {\n    switch (effectName) {\n      case 'rainbow':\n        this._renderRainbow(state);\n        break;\n      case 'matrix':\n        this._renderMatrix(state);\n        break;\n      case 'plasma':\n        this._renderPlasma(state);\n        break;\n      case 'gradient':\n        this._renderGradient(state);\n        break;\n      case 'fire':\n        this._renderFire(state);\n        break;\n      case 'water':\n        this._renderWater(state);\n        break;\n      case 'stars':\n        this._renderStars(state);\n        break;\n      case 'confetti':\n        this._renderConfetti(state);\n        break;\n\n      // Shader-inspired effects\n      case 'plasma_wave':\n        this._renderPlasmaWave(state);\n        break;\n      case 'radial_pulse':\n        this._renderRadialPulse(state);\n        break;\n      case 'hypnotic':\n        this._renderHypnotic(state);\n        break;\n      case 'lava':\n        this._renderLava(state);\n        break;\n      case 'aurora':\n        this._renderAurora(state);\n        break;\n    }\n  }\n\n  // === Effect implementations ===\n\n  _renderRainbow(state) {\n    const { width, height } = this.renderer;\n    const position = state.position || 0;\n\n    for (let x = 0; x < width; x++) {\n      const hue = (position + x / width) % 1;\n      const [r, g, b] = hsvToRgb(hue, 1, 0.6);\n      for (let y = 0; y < height; y++) {\n        this.renderer.setPixel(x, y, [r, g, b]);\n      }\n    }\n  }\n\n  _stepMatrix(state, width, height) {\n    const buffer = state.buffer;\n    const colorMode = state.colorMode;\n    const fadeAmount = 0.15;\n\n    // Shift rows down\n    buffer.pop();\n    const newRow = buffer[0].map(([r, g, b]) => [\n      r * (1 - fadeAmount),\n      g * (1 - fadeAmount),\n      b * (1 - fadeAmount)\n    ]);\n    buffer.unshift(JSON.parse(JSON.stringify(newRow)));\n\n    // Random new drops\n    for (let x = 0; x < width; x++) {\n      if (Math.random() < 0.08) {\n        buffer[0][x] = [\n          Math.floor(Math.random() * colorMode[0]),\n          Math.floor(Math.random() * colorMode[1]),\n          Math.floor(Math.random() * colorMode[2])\n        ];\n      }\n    }\n  }\n\n  _renderMatrix(state) {\n    const { width, height } = this.renderer;\n    const buffer = state.buffer;\n    if (!buffer) return;\n\n    for (let y = 0; y < height; y++) {\n      for (let x = 0; x < width; x++) {\n        const [r, g, b] = buffer[y]?.[x] || [0, 0, 0];\n        this.renderer.setPixel(x, y, [r, g, b]);\n      }\n    }\n  }\n\n  _renderPlasma(state) {\n    const { width, height } = this.renderer;\n    const time = state.time || 0;\n    const centerX = width / 2;\n    const centerY = height / 2;\n\n    for (let x = 0; x < width; x++) {\n      for (let y = 0; y < height; y++) {\n        const dx = x - centerX;\n        const dy = y - centerY;\n        const dist = Math.sqrt(dx * dx + dy * dy);\n\n        const v1 = Math.sin(x / 8 + time);\n        const v2 = Math.sin(y / 6 + time * 0.8);\n        const v3 = Math.sin(dist / 6 - time * 1.2);\n        const v4 = Math.sin((x + y) / 10 + time * 0.5);\n\n        const value = (v1 + v2 + v3 + v4 + 4) / 8;\n\n        const r = Math.sin(value * Math.PI * 2) * 0.5 + 0.5;\n        const g = Math.sin(value * Math.PI * 2 + 2) * 0.5 + 0.5;\n        const b = Math.sin(value * Math.PI * 2 + 4) * 0.5 + 0.5;\n\n        this.renderer.setPixel(x, y, [r * 255, g * 255, b * 255]);\n      }\n    }\n  }\n\n  _renderGradient(state) {\n    const { width, height } = this.renderer;\n    const time = state.time || 0;\n    const t = time * 10;\n\n    for (let x = 0; x < width; x++) {\n      for (let y = 0; y < height; y++) {\n        const r = (Math.sin((x + t) * 0.05) * 0.5 + 0.5) * 255;\n        const g = (Math.cos((y + t) * 0.05) * 0.5 + 0.5) * 255;\n        const b = (Math.sin((x + y + t) * 0.03) * 0.5 + 0.5) * 255;\n\n        this.renderer.setPixel(x, y, [r, g, b]);\n      }\n    }\n  }\n\n  _createFirePalette() {\n    const palette = [];\n    for (let i = 0; i < 256; i++) {\n      let r, g, b;\n      if (i < 64) {\n        r = i * 4;\n        g = 0;\n        b = 0;\n      } else if (i < 128) {\n        r = 255;\n        g = (i - 64) * 4;\n        b = 0;\n      } else if (i < 192) {\n        r = 255;\n        g = 255;\n        b = (i - 128) * 4;\n      } else {\n        r = 255;\n        g = 255;\n        b = 255;\n      }\n      palette.push([r, g, b]);\n    }\n    return palette;\n  }\n\n  _stepFire(state, width, height) {\n    const heat = state.heat;\n\n    // Cool down\n    for (let i = 0; i < width * height; i++) {\n      heat[i] = Math.max(0, heat[i] - Math.random() * 10);\n    }\n\n    // Heat rises (diffuse upward)\n    for (let y = 0; y < height - 1; y++) {\n      for (let x = 0; x < width; x++) {\n        const idx = y * width + x;\n        const below = (y + 1) * width + x;\n        const left = y * width + Math.max(0, x - 1);\n        const right = y * width + Math.min(width - 1, x + 1);\n\n        heat[idx] = (heat[below] + heat[left] + heat[right]) / 3.05;\n      }\n    }\n\n    // Ignite bottom row\n    for (let x = 0; x < width; x++) {\n      if (Math.random() < 0.6) {\n        heat[(height - 1) * width + x] = 180 + Math.random() * 75;\n      }\n    }\n  }\n\n  _renderFire(state) {\n    const { width, height } = this.renderer;\n    const heat = state.heat;\n    const palette = state.palette;\n\n    for (let y = 0; y < height; y++) {\n      for (let x = 0; x < width; x++) {\n        const idx = y * width + x;\n        const h = Math.floor(Math.min(255, heat[idx]));\n        const [r, g, b] = palette[h];\n        this.renderer.setPixel(x, y, [r, g, b]);\n      }\n    }\n  }\n\n  _stepWater(state, width, height) {\n    const { current, previous, damping } = state;\n\n    // Swap buffers\n    const temp = [...previous];\n    for (let i = 0; i < current.length; i++) {\n      previous[i] = current[i];\n    }\n\n    // Ripple propagation\n    for (let y = 1; y < height - 1; y++) {\n      for (let x = 1; x < width - 1; x++) {\n        const idx = y * width + x;\n        current[idx] = (\n          temp[(y - 1) * width + x] +\n          temp[(y + 1) * width + x] +\n          temp[y * width + (x - 1)] +\n          temp[y * width + (x + 1)]\n        ) / 2 - current[idx];\n        current[idx] *= damping;\n      }\n    }\n\n    // Random drops\n    if (Math.random() < 0.1) {\n      const x = Math.floor(Math.random() * (width - 2)) + 1;\n      const y = Math.floor(Math.random() * (height - 2)) + 1;\n      current[y * width + x] = 255;\n    }\n  }\n\n  _renderWater(state) {\n    const { width, height } = this.renderer;\n    const current = state.current;\n\n    for (let y = 0; y < height; y++) {\n      for (let x = 0; x < width; x++) {\n        const idx = y * width + x;\n        const value = Math.abs(current[idx]);\n        const intensity = Math.min(255, value * 2);\n\n        // Blue water with white highlights\n        const r = intensity > 200 ? intensity : 0;\n        const g = intensity > 150 ? intensity * 0.8 : intensity * 0.3;\n        const b = Math.min(255, 50 + intensity);\n\n        this.renderer.setPixel(x, y, [r, g, b]);\n      }\n    }\n  }\n\n  _renderStars(state) {\n    const { width, height } = this.renderer;\n\n    // Clear to dark background\n    for (let y = 0; y < height; y++) {\n      for (let x = 0; x < width; x++) {\n        this.renderer.setPixel(x, y, [5, 5, 15]);\n      }\n    }\n\n    // Draw twinkling stars\n    for (const star of state.stars) {\n      const brightness = (Math.sin(star.phase) * 0.5 + 0.5) * 255;\n      const x = Math.floor(star.x);\n      const y = Math.floor(star.y);\n      if (x >= 0 && x < width && y >= 0 && y < height) {\n        this.renderer.setPixel(x, y, [brightness, brightness, brightness * 0.9]);\n      }\n    }\n  }\n\n  _createConfettiParticle(width, height, randomY) {\n    const colors = [\n      [255, 0, 0],    // Red\n      [0, 255, 0],    // Green\n      [0, 0, 255],    // Blue\n      [255, 255, 0],  // Yellow\n      [255, 0, 255],  // Magenta\n      [0, 255, 255],  // Cyan\n      [255, 128, 0],  // Orange\n      [255, 192, 203] // Pink\n    ];\n\n    return {\n      x: Math.random() * width,\n      y: randomY ? Math.random() * height : -2,\n      speed: 0.2 + Math.random() * 0.3,\n      drift: (Math.random() - 0.5) * 0.3,\n      color: colors[Math.floor(Math.random() * colors.length)],\n      size: 1 + Math.random(),\n      rotation: Math.random() * Math.PI * 2,\n      rotationSpeed: (Math.random() - 0.5) * 0.2\n    };\n  }\n\n  _renderConfetti(state) {\n    const { width, height } = this.renderer;\n\n    // Clear to dark background\n    for (let y = 0; y < height; y++) {\n      for (let x = 0; x < width; x++) {\n        this.renderer.setPixel(x, y, [10, 10, 10]);\n      }\n    }\n\n    // Draw particles\n    for (const p of state.particles) {\n      const x = Math.floor(p.x);\n      const y = Math.floor(p.y);\n\n      // Draw particle (simple 1-2 pixel representation)\n      if (x >= 0 && x < width && y >= 0 && y < height) {\n        this.renderer.setPixel(x, y, p.color);\n        // Add shimmer based on rotation\n        const shimmer = Math.abs(Math.sin(p.rotation)) * 0.5 + 0.5;\n        const [r, g, b] = p.color;\n        this.renderer.setPixel(x, y, [r * shimmer, g * shimmer, b * shimmer]);\n      }\n    }\n  }\n\n  // === Shader-inspired effects (ported from ipixel-shader GLSL) ===\n\n  /**\n   * Plasma Wave - Multi-frequency sine wave pattern\n   * Based on the shader.frag example from ipixel-shader\n   */\n  _renderPlasmaWave(state) {\n    const { width, height } = this.renderer;\n    const time = state.time || 0;\n\n    for (let x = 0; x < width; x++) {\n      for (let y = 0; y < height; y++) {\n        // Normalize coordinates to 0-1 range\n        const uvX = x / width;\n        const uvY = y / height;\n\n        // Multi-frequency sine wave combination (from shader.frag)\n        const v = Math.sin(uvX * 10.0 + time)\n                + Math.sin(uvY * 10.0 + time)\n                + Math.sin((uvX + uvY) * 10.0 + time)\n                + Math.sin(Math.sqrt((uvX - 0.5) ** 2 + (uvY - 0.5) ** 2) * 20.0 - time * 2.0);\n\n        // Color cycling with phase offsets (120 degrees apart)\n        const r = Math.sin(v * Math.PI) * 0.5 + 0.5;\n        const g = Math.sin(v * Math.PI + 2.094) * 0.5 + 0.5; // 2\u03C0/3\n        const b = Math.sin(v * Math.PI + 4.188) * 0.5 + 0.5; // 4\u03C0/3\n\n        this.renderer.setPixel(x, y, [r * 255, g * 255, b * 255]);\n      }\n    }\n  }\n\n  /**\n   * Radial Pulse - Concentric rings emanating from center\n   */\n  _renderRadialPulse(state) {\n    const { width, height } = this.renderer;\n    const time = state.time || 0;\n    const centerX = width / 2;\n    const centerY = height / 2;\n\n    for (let x = 0; x < width; x++) {\n      for (let y = 0; y < height; y++) {\n        const dx = x - centerX;\n        const dy = y - centerY;\n        const dist = Math.sqrt(dx * dx + dy * dy);\n\n        // Create expanding rings\n        const wave = Math.sin(dist * 0.8 - time * 3.0) * 0.5 + 0.5;\n        const pulse = Math.sin(time * 2.0) * 0.3 + 0.7;\n\n        // Color based on distance and time\n        const hue = (dist / 20 + time * 0.5) % 1;\n        const [r, g, b] = hsvToRgb(hue, 0.8, wave * pulse);\n\n        this.renderer.setPixel(x, y, [r, g, b]);\n      }\n    }\n  }\n\n  /**\n   * Hypnotic - Spiral pattern\n   */\n  _renderHypnotic(state) {\n    const { width, height } = this.renderer;\n    const time = state.time || 0;\n    const centerX = width / 2;\n    const centerY = height / 2;\n\n    for (let x = 0; x < width; x++) {\n      for (let y = 0; y < height; y++) {\n        const dx = x - centerX;\n        const dy = y - centerY;\n        const dist = Math.sqrt(dx * dx + dy * dy);\n        const angle = Math.atan2(dy, dx);\n\n        // Spiral pattern\n        const spiral = Math.sin(angle * 4.0 + dist * 0.5 - time * 2.0);\n        const intensity = (spiral * 0.5 + 0.5);\n\n        // Pulsing colors\n        const r = intensity * (Math.sin(time) * 0.5 + 0.5);\n        const g = intensity * (Math.sin(time + 2.094) * 0.5 + 0.5);\n        const b = intensity * (Math.sin(time + 4.188) * 0.5 + 0.5);\n\n        this.renderer.setPixel(x, y, [r * 255, g * 255, b * 255]);\n      }\n    }\n  }\n\n  /**\n   * Lava - Organic flowing lava/magma effect\n   */\n  _renderLava(state) {\n    const { width, height } = this.renderer;\n    const time = state.time || 0;\n\n    for (let x = 0; x < width; x++) {\n      for (let y = 0; y < height; y++) {\n        const uvX = x / width;\n        const uvY = y / height;\n\n        // Multiple noise layers for organic movement\n        const n1 = Math.sin(uvX * 8.0 + time * 0.7) * Math.cos(uvY * 6.0 + time * 0.5);\n        const n2 = Math.sin(uvX * 12.0 - time * 0.3) * Math.sin(uvY * 10.0 + time * 0.8);\n        const n3 = Math.cos((uvX + uvY) * 5.0 + time);\n\n        const value = (n1 + n2 + n3 + 3) / 6;\n\n        // Lava color palette (black -> red -> orange -> yellow)\n        let r, g, b;\n        if (value < 0.3) {\n          r = value * 3 * 100;\n          g = 0;\n          b = 0;\n        } else if (value < 0.6) {\n          r = 100 + (value - 0.3) * 3 * 155;\n          g = (value - 0.3) * 3 * 100;\n          b = 0;\n        } else {\n          r = 255;\n          g = 100 + (value - 0.6) * 2.5 * 155;\n          b = (value - 0.6) * 2.5 * 100;\n        }\n\n        this.renderer.setPixel(x, y, [r, g, b]);\n      }\n    }\n  }\n\n  /**\n   * Aurora - Northern lights effect\n   */\n  _renderAurora(state) {\n    const { width, height } = this.renderer;\n    const time = state.time || 0;\n\n    for (let x = 0; x < width; x++) {\n      for (let y = 0; y < height; y++) {\n        const uvX = x / width;\n        const uvY = y / height;\n\n        // Vertical wave bands\n        const wave1 = Math.sin(uvX * 6.0 + time) * 0.3;\n        const wave2 = Math.sin(uvX * 4.0 - time * 0.7) * 0.2;\n        const wave3 = Math.sin(uvX * 8.0 + time * 1.3) * 0.15;\n\n        const waveLine = 0.5 + wave1 + wave2 + wave3;\n        const distFromWave = Math.abs(uvY - waveLine);\n\n        // Fade based on distance from wave\n        const intensity = Math.max(0, 1 - distFromWave * 4);\n        const glow = Math.pow(intensity, 1.5);\n\n        // Aurora colors (greens, blues, purples)\n        const colorShift = Math.sin(uvX * 3.0 + time * 0.5);\n        const r = glow * (0.2 + colorShift * 0.3) * 255;\n        const g = glow * (0.8 + Math.sin(time + uvX) * 0.2) * 255;\n        const b = glow * (0.6 + colorShift * 0.4) * 255;\n\n        // Add background stars\n        const starChance = Math.sin(x * 127.1 + y * 311.7) * 0.5 + 0.5;\n        const starTwinkle = Math.sin(time * 3 + x + y) * 0.5 + 0.5;\n\n        let finalR = r;\n        let finalG = g;\n        let finalB = b;\n\n        if (starChance > 0.98 && intensity < 0.3) {\n          const starBright = starTwinkle * 180;\n          finalR = Math.max(r, starBright);\n          finalG = Math.max(g, starBright);\n          finalB = Math.max(b, starBright * 0.9);\n        }\n\n        this.renderer.setPixel(x, y, [finalR, finalG, finalB]);\n      }\n    }\n  }\n}\n", "/**\n * Color Effects Module\n * Effects that modify the colors of displayed text\n */\n\n/**\n * Convert HSV to RGB\n */\nfunction hsvToRgb(h, s, v) {\n  let r, g, b;\n  const i = Math.floor(h * 6);\n  const f = h * 6 - i;\n  const p = v * (1 - s);\n  const q = v * (1 - f * s);\n  const t = v * (1 - (1 - f) * s);\n\n  switch (i % 6) {\n    case 0: r = v; g = t; b = p; break;\n    case 1: r = q; g = v; b = p; break;\n    case 2: r = p; g = v; b = t; break;\n    case 3: r = p; g = q; b = v; break;\n    case 4: r = t; g = p; b = v; break;\n    case 5: r = v; g = p; b = q; break;\n  }\n\n  return [r * 255, g * 255, b * 255];\n}\n\n/**\n * Color Effects class - effects that modify pixel colors\n */\nexport class ColorEffects {\n  constructor(renderer) {\n    this.renderer = renderer;\n  }\n\n  /**\n   * Initialize effect state\n   */\n  init(effectName, state) {\n    switch (effectName) {\n      case 'color_cycle':\n        state.hue = 0;\n        break;\n\n      case 'rainbow_text':\n        state.offset = 0;\n        break;\n\n      case 'neon':\n        state.glowIntensity = 0;\n        state.direction = 1;\n        state.baseColor = state.fgColor || '#ff00ff'; // Default neon pink\n        break;\n    }\n  }\n\n  /**\n   * Step effect forward\n   */\n  step(effectName, state) {\n    switch (effectName) {\n      case 'color_cycle':\n        state.hue = (state.hue + 0.01) % 1;\n        break;\n\n      case 'rainbow_text':\n        state.offset = (state.offset + 0.02) % 1;\n        break;\n\n      case 'neon':\n        state.glowIntensity += state.direction * 0.05;\n        if (state.glowIntensity >= 1) {\n          state.glowIntensity = 1;\n          state.direction = -1;\n        } else if (state.glowIntensity <= 0.3) {\n          state.glowIntensity = 0.3;\n          state.direction = 1;\n        }\n        break;\n    }\n  }\n\n  /**\n   * Render effect to buffer\n   */\n  render(effectName, state, pixels) {\n    const { width, height } = this.renderer;\n    const displayPixels = pixels || [];\n\n    for (let y = 0; y < height; y++) {\n      for (let x = 0; x < width; x++) {\n        const color = displayPixels[y * width + x] || '#111';\n        let [r, g, b] = this._hexToRgb(color);\n        const isLit = r > 20 || g > 20 || b > 20;\n\n        if (isLit) {\n          switch (effectName) {\n            case 'color_cycle': {\n              // Cycle all lit pixels through the same color\n              const [nr, ng, nb] = hsvToRgb(state.hue, 1, 0.8);\n              // Preserve brightness ratio\n              const brightness = (r + g + b) / (3 * 255);\n              r = nr * brightness;\n              g = ng * brightness;\n              b = nb * brightness;\n              break;\n            }\n\n            case 'rainbow_text': {\n              // Rainbow gradient across the text\n              const hue = (state.offset + x / width) % 1;\n              const [nr, ng, nb] = hsvToRgb(hue, 1, 0.8);\n              // Preserve brightness ratio\n              const brightness = (r + g + b) / (3 * 255);\n              r = nr * brightness;\n              g = ng * brightness;\n              b = nb * brightness;\n              break;\n            }\n\n            case 'neon': {\n              // Pulsing neon glow effect\n              const baseColor = this._hexToRgb(state.baseColor || '#ff00ff');\n              const intensity = state.glowIntensity || 0.5;\n\n              // Core color with pulsing intensity\n              r = baseColor[0] * intensity;\n              g = baseColor[1] * intensity;\n              b = baseColor[2] * intensity;\n\n              // Add white highlight at peak glow\n              if (intensity > 0.8) {\n                const whiteMix = (intensity - 0.8) * 5; // 0-1 range\n                r = r + (255 - r) * whiteMix * 0.3;\n                g = g + (255 - g) * whiteMix * 0.3;\n                b = b + (255 - b) * whiteMix * 0.3;\n              }\n              break;\n            }\n          }\n        }\n\n        this.renderer.setPixel(x, y, [r, g, b]);\n      }\n    }\n  }\n\n  /**\n   * Convert hex color to RGB array\n   */\n  _hexToRgb(hex) {\n    if (!hex || hex === '#111' || hex === '#000') return [17, 17, 17];\n    if (hex === '#050505') return [5, 5, 5];\n\n    const result = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hex);\n    return result\n      ? [parseInt(result[1], 16), parseInt(result[2], 16), parseInt(result[3], 16)]\n      : [17, 17, 17];\n  }\n}\n", "/**\n * Effects System - Main entry point\n * Modular effect management for LED matrix displays\n */\n\nimport { TextEffects } from './text-effects.js';\nimport { AmbientEffects } from './ambient-effects.js';\nimport { ColorEffects } from './color-effects.js';\n\n// Effect categories\nexport const EFFECT_CATEGORIES = {\n  TEXT: 'text',      // Effects that modify displayed text\n  AMBIENT: 'ambient', // Standalone visual effects (ignore text)\n  COLOR: 'color'     // Color modifications applied to text\n};\n\n// All available effects with metadata\nexport const EFFECTS = {\n  // Text effects - modify how text is displayed\n  fixed: { category: EFFECT_CATEGORIES.TEXT, name: 'Fixed', description: 'Static display' },\n  scroll_ltr: { category: EFFECT_CATEGORIES.TEXT, name: 'Scroll Left', description: 'Text scrolls left to right' },\n  scroll_rtl: { category: EFFECT_CATEGORIES.TEXT, name: 'Scroll Right', description: 'Text scrolls right to left' },\n  blink: { category: EFFECT_CATEGORIES.TEXT, name: 'Blink', description: 'Text blinks on/off' },\n  breeze: { category: EFFECT_CATEGORIES.TEXT, name: 'Breeze', description: 'Gentle wave brightness' },\n  snow: { category: EFFECT_CATEGORIES.TEXT, name: 'Snow', description: 'Sparkle effect' },\n  laser: { category: EFFECT_CATEGORIES.TEXT, name: 'Laser', description: 'Scanning beam' },\n  fade: { category: EFFECT_CATEGORIES.TEXT, name: 'Fade', description: 'Fade in/out' },\n  typewriter: { category: EFFECT_CATEGORIES.TEXT, name: 'Typewriter', description: 'Characters appear one by one' },\n  bounce: { category: EFFECT_CATEGORIES.TEXT, name: 'Bounce', description: 'Text bounces back and forth' },\n  sparkle: { category: EFFECT_CATEGORIES.TEXT, name: 'Sparkle', description: 'Random sparkle overlay' },\n\n  // Ambient effects - standalone visual displays\n  rainbow: { category: EFFECT_CATEGORIES.AMBIENT, name: 'Rainbow', description: 'HSV rainbow gradient' },\n  matrix: { category: EFFECT_CATEGORIES.AMBIENT, name: 'Matrix', description: 'Digital rain effect' },\n  plasma: { category: EFFECT_CATEGORIES.AMBIENT, name: 'Plasma', description: 'Classic plasma waves' },\n  gradient: { category: EFFECT_CATEGORIES.AMBIENT, name: 'Gradient', description: 'Moving color gradients' },\n  fire: { category: EFFECT_CATEGORIES.AMBIENT, name: 'Fire', description: 'Fire/flame simulation' },\n  water: { category: EFFECT_CATEGORIES.AMBIENT, name: 'Water', description: 'Ripple/wave effect' },\n  stars: { category: EFFECT_CATEGORIES.AMBIENT, name: 'Stars', description: 'Twinkling starfield' },\n  confetti: { category: EFFECT_CATEGORIES.AMBIENT, name: 'Confetti', description: 'Falling colored particles' },\n  // Shader-inspired effects (ported from ipixel-shader GLSL)\n  plasma_wave: { category: EFFECT_CATEGORIES.AMBIENT, name: 'Plasma Wave', description: 'Multi-frequency sine waves' },\n  radial_pulse: { category: EFFECT_CATEGORIES.AMBIENT, name: 'Radial Pulse', description: 'Expanding ring patterns' },\n  hypnotic: { category: EFFECT_CATEGORIES.AMBIENT, name: 'Hypnotic', description: 'Spiral pattern' },\n  lava: { category: EFFECT_CATEGORIES.AMBIENT, name: 'Lava', description: 'Flowing lava/magma' },\n  aurora: { category: EFFECT_CATEGORIES.AMBIENT, name: 'Aurora', description: 'Northern lights' },\n\n  // Color effects - applied to text colors\n  color_cycle: { category: EFFECT_CATEGORIES.COLOR, name: 'Color Cycle', description: 'Cycle through colors' },\n  rainbow_text: { category: EFFECT_CATEGORIES.COLOR, name: 'Rainbow Text', description: 'Rainbow gradient on text' },\n  neon: { category: EFFECT_CATEGORIES.COLOR, name: 'Neon', description: 'Pulsing neon glow' }\n};\n\n/**\n * Effect Manager - handles effect initialization and execution\n */\nexport class EffectManager {\n  constructor(renderer) {\n    this.renderer = renderer;\n    this.textEffects = new TextEffects(renderer);\n    this.ambientEffects = new AmbientEffects(renderer);\n    this.colorEffects = new ColorEffects(renderer);\n    this.currentEffect = 'fixed';\n    this.effectState = {};\n  }\n\n  /**\n   * Get effect metadata\n   */\n  getEffectInfo(effectName) {\n    return EFFECTS[effectName] || EFFECTS.fixed;\n  }\n\n  /**\n   * Get all effects by category\n   */\n  getEffectsByCategory(category) {\n    return Object.entries(EFFECTS)\n      .filter(([_, info]) => info.category === category)\n      .map(([name, info]) => ({ name, ...info }));\n  }\n\n  /**\n   * Initialize an effect\n   */\n  initEffect(effectName, options = {}) {\n    const info = this.getEffectInfo(effectName);\n    this.currentEffect = effectName;\n    this.effectState = { tick: 0, ...options };\n\n    switch (info.category) {\n      case EFFECT_CATEGORIES.TEXT:\n        this.textEffects.init(effectName, this.effectState);\n        break;\n      case EFFECT_CATEGORIES.AMBIENT:\n        this.ambientEffects.init(effectName, this.effectState);\n        break;\n      case EFFECT_CATEGORIES.COLOR:\n        this.colorEffects.init(effectName, this.effectState);\n        break;\n    }\n\n    return this.effectState;\n  }\n\n  /**\n   * Step the effect forward (called on frame interval)\n   */\n  step() {\n    const info = this.getEffectInfo(this.currentEffect);\n    this.effectState.tick = (this.effectState.tick || 0) + 1;\n\n    switch (info.category) {\n      case EFFECT_CATEGORIES.TEXT:\n        this.textEffects.step(this.currentEffect, this.effectState);\n        break;\n      case EFFECT_CATEGORIES.AMBIENT:\n        this.ambientEffects.step(this.currentEffect, this.effectState);\n        break;\n      case EFFECT_CATEGORIES.COLOR:\n        this.colorEffects.step(this.currentEffect, this.effectState);\n        break;\n    }\n  }\n\n  /**\n   * Render the current frame\n   */\n  render(pixels, extendedPixels, extendedWidth) {\n    const info = this.getEffectInfo(this.currentEffect);\n\n    switch (info.category) {\n      case EFFECT_CATEGORIES.AMBIENT:\n        // Ambient effects render directly, ignoring text\n        this.ambientEffects.render(this.currentEffect, this.effectState);\n        break;\n      case EFFECT_CATEGORIES.TEXT:\n        // Text effects modify how pixels are displayed\n        this.textEffects.render(this.currentEffect, this.effectState, pixels, extendedPixels, extendedWidth);\n        break;\n      case EFFECT_CATEGORIES.COLOR:\n        // Color effects modify pixel colors\n        this.colorEffects.render(this.currentEffect, this.effectState, pixels);\n        break;\n    }\n  }\n\n  /**\n   * Check if effect is ambient (standalone, ignores text)\n   */\n  isAmbient(effectName) {\n    return this.getEffectInfo(effectName).category === EFFECT_CATEGORIES.AMBIENT;\n  }\n\n  /**\n   * Check if effect needs animation loop\n   */\n  needsAnimation(effectName) {\n    return effectName !== 'fixed';\n  }\n}\n\n// Export effect lists for UI\nexport const TEXT_EFFECTS = Object.entries(EFFECTS)\n  .filter(([_, info]) => info.category === EFFECT_CATEGORIES.TEXT)\n  .map(([name]) => name);\n\nexport const AMBIENT_EFFECTS = Object.entries(EFFECTS)\n  .filter(([_, info]) => info.category === EFFECT_CATEGORIES.AMBIENT)\n  .map(([name]) => name);\n\nexport const COLOR_EFFECTS = Object.entries(EFFECTS)\n  .filter(([_, info]) => info.category === EFFECT_CATEGORIES.COLOR)\n  .map(([name]) => name);\n\nexport const ALL_EFFECTS = Object.keys(EFFECTS);\n", "/**\n * Canvas-based LED Matrix Renderer\n * High-performance replacement for SVG renderer\n * Uses ImageData for direct pixel manipulation\n */\n\nimport { EffectManager, EFFECTS } from './effects/index.js';\n\n/**\n * Canvas LED Matrix Renderer\n * Much faster than SVG for pixel-level updates\n */\nexport class CanvasLEDRenderer {\n  constructor(container, options = {}) {\n    this.container = container;\n    this.width = options.width || 64;\n    this.height = options.height || 16;\n    this.pixelGap = options.pixelGap || 0.15;\n    this.glowEnabled = options.glow !== false;\n\n    // Scale factor for crisp LED pixels\n    this.scale = options.scale || 8;\n\n    // Buffers\n    this.buffer = [];\n    this._initBuffer();\n\n    // Extended pixels for scrolling\n    this._colorPixels = [];\n    this._extendedColorPixels = [];\n    this.extendedWidth = this.width;\n\n    // Animation state\n    this.effect = 'fixed';\n    this.speed = 50;\n    this.animationId = null;\n    this.lastFrameTime = 0;\n    this._isRunning = false;\n\n    // Canvas elements\n    this._canvas = null;\n    this._ctx = null;\n    this._glowCanvas = null;\n    this._glowCtx = null;\n    this._wrapper = null;\n    this._canvasCreated = false;\n\n    // Effect manager\n    this.effectManager = new EffectManager(this);\n  }\n\n  _initBuffer() {\n    this.buffer = [];\n    for (let i = 0; i < this.width * this.height; i++) {\n      this.buffer.push([0, 0, 0]);\n    }\n  }\n\n  /**\n   * Create the canvas elements\n   */\n  _createCanvas() {\n    const canvasWidth = this.width * this.scale;\n    const canvasHeight = this.height * this.scale;\n\n    // Create wrapper for layering\n    this._wrapper = document.createElement('div');\n    this._wrapper.style.cssText = `\n      position: relative;\n      width: 100%;\n      aspect-ratio: ${this.width} / ${this.height};\n      background: #0a0a0a;\n      border-radius: 4px;\n      overflow: hidden;\n    `;\n\n    // Glow layer (behind main canvas, blurred)\n    if (this.glowEnabled) {\n      this._glowCanvas = document.createElement('canvas');\n      this._glowCanvas.width = canvasWidth;\n      this._glowCanvas.height = canvasHeight;\n      this._glowCanvas.style.cssText = `\n        position: absolute;\n        top: 0;\n        left: 0;\n        width: 100%;\n        height: 100%;\n        filter: blur(${this.scale * 0.8}px);\n        opacity: 0.6;\n        image-rendering: pixelated;\n      `;\n      this._glowCtx = this._glowCanvas.getContext('2d', { alpha: false });\n      this._wrapper.appendChild(this._glowCanvas);\n    }\n\n    // Main canvas\n    this._canvas = document.createElement('canvas');\n    this._canvas.width = canvasWidth;\n    this._canvas.height = canvasHeight;\n    this._canvas.style.cssText = `\n      position: absolute;\n      top: 0;\n      left: 0;\n      width: 100%;\n      height: 100%;\n      image-rendering: pixelated;\n      image-rendering: crisp-edges;\n    `;\n    this._ctx = this._canvas.getContext('2d', { alpha: false });\n    this._ctx.imageSmoothingEnabled = false;\n    this._wrapper.appendChild(this._canvas);\n\n    // Attach to container\n    if (this.container && this.container.isConnected !== false) {\n      this.container.innerHTML = '';\n      this.container.appendChild(this._wrapper);\n    }\n\n    this._canvasCreated = true;\n  }\n\n  /**\n   * Ensure canvas is in the container\n   */\n  _ensureCanvasInContainer() {\n    if (!this.container) return false;\n\n    if (this._wrapper && this._wrapper.parentNode === this.container) {\n      return true;\n    }\n\n    if (this._wrapper && this.container.isConnected !== false) {\n      this.container.innerHTML = '';\n      this.container.appendChild(this._wrapper);\n      return true;\n    }\n\n    return false;\n  }\n\n  /**\n   * Set pixel in buffer\n   */\n  setPixel(x, y, color) {\n    if (x >= 0 && x < this.width && y >= 0 && y < this.height) {\n      const idx = y * this.width + x;\n      if (idx < this.buffer.length) {\n        this.buffer[idx] = color;\n      }\n    }\n  }\n\n  /**\n   * Clear buffer to black\n   */\n  clear() {\n    for (let i = 0; i < this.buffer.length; i++) {\n      this.buffer[i] = [0, 0, 0];\n    }\n  }\n\n  /**\n   * Flush buffer to canvas - the main rendering function\n   */\n  flush() {\n    if (!this._canvasCreated) {\n      this._createCanvas();\n    } else if (!this._ensureCanvasInContainer()) {\n      this._createCanvas();\n    }\n\n    const ctx = this._ctx;\n    const scale = this.scale;\n    const gap = Math.max(1, Math.floor(scale * this.pixelGap));\n    const pixelSize = scale - gap;\n    const cornerRadius = Math.max(1, Math.floor(scale * 0.15));\n\n    // Clear to dark background\n    ctx.fillStyle = '#0a0a0a';\n    ctx.fillRect(0, 0, this._canvas.width, this._canvas.height);\n\n    // Draw pixels\n    for (let y = 0; y < this.height; y++) {\n      for (let x = 0; x < this.width; x++) {\n        const idx = y * this.width + x;\n        const color = this.buffer[idx];\n\n        if (!color || !Array.isArray(color)) continue;\n\n        const [r, g, b] = color;\n        const px = x * scale;\n        const py = y * scale;\n\n        ctx.fillStyle = `rgb(${Math.round(r)}, ${Math.round(g)}, ${Math.round(b)})`;\n\n        // Draw rounded rect for LED pixel look\n        this._roundRect(ctx, px, py, pixelSize, pixelSize, cornerRadius);\n      }\n    }\n\n    // Update glow layer\n    if (this.glowEnabled && this._glowCtx) {\n      this._glowCtx.drawImage(this._canvas, 0, 0);\n    }\n  }\n\n  /**\n   * Draw a rounded rectangle\n   */\n  _roundRect(ctx, x, y, w, h, r) {\n    ctx.beginPath();\n    ctx.moveTo(x + r, y);\n    ctx.lineTo(x + w - r, y);\n    ctx.quadraticCurveTo(x + w, y, x + w, y + r);\n    ctx.lineTo(x + w, y + h - r);\n    ctx.quadraticCurveTo(x + w, y + h, x + w - r, y + h);\n    ctx.lineTo(x + r, y + h);\n    ctx.quadraticCurveTo(x, y + h, x, y + h - r);\n    ctx.lineTo(x, y + r);\n    ctx.quadraticCurveTo(x, y, x + r, y);\n    ctx.closePath();\n    ctx.fill();\n  }\n\n  /**\n   * Set pixel data from color string array\n   */\n  setData(pixels, extendedPixels = null, extendedWidth = null) {\n    this._colorPixels = pixels || [];\n\n    if (extendedPixels) {\n      this._extendedColorPixels = extendedPixels;\n      this.extendedWidth = extendedWidth || this.width;\n    } else {\n      this._extendedColorPixels = pixels || [];\n      this.extendedWidth = this.width;\n    }\n  }\n\n  /**\n   * Set animation effect and speed\n   */\n  setEffect(effect, speed = 50) {\n    const wasRunning = this._isRunning;\n\n    if (this.effect !== effect) {\n      this.effect = effect;\n      this.effectManager.initEffect(effect, { speed });\n    }\n\n    this.speed = speed;\n\n    if (wasRunning && effect !== 'fixed') {\n      this.start();\n    }\n  }\n\n  /**\n   * Start the animation loop\n   */\n  start() {\n    if (this._isRunning) return;\n    this._isRunning = true;\n    this.lastFrameTime = performance.now();\n    this._animate();\n  }\n\n  /**\n   * Stop the animation loop\n   */\n  stop() {\n    this._isRunning = false;\n    if (this.animationId) {\n      cancelAnimationFrame(this.animationId);\n      this.animationId = null;\n    }\n  }\n\n  /**\n   * Check if animation is running\n   */\n  get isRunning() {\n    return this._isRunning;\n  }\n\n  /**\n   * Animation loop\n   */\n  _animate() {\n    if (!this._isRunning) return;\n\n    const now = performance.now();\n\n    // Frame interval based on speed (1 = slow ~500ms, 100 = fast ~30ms)\n    const frameInterval = 500 - (this.speed - 1) * 4.7;\n\n    if (now - this.lastFrameTime >= frameInterval) {\n      this.lastFrameTime = now;\n      this.effectManager.step();\n    }\n\n    this._renderFrame();\n    this.animationId = requestAnimationFrame(() => this._animate());\n  }\n\n  /**\n   * Render current frame to buffer and flush\n   */\n  _renderFrame() {\n    this.effectManager.render(\n      this._colorPixels,\n      this._extendedColorPixels,\n      this.extendedWidth\n    );\n    this.flush();\n  }\n\n  /**\n   * Render a single static frame\n   */\n  renderStatic() {\n    if (!this._canvasCreated) {\n      this._createCanvas();\n    }\n    this._renderFrame();\n  }\n\n  /**\n   * Update dimensions\n   */\n  setDimensions(width, height) {\n    if (width !== this.width || height !== this.height) {\n      this.width = width;\n      this.height = height;\n      this.extendedWidth = width;\n      this._initBuffer();\n      this._canvasCreated = false;\n\n      this.effectManager = new EffectManager(this);\n      if (this.effect !== 'fixed') {\n        this.effectManager.initEffect(this.effect, { speed: this.speed });\n      }\n    }\n  }\n\n  /**\n   * Update container reference\n   */\n  setContainer(container) {\n    if (container !== this.container) {\n      this.container = container;\n      if (this._wrapper && container) {\n        container.innerHTML = '';\n        container.appendChild(this._wrapper);\n      }\n    }\n  }\n\n  /**\n   * Destroy renderer and clean up\n   */\n  destroy() {\n    this.stop();\n    this._canvas = null;\n    this._ctx = null;\n    this._glowCanvas = null;\n    this._glowCtx = null;\n    this._wrapper = null;\n    this._canvasCreated = false;\n  }\n}\n\n/**\n * High-performance Canvas renderer using ImageData\n * Even faster for full-frame updates (complex effects)\n */\nexport class ImageDataLEDRenderer {\n  constructor(container, options = {}) {\n    this.container = container;\n    this.width = options.width || 64;\n    this.height = options.height || 16;\n    this.pixelGap = options.pixelGap || 0.15;\n    this.glowEnabled = options.glow !== false;\n\n    // Scale factor\n    this.scale = options.scale || 8;\n\n    // Buffer (RGB array)\n    this.buffer = [];\n    this._initBuffer();\n\n    // Extended pixels for scrolling\n    this._colorPixels = [];\n    this._extendedColorPixels = [];\n    this.extendedWidth = this.width;\n\n    // Animation state\n    this.effect = 'fixed';\n    this.speed = 50;\n    this.animationId = null;\n    this.lastFrameTime = 0;\n    this._isRunning = false;\n\n    // Canvas elements\n    this._canvas = null;\n    this._ctx = null;\n    this._imageData = null;\n    this._glowCanvas = null;\n    this._glowCtx = null;\n    this._wrapper = null;\n    this._canvasCreated = false;\n\n    // Pre-computed pixel template\n    this._pixelTemplate = null;\n\n    // Effect manager\n    this.effectManager = new EffectManager(this);\n  }\n\n  _initBuffer() {\n    this.buffer = [];\n    for (let i = 0; i < this.width * this.height; i++) {\n      this.buffer.push([0, 0, 0]);\n    }\n  }\n\n  /**\n   * Create canvas and pre-compute pixel template\n   */\n  _createCanvas() {\n    const canvasWidth = this.width * this.scale;\n    const canvasHeight = this.height * this.scale;\n\n    // Create wrapper\n    this._wrapper = document.createElement('div');\n    this._wrapper.style.cssText = `\n      position: relative;\n      width: 100%;\n      aspect-ratio: ${this.width} / ${this.height};\n      background: #0a0a0a;\n      border-radius: 4px;\n      overflow: hidden;\n    `;\n\n    // Glow layer\n    if (this.glowEnabled) {\n      this._glowCanvas = document.createElement('canvas');\n      this._glowCanvas.width = canvasWidth;\n      this._glowCanvas.height = canvasHeight;\n      this._glowCanvas.style.cssText = `\n        position: absolute;\n        top: 0;\n        left: 0;\n        width: 100%;\n        height: 100%;\n        filter: blur(${this.scale * 0.6}px);\n        opacity: 0.5;\n      `;\n      this._glowCtx = this._glowCanvas.getContext('2d', { alpha: false });\n      this._wrapper.appendChild(this._glowCanvas);\n    }\n\n    // Main canvas\n    this._canvas = document.createElement('canvas');\n    this._canvas.width = canvasWidth;\n    this._canvas.height = canvasHeight;\n    this._canvas.style.cssText = `\n      position: absolute;\n      top: 0;\n      left: 0;\n      width: 100%;\n      height: 100%;\n      image-rendering: pixelated;\n      image-rendering: crisp-edges;\n    `;\n    this._ctx = this._canvas.getContext('2d', { alpha: false });\n    this._wrapper.appendChild(this._canvas);\n\n    // Create ImageData buffer\n    this._imageData = this._ctx.createImageData(canvasWidth, canvasHeight);\n\n    // Pre-compute pixel mask template\n    this._createPixelTemplate();\n\n    // Fill background\n    this._fillBackground();\n\n    // Attach to container\n    if (this.container && this.container.isConnected !== false) {\n      this.container.innerHTML = '';\n      this.container.appendChild(this._wrapper);\n    }\n\n    this._canvasCreated = true;\n  }\n\n  /**\n   * Create a template mask for LED pixels (with gaps and rounded corners)\n   */\n  _createPixelTemplate() {\n    const scale = this.scale;\n    const gap = Math.max(1, Math.floor(scale * this.pixelGap));\n    const pixelSize = scale - gap;\n    const radius = Math.max(1, Math.floor(scale * 0.15));\n\n    // Template for one LED pixel\n    this._pixelTemplate = [];\n\n    for (let py = 0; py < scale; py++) {\n      for (let px = 0; px < scale; px++) {\n        // Check if inside the rounded rect\n        let inside = false;\n\n        if (px < pixelSize && py < pixelSize) {\n          // Check corners\n          if (px < radius && py < radius) {\n            // Top-left corner\n            const dx = radius - px;\n            const dy = radius - py;\n            inside = (dx * dx + dy * dy) <= (radius * radius);\n          } else if (px >= pixelSize - radius && py < radius) {\n            // Top-right corner\n            const dx = px - (pixelSize - radius - 1);\n            const dy = radius - py;\n            inside = (dx * dx + dy * dy) <= (radius * radius);\n          } else if (px < radius && py >= pixelSize - radius) {\n            // Bottom-left corner\n            const dx = radius - px;\n            const dy = py - (pixelSize - radius - 1);\n            inside = (dx * dx + dy * dy) <= (radius * radius);\n          } else if (px >= pixelSize - radius && py >= pixelSize - radius) {\n            // Bottom-right corner\n            const dx = px - (pixelSize - radius - 1);\n            const dy = py - (pixelSize - radius - 1);\n            inside = (dx * dx + dy * dy) <= (radius * radius);\n          } else {\n            inside = true;\n          }\n        }\n\n        this._pixelTemplate.push(inside);\n      }\n    }\n  }\n\n  /**\n   * Fill ImageData with background color\n   */\n  _fillBackground() {\n    const data = this._imageData.data;\n    const bgR = 10, bgG = 10, bgB = 10;\n\n    for (let i = 0; i < data.length; i += 4) {\n      data[i] = bgR;\n      data[i + 1] = bgG;\n      data[i + 2] = bgB;\n      data[i + 3] = 255;\n    }\n  }\n\n  _ensureCanvasInContainer() {\n    if (!this.container) return false;\n\n    if (this._wrapper && this._wrapper.parentNode === this.container) {\n      return true;\n    }\n\n    if (this._wrapper && this.container.isConnected !== false) {\n      this.container.innerHTML = '';\n      this.container.appendChild(this._wrapper);\n      return true;\n    }\n\n    return false;\n  }\n\n  setPixel(x, y, color) {\n    if (x >= 0 && x < this.width && y >= 0 && y < this.height) {\n      const idx = y * this.width + x;\n      if (idx < this.buffer.length) {\n        this.buffer[idx] = color;\n      }\n    }\n  }\n\n  clear() {\n    for (let i = 0; i < this.buffer.length; i++) {\n      this.buffer[i] = [0, 0, 0];\n    }\n  }\n\n  /**\n   * Flush buffer to canvas using ImageData (fastest method)\n   */\n  flush() {\n    if (!this._canvasCreated) {\n      this._createCanvas();\n    } else if (!this._ensureCanvasInContainer()) {\n      this._createCanvas();\n    }\n\n    const data = this._imageData.data;\n    const scale = this.scale;\n    const canvasWidth = this.width * scale;\n    const template = this._pixelTemplate;\n    const bgR = 10, bgG = 10, bgB = 10;\n\n    // Update each LED pixel\n    for (let ledY = 0; ledY < this.height; ledY++) {\n      for (let ledX = 0; ledX < this.width; ledX++) {\n        const bufferIdx = ledY * this.width + ledX;\n        const color = this.buffer[bufferIdx];\n\n        if (!color || !Array.isArray(color)) continue;\n\n        const r = Math.round(color[0]);\n        const g = Math.round(color[1]);\n        const b = Math.round(color[2]);\n\n        const baseX = ledX * scale;\n        const baseY = ledY * scale;\n\n        // Fill in the scaled pixel using template\n        for (let py = 0; py < scale; py++) {\n          for (let px = 0; px < scale; px++) {\n            const templateIdx = py * scale + px;\n            const canvasIdx = ((baseY + py) * canvasWidth + (baseX + px)) * 4;\n\n            if (template[templateIdx]) {\n              data[canvasIdx] = r;\n              data[canvasIdx + 1] = g;\n              data[canvasIdx + 2] = b;\n              data[canvasIdx + 3] = 255;\n            } else {\n              data[canvasIdx] = bgR;\n              data[canvasIdx + 1] = bgG;\n              data[canvasIdx + 2] = bgB;\n              data[canvasIdx + 3] = 255;\n            }\n          }\n        }\n      }\n    }\n\n    // Put ImageData to canvas (single draw call!)\n    this._ctx.putImageData(this._imageData, 0, 0);\n\n    // Update glow layer\n    if (this.glowEnabled && this._glowCtx) {\n      this._glowCtx.drawImage(this._canvas, 0, 0);\n    }\n  }\n\n  setData(pixels, extendedPixels = null, extendedWidth = null) {\n    this._colorPixels = pixels || [];\n\n    if (extendedPixels) {\n      this._extendedColorPixels = extendedPixels;\n      this.extendedWidth = extendedWidth || this.width;\n    } else {\n      this._extendedColorPixels = pixels || [];\n      this.extendedWidth = this.width;\n    }\n  }\n\n  setEffect(effect, speed = 50) {\n    const wasRunning = this._isRunning;\n\n    if (this.effect !== effect) {\n      this.effect = effect;\n      this.effectManager.initEffect(effect, { speed });\n    }\n\n    this.speed = speed;\n\n    if (wasRunning && effect !== 'fixed') {\n      this.start();\n    }\n  }\n\n  start() {\n    if (this._isRunning) return;\n    this._isRunning = true;\n    this.lastFrameTime = performance.now();\n    this._animate();\n  }\n\n  stop() {\n    this._isRunning = false;\n    if (this.animationId) {\n      cancelAnimationFrame(this.animationId);\n      this.animationId = null;\n    }\n  }\n\n  get isRunning() {\n    return this._isRunning;\n  }\n\n  _animate() {\n    if (!this._isRunning) return;\n\n    const now = performance.now();\n    const frameInterval = 500 - (this.speed - 1) * 4.7;\n\n    if (now - this.lastFrameTime >= frameInterval) {\n      this.lastFrameTime = now;\n      this.effectManager.step();\n    }\n\n    this._renderFrame();\n    this.animationId = requestAnimationFrame(() => this._animate());\n  }\n\n  _renderFrame() {\n    this.effectManager.render(\n      this._colorPixels,\n      this._extendedColorPixels,\n      this.extendedWidth\n    );\n    this.flush();\n  }\n\n  renderStatic() {\n    if (!this._canvasCreated) {\n      this._createCanvas();\n    }\n    this._renderFrame();\n  }\n\n  setDimensions(width, height) {\n    if (width !== this.width || height !== this.height) {\n      this.width = width;\n      this.height = height;\n      this.extendedWidth = width;\n      this._initBuffer();\n      this._canvasCreated = false;\n\n      this.effectManager = new EffectManager(this);\n      if (this.effect !== 'fixed') {\n        this.effectManager.initEffect(this.effect, { speed: this.speed });\n      }\n    }\n  }\n\n  setContainer(container) {\n    if (container !== this.container) {\n      this.container = container;\n      if (this._wrapper && container) {\n        container.innerHTML = '';\n        container.appendChild(this._wrapper);\n      }\n    }\n  }\n\n  destroy() {\n    this.stop();\n    this._canvas = null;\n    this._ctx = null;\n    this._imageData = null;\n    this._glowCanvas = null;\n    this._glowCtx = null;\n    this._wrapper = null;\n    this._canvasCreated = false;\n    this._pixelTemplate = null;\n  }\n}\n\n// Export the fastest renderer as default\nexport { ImageDataLEDRenderer as LEDMatrixRenderer };\n", "/**\n * Shared state management for iPIXEL cards\n * Handles localStorage persistence and cross-card synchronization\n */\n\nexport const IPIXEL_STORAGE_KEY = 'iPIXEL_DisplayState';\n\nconst DEFAULT_STATE = {\n  text: '',\n  mode: 'text',\n  effect: 'fixed',\n  speed: 50,\n  fgColor: '#ff6600',\n  bgColor: '#000000',\n  font: 'VCR_OSD_MONO',\n  lastUpdate: 0\n};\n\nexport function loadDisplayState() {\n  try {\n    const saved = localStorage.getItem(IPIXEL_STORAGE_KEY);\n    if (saved) {\n      return JSON.parse(saved);\n    }\n  } catch (e) {\n    console.warn('iPIXEL: Could not load saved state', e);\n  }\n  return { ...DEFAULT_STATE };\n}\n\nexport function saveDisplayState(state) {\n  try {\n    localStorage.setItem(IPIXEL_STORAGE_KEY, JSON.stringify(state));\n  } catch (e) {\n    console.warn('iPIXEL: Could not save state', e);\n  }\n}\n\n// Initialize global state\nif (!window.iPIXELDisplayState) {\n  window.iPIXELDisplayState = loadDisplayState();\n}\n\nexport function getDisplayState() {\n  return window.iPIXELDisplayState;\n}\n\nexport function updateDisplayState(updates) {\n  window.iPIXELDisplayState = {\n    ...window.iPIXELDisplayState,\n    ...updates,\n    lastUpdate: Date.now()\n  };\n  saveDisplayState(window.iPIXELDisplayState);\n  window.dispatchEvent(new CustomEvent('ipixel-display-update', {\n    detail: window.iPIXELDisplayState\n  }));\n  return window.iPIXELDisplayState;\n}\n", "/**\n * iPIXEL Display Card\n * LED matrix preview with power control and discrete pixel animation\n * Fixed to preserve renderer state and resolution across re-renders\n */\n\nimport { iPIXELCardBase } from '../base.js';\nimport { iPIXELCardStyles } from '../styles.js';\nimport { textToPixels, textToScrollPixels } from '../font.js';\nimport { textToPixelsCanvas, textToScrollPixelsCanvas, loadFont, isFontLoaded } from '../canvas-font.js';\nimport { textToPixelsBdf, textToScrollPixelsBdf, loadBdfFont, isBdfFontLoaded, getHeightKey } from '../bdf-font.js';\nimport { LEDMatrixRenderer, createPixelSvg, EFFECTS } from '../renderer.js';\nimport { getDisplayState, updateDisplayState } from '../state.js';\n\n// Global renderer cache - preserves renderer across card re-renders\nconst rendererCache = new Map();\n\nexport class iPIXELDisplayCard extends iPIXELCardBase {\n  constructor() {\n    super();\n    this._renderer = null;\n    this._displayContainer = null;\n    this._lastState = null;\n    this._cachedResolution = null; // Cache resolution\n    this._rendererId = null;\n\n    this._handleDisplayUpdate = (e) => {\n      this._updateDisplay(e.detail);\n    };\n    window.addEventListener('ipixel-display-update', this._handleDisplayUpdate);\n  }\n\n  connectedCallback() {\n    // Generate unique ID for this card instance\n    if (!this._rendererId) {\n      this._rendererId = `renderer_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\n    }\n\n    // Restore renderer from cache if available\n    if (rendererCache.has(this._rendererId)) {\n      this._renderer = rendererCache.get(this._rendererId);\n    }\n\n    // Preload BDF fonts (preferred for pixel-perfect rendering)\n    loadBdfFont('VCR_OSD_MONO', 16).then(() => {\n      if (this._lastState) this._updateDisplay(this._lastState);\n    });\n    loadBdfFont('VCR_OSD_MONO', 24);\n    loadBdfFont('VCR_OSD_MONO', 32);\n    loadBdfFont('CUSONG', 16);\n    loadBdfFont('CUSONG', 24);\n    loadBdfFont('CUSONG', 32);\n\n    // Also preload TTF fonts as fallback\n    loadFont('VCR_OSD_MONO');\n    loadFont('CUSONG');\n  }\n\n  disconnectedCallback() {\n    window.removeEventListener('ipixel-display-update', this._handleDisplayUpdate);\n\n    // Don't destroy renderer - cache it for reconnection\n    if (this._renderer && this._rendererId) {\n      this._renderer.stop();\n      rendererCache.set(this._rendererId, this._renderer);\n    }\n  }\n\n  /**\n   * Get resolution with caching and fallback\n   */\n  _getResolutionCached() {\n    const [sensorWidth, sensorHeight] = this.getResolution();\n\n    // If sensors return valid non-default values, use them and cache\n    if (sensorWidth > 0 && sensorHeight > 0 && sensorWidth !== 64) {\n      this._cachedResolution = [sensorWidth, sensorHeight];\n      // Also save to localStorage for persistence\n      try {\n        localStorage.setItem('iPIXEL_Resolution', JSON.stringify([sensorWidth, sensorHeight]));\n      } catch (e) { }\n      return this._cachedResolution;\n    }\n\n    // Check localStorage first (source of truth for preview mode / BLE auto-detect)\n    try {\n      const saved = localStorage.getItem('iPIXEL_Resolution');\n      if (saved) {\n        const parsed = JSON.parse(saved);\n        if (Array.isArray(parsed) && parsed.length === 2 && parsed[0] > 0 && parsed[1] > 0) {\n          this._cachedResolution = parsed;\n          return parsed;\n        }\n      }\n    } catch (e) { }\n\n    // If we have cached resolution (from previous sensor read), use it\n    if (this._cachedResolution) {\n      return this._cachedResolution;\n    }\n\n    // Fall back to config or default\n    if (this._config?.width && this._config?.height) {\n      return [this._config.width, this._config.height];\n    }\n\n    return [sensorWidth || 64, sensorHeight || 16];\n  }\n\n  /**\n   * Update the display with new state\n   */\n  _updateDisplay(state) {\n    if (!this._displayContainer) return;\n\n    const [width, height] = this._getResolutionCached();\n    const isOn = this.isOn();\n\n    // Ensure renderer exists and has correct dimensions\n    if (!this._renderer) {\n      this._renderer = new LEDMatrixRenderer(this._displayContainer, { width, height });\n      if (this._rendererId) {\n        rendererCache.set(this._rendererId, this._renderer);\n      }\n    } else {\n      // Update container reference in case it changed\n      this._renderer.setContainer(this._displayContainer);\n      // Update dimensions if changed\n      if (this._renderer.width !== width || this._renderer.height !== height) {\n        this._renderer.setDimensions(width, height);\n      }\n    }\n\n    if (!isOn) {\n      // Display off - show blank using renderer (consistent with on state)\n      this._renderer.setData([]);\n      this._renderer.setEffect('fixed', 50);\n      this._renderer.stop();\n      this._renderer.renderStatic();\n      return;\n    }\n\n    const text = state?.text || '';\n    const effect = state?.effect || 'fixed';\n    const speed = state?.speed || 50;\n    const fgColor = state?.fgColor || '#ff6600';\n    const bgColor = state?.bgColor || '#111';\n    const mode = state?.mode || 'text';\n    const font = state?.font || 'VCR_OSD_MONO';\n\n    // Store state for re-render after font loads\n    this._lastState = state;\n\n    // Determine display text based on mode\n    let displayText = text;\n    let displayFg = fgColor;\n\n    if (mode === 'clock') {\n      const now = new Date();\n      displayText = now.toLocaleTimeString('en-US', { hour: '2-digit', minute: '2-digit', hour12: false });\n      displayFg = '#00ff88';\n    } else if (mode === 'gif') {\n      displayText = 'GIF';\n      displayFg = '#ff44ff';\n    } else if (mode === 'rhythm') {\n      displayText = '***';\n      displayFg = '#44aaff';\n    }\n\n    // Check if effect is ambient (doesn't need text data)\n    const effectInfo = EFFECTS[effect];\n    const isAmbient = effectInfo?.category === 'ambient';\n\n    if (isAmbient) {\n      // Ambient effects don't need text pixels\n      this._renderer.setData([], [], width);\n    } else {\n      // Helper to get pixels using appropriate renderer\n      // Priority: BDF (pixel-perfect) \u2192 Canvas/TTF \u2192 Legacy bitmap\n      const heightKey = getHeightKey(height);\n      const useBdfFont = font !== 'LEGACY' && isBdfFontLoaded(font, heightKey);\n      const useCanvasFont = font !== 'LEGACY' && isFontLoaded(font);\n\n      const getPixels = (text, w, h, fg, bg) => {\n        // Try BDF first (pixel-perfect)\n        if (useBdfFont) {\n          const bdfPixels = textToPixelsBdf(text, w, h, fg, bg, font);\n          if (bdfPixels) return bdfPixels;\n        }\n        // Try Canvas/TTF as fallback\n        if (useCanvasFont) {\n          const canvasPixels = textToPixelsCanvas(text, w, h, fg, bg, font);\n          if (canvasPixels) return canvasPixels;\n        }\n        // Fall back to legacy bitmap font\n        return textToPixels(text, w, h, fg, bg);\n      };\n\n      const getScrollPixels = (text, displayW, h, fg, bg) => {\n        // Try BDF first (pixel-perfect)\n        if (useBdfFont) {\n          const bdfResult = textToScrollPixelsBdf(text, displayW, h, fg, bg, font);\n          if (bdfResult) return bdfResult;\n        }\n        // Try Canvas/TTF as fallback\n        if (useCanvasFont) {\n          const canvasResult = textToScrollPixelsCanvas(text, displayW, h, fg, bg, font);\n          if (canvasResult) return canvasResult;\n        }\n        // Fall back to legacy bitmap font\n        return textToScrollPixels(text, displayW, h, fg, bg);\n      };\n\n      // Estimate text width for scroll detection\n      // For canvas fonts, we use the font's actual character width\n      // For bitmap, we use 6 pixels per char\n      const textPixelWidth = useCanvasFont\n        ? displayText.length * 10 // Approximate for TTF fonts\n        : displayText.length * 6;\n\n      const needsScroll = (effect === 'scroll_ltr' || effect === 'scroll_rtl' || effect === 'bounce') && textPixelWidth > width;\n\n      if (needsScroll) {\n        // Generate extended pixel data for scrolling\n        const scrollResult = getScrollPixels(displayText, width, height, displayFg, bgColor);\n        const displayPixels = getPixels(displayText, width, height, displayFg, bgColor);\n        this._renderer.setData(displayPixels, scrollResult.pixels, scrollResult.width);\n      } else {\n        // Static or non-scroll effects\n        const pixels = getPixels(displayText, width, height, displayFg, bgColor);\n        this._renderer.setData(pixels);\n      }\n    }\n\n    // Set effect and speed\n    this._renderer.setEffect(effect, speed);\n\n    // Start or stop animation based on effect\n    if (effect === 'fixed') {\n      this._renderer.stop();\n      this._renderer.renderStatic();\n    } else {\n      this._renderer.start();\n    }\n  }\n\n  render() {\n    if (!this._hass) return;\n\n    const [width, height] = this._getResolutionCached();\n    const isOn = this.isOn();\n    const name = this._config.name || this.getEntity()?.attributes?.friendly_name || 'iPIXEL Display';\n\n    // Get current state\n    const sharedState = getDisplayState();\n    const textEntity = this.getEntity();\n    const entityText = textEntity?.state || '';\n    const modeEntity = this.getRelatedEntity('select', '_mode');\n    const currentMode = modeEntity?.state || sharedState.mode || 'text';\n\n    const currentText = sharedState.text || entityText;\n    const currentEffect = sharedState.effect || 'fixed';\n    const currentSpeed = sharedState.speed || 50;\n    const fgColor = sharedState.fgColor || '#ff6600';\n    const bgColor = sharedState.bgColor || '#111';\n    const currentFont = sharedState.font || 'VCR_OSD_MONO';\n\n    // Check if effect is ambient\n    const effectInfo = EFFECTS[currentEffect];\n    const isAmbient = effectInfo?.category === 'ambient';\n\n    // Build effect options grouped by category\n    const textEffects = Object.entries(EFFECTS)\n      .filter(([_, info]) => info.category === 'text')\n      .map(([name, info]) => `<option value=\"${name}\">${info.name}</option>`)\n      .join('');\n\n    const ambientEffects = Object.entries(EFFECTS)\n      .filter(([_, info]) => info.category === 'ambient')\n      .map(([name, info]) => `<option value=\"${name}\">${info.name}</option>`)\n      .join('');\n\n    const colorEffects = Object.entries(EFFECTS)\n      .filter(([_, info]) => info.category === 'color')\n      .map(([name, info]) => `<option value=\"${name}\">${info.name}</option>`)\n      .join('');\n\n    this.shadowRoot.innerHTML = `\n      <style>${iPIXELCardStyles}\n        .display-container { background: #000; border-radius: 8px; padding: 8px; border: 2px solid #222; }\n        .display-screen {\n          background: #000;\n          border-radius: 4px;\n          overflow: hidden;\n          min-height: 60px;\n        }\n        .display-footer { display: flex; justify-content: space-between; margin-top: 8px; font-size: 0.75em; opacity: 0.6; }\n        .mode-badge { background: rgba(255,255,255,0.1); padding: 2px 6px; border-radius: 3px; text-transform: capitalize; }\n        .effect-badge { background: rgba(100,149,237,0.2); padding: 2px 6px; border-radius: 3px; margin-left: 4px; }\n      </style>\n      <ha-card>\n        <div class=\"card-content\">\n          <div class=\"card-header\">\n            <div class=\"card-title\">\n              <span class=\"status-dot ${isOn ? '' : 'off'}\"></span>\n              ${name}\n            </div>\n            <button class=\"icon-btn ${isOn ? 'active' : ''}\" id=\"power-btn\">\n              <svg viewBox=\"0 0 24 24\"><path d=\"M13,3H11V13H13V3M17.83,5.17L16.41,6.59C18.05,7.91 19,9.9 19,12A7,7 0 0,1 12,19A7,7 0 0,1 5,12C5,9.9 5.95,7.91 7.59,6.59L6.17,5.17C4.23,6.82 3,9.26 3,12A9,9 0 0,0 12,21A9,9 0 0,0 21,12C21,9.26 19.77,6.82 17.83,5.17Z\"/></svg>\n            </button>\n          </div>\n          <div class=\"display-container\">\n            <div class=\"display-screen\" id=\"display-screen\"></div>\n            <div class=\"display-footer\">\n              <span>${width} x ${height}</span>\n              <span>\n                <span class=\"mode-badge\">${isOn ? currentMode : 'Off'}</span>\n                ${isOn && currentEffect !== 'fixed' ? `<span class=\"effect-badge\">${EFFECTS[currentEffect]?.name || currentEffect}</span>` : ''}\n              </span>\n            </div>\n          </div>\n        </div>\n      </ha-card>`;\n\n    // Get display container\n    this._displayContainer = this.shadowRoot.getElementById('display-screen');\n\n    // Update display with current state (renderer will be created/updated in _updateDisplay)\n    this._updateDisplay({\n      text: currentText,\n      effect: currentEffect,\n      speed: currentSpeed,\n      fgColor: fgColor,\n      bgColor: bgColor,\n      mode: currentMode,\n      font: currentFont\n    });\n\n    this._attachPowerButton();\n  }\n\n  _attachPowerButton() {\n    this.shadowRoot.getElementById('power-btn')?.addEventListener('click', () => {\n      let switchId = this._switchEntityId;\n      if (!switchId) {\n        const sw = this.getRelatedEntity('switch');\n        if (sw) {\n          this._switchEntityId = sw.entity_id;\n          switchId = sw.entity_id;\n        }\n      }\n\n      if (switchId && this._hass.states[switchId]) {\n        this._hass.callService('switch', 'toggle', { entity_id: switchId });\n      } else {\n        const allSwitches = Object.keys(this._hass.states).filter(e => e.startsWith('switch.'));\n        const baseName = this._config.entity?.replace(/^[^.]+\\./, '').replace(/_?(text|display|gif_url)$/i, '') || '';\n        const match = allSwitches.find(s => s.includes(baseName.substring(0, 10)));\n        if (match) {\n          this._switchEntityId = match;\n          this._hass.callService('switch', 'toggle', { entity_id: match });\n        } else {\n          console.warn('iPIXEL: No switch found. Entity:', this._config.entity, 'Available:', allSwitches);\n        }\n      }\n    });\n  }\n\n  static getConfigElement() { return document.createElement('ipixel-simple-editor'); }\n  static getStubConfig() { return { entity: '' }; }\n}\n", "/**\n * iPIXEL Controls Card\n * Brightness, mode, clock settings, and device controls\n */\n\nimport { iPIXELCardBase } from '../base.js';\nimport { iPIXELCardStyles } from '../styles.js';\nimport { updateDisplayState, saveDisplayState } from '../state.js';\n\n// Clock styles supported by device (1-8)\nconst CLOCK_STYLES = [\n  { value: 1, name: 'Style 1 (Digital)' },\n  { value: 2, name: 'Style 2 (Minimal)' },\n  { value: 3, name: 'Style 3 (Bold)' },\n  { value: 4, name: 'Style 4 (Retro)' },\n  { value: 5, name: 'Style 5 (Neon)' },\n  { value: 6, name: 'Style 6 (Matrix)' },\n  { value: 7, name: 'Style 7 (Classic)' },\n  { value: 8, name: 'Style 8 (Modern)' }\n];\n\n// Text animation modes (0-7)\nconst ANIMATION_MODES = [\n  { value: 0, name: 'Static' },\n  { value: 1, name: 'Scroll Left' },\n  { value: 2, name: 'Scroll Right' },\n  { value: 3, name: 'Scroll Up' },\n  { value: 4, name: 'Scroll Down' },\n  { value: 5, name: 'Flash' },\n  { value: 6, name: 'Fade In/Out' },\n  { value: 7, name: 'Bounce' }\n];\n\nexport class iPIXELControlsCard extends iPIXELCardBase {\n  constructor() {\n    super();\n    this._clockStyle = 1;\n    this._is24Hour = true;\n    this._showDate = false;\n    this._upsideDown = false;\n    this._animationMode = 0;\n  }\n\n  render() {\n    if (!this._hass) return;\n    const isOn = this.isOn();\n\n    // Get upside down state from entity if available\n    const upsideDownEntity = this.getRelatedEntity('switch', '_upside_down');\n    if (upsideDownEntity) {\n      this._upsideDown = upsideDownEntity.state === 'on';\n    }\n\n    this.shadowRoot.innerHTML = `\n      <style>${iPIXELCardStyles}\n        .toggle-row {\n          display: flex;\n          align-items: center;\n          justify-content: space-between;\n          padding: 8px 0;\n        }\n        .toggle-label {\n          font-size: 0.85em;\n          color: var(--primary-text-color, #fff);\n        }\n        .toggle-switch {\n          position: relative;\n          width: 44px;\n          height: 24px;\n          background: rgba(255,255,255,0.1);\n          border-radius: 12px;\n          cursor: pointer;\n          transition: background 0.2s;\n        }\n        .toggle-switch.active {\n          background: var(--primary-color, #03a9f4);\n        }\n        .toggle-switch::after {\n          content: '';\n          position: absolute;\n          top: 2px;\n          left: 2px;\n          width: 20px;\n          height: 20px;\n          background: #fff;\n          border-radius: 50%;\n          transition: transform 0.2s;\n        }\n        .toggle-switch.active::after {\n          transform: translateX(20px);\n        }\n        .subsection {\n          background: rgba(255,255,255,0.03);\n          border-radius: 8px;\n          padding: 12px;\n          margin-bottom: 12px;\n        }\n        .subsection-title {\n          font-size: 0.75em;\n          text-transform: uppercase;\n          letter-spacing: 0.5px;\n          opacity: 0.6;\n          margin-bottom: 8px;\n        }\n        .screen-grid {\n          display: grid;\n          grid-template-columns: repeat(5, 1fr);\n          gap: 6px;\n        }\n        .screen-btn {\n          padding: 8px 4px;\n          border: 1px solid rgba(255,255,255,0.1);\n          background: rgba(255,255,255,0.05);\n          color: var(--primary-text-color, #fff);\n          border-radius: 6px;\n          cursor: pointer;\n          font-size: 0.8em;\n          text-align: center;\n          transition: all 0.2s;\n        }\n        .screen-btn:hover {\n          background: rgba(255,255,255,0.1);\n        }\n        .screen-btn.active {\n          background: var(--primary-color, #03a9f4);\n          border-color: var(--primary-color, #03a9f4);\n        }\n        .screen-btn.delete {\n          background: rgba(244,67,54,0.2);\n          border-color: rgba(244,67,54,0.3);\n          color: #f44336;\n        }\n        .screen-btn.delete:hover {\n          background: rgba(244,67,54,0.4);\n        }\n        .two-col { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }\n        .compact-row { display: flex; gap: 8px; align-items: center; }\n        .compact-row select { flex: 1; }\n      </style>\n      <ha-card>\n        <div class=\"card-content\">\n          <div class=\"section-title\">Quick Actions</div>\n          <div class=\"control-row\">\n            <div class=\"button-grid button-grid-4\">\n              <button class=\"icon-btn ${isOn ? 'active' : ''}\" data-action=\"power\" title=\"Power\">\n                <svg viewBox=\"0 0 24 24\"><path d=\"M13,3H11V13H13V3M17.83,5.17L16.41,6.59C18.05,7.91 19,9.9 19,12A7,7 0 0,1 12,19A7,7 0 0,1 5,12C5,9.9 5.95,7.91 7.59,6.59L6.17,5.17C4.23,6.82 3,9.26 3,12A9,9 0 0,0 12,21A9,9 0 0,0 21,12C21,9.26 19.77,6.82 17.83,5.17Z\"/></svg>\n              </button>\n              <button class=\"icon-btn\" data-action=\"clear\" title=\"Clear\">\n                <svg viewBox=\"0 0 24 24\"><path d=\"M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z\"/></svg>\n              </button>\n              <button class=\"icon-btn\" data-action=\"clock\" title=\"Clock\">\n                <svg viewBox=\"0 0 24 24\"><path d=\"M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M16.2,16.2L11,13V7H12.5V12.2L17,14.9L16.2,16.2Z\"/></svg>\n              </button>\n              <button class=\"icon-btn\" data-action=\"sync\" title=\"Sync Time\">\n                <svg viewBox=\"0 0 24 24\"><path d=\"M12,4V2A10,10 0 0,0 2,12H4A8,8 0 0,1 12,4M18.2,7.27L19.62,5.85C18.27,4.5 16.5,3.5 14.5,3.13V5.17C15.86,5.5 17.08,6.23 18.2,7.27M20,12H22A10,10 0 0,0 12,2V4A8,8 0 0,1 20,12M5.8,16.73L4.38,18.15C5.73,19.5 7.5,20.5 9.5,20.87V18.83C8.14,18.5 6.92,17.77 5.8,16.73M4,12H2A10,10 0 0,0 12,22V20A8,8 0 0,1 4,12Z\"/></svg>\n              </button>\n            </div>\n          </div>\n\n          <div class=\"section-title\">Brightness</div>\n          <div class=\"control-row\">\n            <div class=\"slider-row\">\n              <input type=\"range\" class=\"slider\" id=\"brightness\" min=\"1\" max=\"100\" value=\"50\">\n              <span class=\"slider-value\" id=\"brightness-val\">50%</span>\n            </div>\n          </div>\n\n          <div class=\"section-title\">Display Mode</div>\n          <div class=\"control-row\">\n            <div class=\"button-grid button-grid-3\">\n              <button class=\"mode-btn\" data-mode=\"textimage\">Text+Image</button>\n              <button class=\"mode-btn\" data-mode=\"text\">Text</button>\n              <button class=\"mode-btn\" data-mode=\"clock\">Clock</button>\n              <button class=\"mode-btn\" data-mode=\"gif\">GIF</button>\n              <button class=\"mode-btn\" data-mode=\"rhythm\">Rhythm</button>\n            </div>\n          </div>\n\n          <div class=\"section-title\">Clock Settings</div>\n          <div class=\"subsection\">\n            <div class=\"compact-row\" style=\"margin-bottom: 12px;\">\n              <select class=\"dropdown\" id=\"clock-style\">\n                ${CLOCK_STYLES.map(s => `<option value=\"${s.value}\"${s.value === this._clockStyle ? ' selected' : ''}>${s.name}</option>`).join('')}\n              </select>\n              <button class=\"btn btn-primary\" id=\"apply-clock-btn\">Apply</button>\n            </div>\n            <div class=\"toggle-row\">\n              <span class=\"toggle-label\">24-Hour Format</span>\n              <div class=\"toggle-switch ${this._is24Hour ? 'active' : ''}\" id=\"toggle-24h\"></div>\n            </div>\n            <div class=\"toggle-row\">\n              <span class=\"toggle-label\">Show Date</span>\n              <div class=\"toggle-switch ${this._showDate ? 'active' : ''}\" id=\"toggle-date\"></div>\n            </div>\n          </div>\n\n          <div class=\"section-title\">Text Animation</div>\n          <div class=\"control-row\">\n            <select class=\"dropdown\" id=\"animation-mode\">\n              ${ANIMATION_MODES.map(m => `<option value=\"${m.value}\"${m.value === this._animationMode ? ' selected' : ''}>${m.name}</option>`).join('')}\n            </select>\n          </div>\n\n          <div class=\"section-title\">Orientation & Display</div>\n          <div class=\"two-col\">\n            <div>\n              <div class=\"subsection-title\">Rotation</div>\n              <select class=\"dropdown\" id=\"orientation\">\n                <option value=\"0\">0\u00B0 (Normal)</option>\n                <option value=\"1\">180\u00B0</option>\n              </select>\n            </div>\n            <div>\n              <div class=\"subsection-title\">Flip</div>\n              <div class=\"toggle-row\" style=\"padding: 4px 0;\">\n                <span class=\"toggle-label\">Upside Down</span>\n                <div class=\"toggle-switch ${this._upsideDown ? 'active' : ''}\" id=\"toggle-upside-down\"></div>\n              </div>\n            </div>\n          </div>\n\n          <div class=\"section-title\">Screen Slots</div>\n          <div class=\"subsection\">\n            <div class=\"subsection-title\">Select Screen (1-9)</div>\n            <div class=\"screen-grid\" style=\"margin-bottom: 12px;\">\n              ${[1,2,3,4,5,6,7,8,9].map(n => `<button class=\"screen-btn\" data-screen=\"${n}\">${n}</button>`).join('')}\n            </div>\n            <div class=\"subsection-title\">Delete Screen</div>\n            <div class=\"screen-grid\">\n              ${[1,2,3,4,5,6,7,8,9,10].map(n => `<button class=\"screen-btn delete\" data-delete=\"${n}\">\u00D7${n}</button>`).join('')}\n            </div>\n          </div>\n\n          <div class=\"section-title\">Font Settings</div>\n          <div class=\"subsection\">\n            <div class=\"two-col\" style=\"margin-bottom: 12px;\">\n              <div>\n                <div class=\"subsection-title\">Size (1-128)</div>\n                <input type=\"number\" class=\"text-input\" id=\"font-size\" value=\"16\" min=\"1\" max=\"128\" style=\"width: 100%;\">\n              </div>\n              <div>\n                <div class=\"subsection-title\">Offset X, Y</div>\n                <div style=\"display: flex; gap: 4px;\">\n                  <input type=\"number\" class=\"text-input\" id=\"font-offset-x\" value=\"0\" min=\"-64\" max=\"64\" style=\"width: 50%;\">\n                  <input type=\"number\" class=\"text-input\" id=\"font-offset-y\" value=\"0\" min=\"-32\" max=\"32\" style=\"width: 50%;\">\n                </div>\n              </div>\n            </div>\n          </div>\n\n          <div class=\"section-title\">DIY Mode</div>\n          <div class=\"control-row\">\n            <select class=\"dropdown\" id=\"diy-mode\">\n              <option value=\"\">-- Select Action --</option>\n              <option value=\"1\">Enter (Clear Display)</option>\n              <option value=\"3\">Enter (Preserve Content)</option>\n              <option value=\"0\">Exit (Keep Previous)</option>\n              <option value=\"2\">Exit (Keep Current)</option>\n            </select>\n          </div>\n\n          <div class=\"section-title\">Raw Command</div>\n          <div class=\"control-row\" style=\"margin-top: 8px;\">\n            <div style=\"display: flex; gap: 8px;\">\n              <input type=\"text\" class=\"text-input\" id=\"raw-command\" placeholder=\"Raw hex (e.g., 05 00 07 01 01)\" style=\"flex: 1;\">\n              <button class=\"btn btn-secondary\" id=\"send-raw-btn\">Send</button>\n            </div>\n          </div>\n        </div>\n      </ha-card>`;\n\n    this._attachControlListeners();\n  }\n\n  _attachControlListeners() {\n    // Action buttons\n    this.shadowRoot.querySelectorAll('[data-action]').forEach(btn => {\n      btn.addEventListener('click', (e) => {\n        const action = e.currentTarget.dataset.action;\n        if (action === 'power') {\n          const sw = this.getRelatedEntity('switch');\n          if (sw) {\n            this._hass.callService('switch', 'toggle', { entity_id: sw.entity_id });\n          }\n        } else if (action === 'clear') {\n          updateDisplayState({ text: '', mode: 'text', effect: 'fixed', speed: 50, fgColor: '#ff6600', bgColor: '#000000' });\n          this.callService('ipixel_color', 'clear_pixels');\n        } else if (action === 'clock') {\n          this._applyClockSettings();\n        } else if (action === 'sync') {\n          this.callService('ipixel_color', 'sync_time');\n        }\n      });\n    });\n\n    // Brightness slider\n    const slider = this.shadowRoot.getElementById('brightness');\n    if (slider) {\n      slider.style.setProperty('--value', `${slider.value}%`);\n      slider.addEventListener('input', (e) => {\n        e.target.style.setProperty('--value', `${e.target.value}%`);\n        this.shadowRoot.getElementById('brightness-val').textContent = `${e.target.value}%`;\n      });\n      slider.addEventListener('change', (e) => {\n        this.callService('ipixel_color', 'set_brightness', { level: parseInt(e.target.value) });\n      });\n    }\n\n    // Mode buttons\n    this.shadowRoot.querySelectorAll('[data-mode]').forEach(btn => {\n      btn.addEventListener('click', (e) => {\n        const mode = e.currentTarget.dataset.mode;\n        const modeEntity = this.getRelatedEntity('select', '_mode');\n        if (modeEntity) {\n          this._hass.callService('select', 'select_option', { entity_id: modeEntity.entity_id, option: mode });\n        }\n\n        const modeColors = {\n          'text': '#ff6600', 'textimage': '#ff6600', 'clock': '#00ff88',\n          'gif': '#ff44ff', 'rhythm': '#44aaff'\n        };\n        updateDisplayState({\n          mode: mode,\n          fgColor: modeColors[mode] || '#ff6600',\n          text: mode === 'clock' ? '' : window.iPIXELDisplayState?.text || ''\n        });\n\n        this.shadowRoot.querySelectorAll('[data-mode]').forEach(b => b.classList.remove('active'));\n        e.currentTarget.classList.add('active');\n      });\n    });\n\n    // Clock style dropdown and apply button\n    this.shadowRoot.getElementById('clock-style')?.addEventListener('change', (e) => {\n      this._clockStyle = parseInt(e.target.value);\n    });\n\n    this.shadowRoot.getElementById('apply-clock-btn')?.addEventListener('click', () => {\n      this._applyClockSettings();\n    });\n\n    // Clock toggles\n    this.shadowRoot.getElementById('toggle-24h')?.addEventListener('click', (e) => {\n      this._is24Hour = !this._is24Hour;\n      e.currentTarget.classList.toggle('active', this._is24Hour);\n    });\n\n    this.shadowRoot.getElementById('toggle-date')?.addEventListener('click', (e) => {\n      this._showDate = !this._showDate;\n      e.currentTarget.classList.toggle('active', this._showDate);\n    });\n\n    // Animation mode\n    this.shadowRoot.getElementById('animation-mode')?.addEventListener('change', (e) => {\n      this._animationMode = parseInt(e.target.value);\n      updateDisplayState({ animationMode: this._animationMode });\n      this.callService('ipixel_color', 'set_animation_mode', { mode: this._animationMode });\n    });\n\n    // Orientation dropdown\n    this.shadowRoot.getElementById('orientation')?.addEventListener('change', (e) => {\n      const orientation = parseInt(e.target.value);\n      this.callService('ipixel_color', 'set_orientation', { orientation });\n    });\n\n    // Upside down toggle\n    this.shadowRoot.getElementById('toggle-upside-down')?.addEventListener('click', (e) => {\n      this._upsideDown = !this._upsideDown;\n      e.currentTarget.classList.toggle('active', this._upsideDown);\n\n      const upsideDownEntity = this.getRelatedEntity('switch', '_upside_down');\n      if (upsideDownEntity) {\n        this._hass.callService('switch', this._upsideDown ? 'turn_on' : 'turn_off', {\n          entity_id: upsideDownEntity.entity_id\n        });\n      } else {\n        this.callService('ipixel_color', 'set_upside_down', { enabled: this._upsideDown });\n      }\n    });\n\n    // Screen buffer selection\n    this.shadowRoot.querySelectorAll('[data-screen]').forEach(btn => {\n      btn.addEventListener('click', (e) => {\n        const screen = parseInt(e.currentTarget.dataset.screen);\n        this.callService('ipixel_color', 'set_screen', { screen: screen });\n        // Update active state\n        this.shadowRoot.querySelectorAll('[data-screen]').forEach(b => b.classList.remove('active'));\n        e.currentTarget.classList.add('active');\n      });\n    });\n\n    // Screen deletion\n    this.shadowRoot.querySelectorAll('[data-delete]').forEach(btn => {\n      btn.addEventListener('click', (e) => {\n        const slot = parseInt(e.currentTarget.dataset.delete);\n        if (confirm(`Delete screen slot ${slot}?`)) {\n          this.callService('ipixel_color', 'delete_screen', { slot });\n        }\n      });\n    });\n\n    // Font settings\n    this.shadowRoot.getElementById('font-size')?.addEventListener('change', (e) => {\n      const size = parseInt(e.target.value);\n      updateDisplayState({ fontSize: size });\n      this.callService('ipixel_color', 'set_font_size', { size });\n    });\n\n    this.shadowRoot.getElementById('font-offset-x')?.addEventListener('change', () => {\n      this._updateFontOffset();\n    });\n\n    this.shadowRoot.getElementById('font-offset-y')?.addEventListener('change', () => {\n      this._updateFontOffset();\n    });\n\n    // DIY mode dropdown\n    this.shadowRoot.getElementById('diy-mode')?.addEventListener('change', (e) => {\n      const mode = e.target.value;\n      if (mode !== '') {\n        this.callService('ipixel_color', 'set_diy_mode', { mode: mode });\n        // Reset dropdown after action\n        setTimeout(() => { e.target.value = ''; }, 500);\n      }\n    });\n\n    // Raw command input\n    this.shadowRoot.getElementById('send-raw-btn')?.addEventListener('click', () => {\n      const hexData = this.shadowRoot.getElementById('raw-command')?.value;\n      if (hexData && hexData.trim()) {\n        this.callService('ipixel_color', 'send_raw_command', { hex_data: hexData.trim() });\n      }\n    });\n\n    // Also allow Enter key to send raw command\n    this.shadowRoot.getElementById('raw-command')?.addEventListener('keypress', (e) => {\n      if (e.key === 'Enter') {\n        const hexData = e.target.value;\n        if (hexData && hexData.trim()) {\n          this.callService('ipixel_color', 'send_raw_command', { hex_data: hexData.trim() });\n        }\n      }\n    });\n  }\n\n  _applyClockSettings() {\n    updateDisplayState({\n      text: '',\n      mode: 'clock',\n      effect: 'fixed',\n      speed: 50,\n      fgColor: '#00ff88',\n      bgColor: '#000000',\n      clockStyle: this._clockStyle,\n      is24Hour: this._is24Hour,\n      showDate: this._showDate\n    });\n    this.callService('ipixel_color', 'set_clock_mode', {\n      style: this._clockStyle,\n      format_24h: this._is24Hour,\n      show_date: this._showDate\n    });\n  }\n\n  _updateFontOffset() {\n    const x = parseInt(this.shadowRoot.getElementById('font-offset-x')?.value || '0');\n    const y = parseInt(this.shadowRoot.getElementById('font-offset-y')?.value || '0');\n    updateDisplayState({ fontOffsetX: x, fontOffsetY: y });\n    this.callService('ipixel_color', 'set_font_offset', { x, y });\n  }\n\n  static getConfigElement() { return document.createElement('ipixel-simple-editor'); }\n  static getStubConfig() { return { entity: '' }; }\n}\n", "/**\n * iPIXEL Text Card\n * Text input with effects and colors - with tabbed interface\n */\n\nimport { iPIXELCardBase } from '../base.js';\nimport { iPIXELCardStyles } from '../styles.js';\nimport { updateDisplayState } from '../state.js';\nimport { EFFECTS, EFFECT_CATEGORIES } from '../effects/index.js';\n\n// Rainbow mode names (0-9)\nconst RAINBOW_MODES = [\n  { value: 0, name: 'None' },\n  { value: 1, name: 'Rainbow Wave' },\n  { value: 2, name: 'Rainbow Cycle' },\n  { value: 3, name: 'Rainbow Pulse' },\n  { value: 4, name: 'Rainbow Fade' },\n  { value: 5, name: 'Rainbow Chase' },\n  { value: 6, name: 'Rainbow Sparkle' },\n  { value: 7, name: 'Rainbow Gradient' },\n  { value: 8, name: 'Rainbow Theater' },\n  { value: 9, name: 'Rainbow Fire' }\n];\n\n// Rhythm visualization styles (0-4)\nconst RHYTHM_STYLES = [\n  { value: 0, name: 'Classic Bars' },\n  { value: 1, name: 'Mirrored Bars' },\n  { value: 2, name: 'Center Out' },\n  { value: 3, name: 'Wave Style' },\n  { value: 4, name: 'Particle Style' }\n];\n\nexport class iPIXELTextCard extends iPIXELCardBase {\n  constructor() {\n    super();\n    this._activeTab = 'text'; // 'text', 'ambient', 'rhythm', or 'advanced'\n    this._rhythmLevels = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]; // 11 frequency bands\n    this._selectedRhythmStyle = 0;\n    this._selectedAmbient = 'rainbow';\n  }\n\n  /**\n   * Generate text effect options (text + color effects)\n   */\n  _buildTextEffectOptions() {\n    const textEffects = Object.entries(EFFECTS)\n      .filter(([_, info]) => info.category === EFFECT_CATEGORIES.TEXT)\n      .map(([name, info]) => `<option value=\"${name}\">${info.name}</option>`)\n      .join('');\n\n    const colorEffects = Object.entries(EFFECTS)\n      .filter(([_, info]) => info.category === EFFECT_CATEGORIES.COLOR)\n      .map(([name, info]) => `<option value=\"${name}\">${info.name}</option>`)\n      .join('');\n\n    return `\n      <optgroup label=\"Text Effects\">\n        ${textEffects}\n      </optgroup>\n      <optgroup label=\"Color Effects\">\n        ${colorEffects}\n      </optgroup>\n    `;\n  }\n\n  /**\n   * Generate ambient effect options\n   */\n  _buildAmbientEffectOptions() {\n    return Object.entries(EFFECTS)\n      .filter(([_, info]) => info.category === EFFECT_CATEGORIES.AMBIENT)\n      .map(([name, info]) => `<option value=\"${name}\">${info.name}</option>`)\n      .join('');\n  }\n\n  /**\n   * Build ambient effects as a button grid\n   */\n  _buildAmbientGrid() {\n    const selected = this._selectedAmbient || 'rainbow';\n    return Object.entries(EFFECTS)\n      .filter(([_, info]) => info.category === EFFECT_CATEGORIES.AMBIENT)\n      .map(([name, info]) => `\n        <button class=\"effect-btn ${name === selected ? 'active' : ''}\" data-effect=\"${name}\">\n          ${info.name}\n        </button>\n      `)\n      .join('');\n  }\n\n  /**\n   * Build rainbow mode options for dropdown\n   */\n  _buildRainbowOptions() {\n    return RAINBOW_MODES.map(mode =>\n      `<option value=\"${mode.value}\">${mode.name}</option>`\n    ).join('');\n  }\n\n  /**\n   * Build rhythm style grid\n   */\n  _buildRhythmStyleGrid() {\n    const selected = this._selectedRhythmStyle || 0;\n    return RHYTHM_STYLES.map(style => `\n      <button class=\"style-btn ${style.value === selected ? 'active' : ''}\" data-style=\"${style.value}\">\n        ${style.name}\n      </button>\n    `).join('');\n  }\n\n  /**\n   * Build rhythm level sliders (11 frequency bands)\n   */\n  _buildRhythmLevelSliders() {\n    const labels = ['32Hz', '64Hz', '125Hz', '250Hz', '500Hz', '1kHz', '2kHz', '4kHz', '8kHz', '12kHz', '16kHz'];\n    return this._rhythmLevels.map((level, i) => `\n      <div class=\"rhythm-band\">\n        <label>${labels[i]}</label>\n        <input type=\"range\" class=\"rhythm-slider\" data-band=\"${i}\" min=\"0\" max=\"15\" value=\"${level}\">\n        <span class=\"rhythm-val\">${level}</span>\n      </div>\n    `).join('');\n  }\n\n  render() {\n    if (!this._hass) return;\n\n    const isTextTab = this._activeTab === 'text';\n    const isAmbientTab = this._activeTab === 'ambient';\n    const isRhythmTab = this._activeTab === 'rhythm';\n    const isAdvancedTab = this._activeTab === 'advanced';\n\n    this.shadowRoot.innerHTML = `\n      <style>${iPIXELCardStyles}\n        .tabs { display: flex; gap: 4px; margin-bottom: 16px; }\n        .tab {\n          flex: 1;\n          padding: 10px 8px;\n          border: none;\n          background: rgba(255,255,255,0.05);\n          color: var(--primary-text-color, #fff);\n          cursor: pointer;\n          border-radius: 8px;\n          font-size: 0.8em;\n          font-weight: 500;\n          transition: all 0.2s ease;\n        }\n        .tab:hover { background: rgba(255,255,255,0.1); }\n        .tab.active {\n          background: var(--primary-color, #03a9f4);\n          color: #fff;\n        }\n        .tab-content { display: none; }\n        .tab-content.active { display: block; }\n        .input-row { display: flex; gap: 8px; margin-bottom: 12px; }\n        .input-row .text-input { flex: 1; }\n        select optgroup { font-weight: bold; color: var(--primary-text-color, #fff); }\n        select option { font-weight: normal; }\n        .effect-grid {\n          display: grid;\n          grid-template-columns: repeat(4, 1fr);\n          gap: 8px;\n          margin-bottom: 12px;\n        }\n        .effect-btn, .style-btn {\n          padding: 12px 8px;\n          border: 1px solid rgba(255,255,255,0.1);\n          background: rgba(255,255,255,0.05);\n          color: var(--primary-text-color, #fff);\n          border-radius: 8px;\n          cursor: pointer;\n          font-size: 0.75em;\n          text-align: center;\n          transition: all 0.2s ease;\n        }\n        .effect-btn:hover, .style-btn:hover { background: rgba(255,255,255,0.1); border-color: rgba(255,255,255,0.2); }\n        .effect-btn.active, .style-btn.active {\n          background: var(--primary-color, #03a9f4);\n          border-color: var(--primary-color, #03a9f4);\n        }\n        .style-grid {\n          display: grid;\n          grid-template-columns: repeat(3, 1fr);\n          gap: 8px;\n          margin-bottom: 16px;\n        }\n        .rhythm-band {\n          display: flex;\n          align-items: center;\n          gap: 8px;\n          margin-bottom: 8px;\n        }\n        .rhythm-band label {\n          width: 50px;\n          font-size: 0.75em;\n          opacity: 0.8;\n        }\n        .rhythm-slider {\n          flex: 1;\n          height: 4px;\n        }\n        .rhythm-val {\n          width: 20px;\n          font-size: 0.75em;\n          text-align: right;\n        }\n        .rhythm-container {\n          max-height: 300px;\n          overflow-y: auto;\n          padding-right: 8px;\n        }\n        .gfx-textarea {\n          width: 100%;\n          min-height: 150px;\n          background: rgba(0,0,0,0.3);\n          border: 1px solid rgba(255,255,255,0.1);\n          border-radius: 8px;\n          color: var(--primary-text-color, #fff);\n          font-family: monospace;\n          font-size: 0.8em;\n          padding: 12px;\n          resize: vertical;\n        }\n        .gfx-textarea:focus {\n          outline: none;\n          border-color: var(--primary-color, #03a9f4);\n        }\n        .two-col { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }\n      </style>\n      <ha-card>\n        <div class=\"card-content\">\n          <div class=\"tabs\">\n            <button class=\"tab ${isTextTab ? 'active' : ''}\" id=\"tab-text\">Text</button>\n            <button class=\"tab ${isAmbientTab ? 'active' : ''}\" id=\"tab-ambient\">Ambient</button>\n            <button class=\"tab ${isRhythmTab ? 'active' : ''}\" id=\"tab-rhythm\">Rhythm</button>\n            <button class=\"tab ${isAdvancedTab ? 'active' : ''}\" id=\"tab-advanced\">GFX</button>\n          </div>\n\n          <!-- Text Tab -->\n          <div class=\"tab-content ${isTextTab ? 'active' : ''}\" id=\"content-text\">\n            <div class=\"section-title\">Display Text</div>\n            <div class=\"input-row\">\n              <input type=\"text\" class=\"text-input\" id=\"text-input\" placeholder=\"Enter text to display...\">\n              <button class=\"btn btn-primary\" id=\"send-btn\">Send</button>\n            </div>\n            <div class=\"two-col\">\n              <div>\n                <div class=\"section-title\">Effect</div>\n                <div class=\"control-row\">\n                  <select class=\"dropdown\" id=\"text-effect\">\n                    ${this._buildTextEffectOptions()}\n                  </select>\n                </div>\n              </div>\n              <div>\n                <div class=\"section-title\">Rainbow Mode</div>\n                <div class=\"control-row\">\n                  <select class=\"dropdown\" id=\"rainbow-mode\">\n                    ${this._buildRainbowOptions()}\n                  </select>\n                </div>\n              </div>\n            </div>\n            <div class=\"section-title\">Speed</div>\n            <div class=\"control-row\">\n              <div class=\"slider-row\">\n                <input type=\"range\" class=\"slider\" id=\"text-speed\" min=\"1\" max=\"100\" value=\"50\">\n                <span class=\"slider-value\" id=\"text-speed-val\">50</span>\n              </div>\n            </div>\n            <div class=\"section-title\">Font</div>\n            <div class=\"control-row\">\n              <select class=\"dropdown\" id=\"font-select\">\n                <option value=\"VCR_OSD_MONO\">VCR OSD Mono</option>\n                <option value=\"CUSONG\">CUSONG</option>\n                <option value=\"LEGACY\">Legacy (Bitmap)</option>\n              </select>\n            </div>\n            <div class=\"section-title\">Colors</div>\n            <div class=\"control-row\">\n              <div class=\"color-row\">\n                <span style=\"font-size: 0.85em;\">Text:</span>\n                <input type=\"color\" class=\"color-picker\" id=\"text-color\" value=\"#ff6600\">\n                <span style=\"font-size: 0.85em; margin-left: 16px;\">Background:</span>\n                <input type=\"color\" class=\"color-picker\" id=\"bg-color\" value=\"#000000\">\n              </div>\n            </div>\n          </div>\n\n          <!-- Ambient Tab -->\n          <div class=\"tab-content ${isAmbientTab ? 'active' : ''}\" id=\"content-ambient\">\n            <div class=\"section-title\">Ambient Effect</div>\n            <div class=\"effect-grid\" id=\"ambient-grid\">\n              ${this._buildAmbientGrid()}\n            </div>\n            <div class=\"section-title\">Speed</div>\n            <div class=\"control-row\">\n              <div class=\"slider-row\">\n                <input type=\"range\" class=\"slider\" id=\"ambient-speed\" min=\"1\" max=\"100\" value=\"50\">\n                <span class=\"slider-value\" id=\"ambient-speed-val\">50</span>\n              </div>\n            </div>\n            <button class=\"btn btn-primary\" id=\"apply-ambient-btn\" style=\"width: 100%; margin-top: 8px;\">Apply Effect</button>\n          </div>\n\n          <!-- Rhythm Tab -->\n          <div class=\"tab-content ${isRhythmTab ? 'active' : ''}\" id=\"content-rhythm\">\n            <div class=\"section-title\">Visualization Style</div>\n            <div class=\"style-grid\" id=\"rhythm-style-grid\">\n              ${this._buildRhythmStyleGrid()}\n            </div>\n            <div class=\"section-title\">Frequency Levels (0-15)</div>\n            <div class=\"rhythm-container\">\n              ${this._buildRhythmLevelSliders()}\n            </div>\n            <button class=\"btn btn-primary\" id=\"apply-rhythm-btn\" style=\"width: 100%; margin-top: 12px;\">Apply Rhythm</button>\n          </div>\n\n          <!-- Advanced/GFX Tab -->\n          <div class=\"tab-content ${isAdvancedTab ? 'active' : ''}\" id=\"content-advanced\">\n            <div class=\"section-title\">GFX JSON Data</div>\n            <textarea class=\"gfx-textarea\" id=\"gfx-json\" placeholder='Enter GFX JSON data...\nExample:\n{\n  \"width\": 64,\n  \"height\": 16,\n  \"pixels\": [\n    {\"x\": 0, \"y\": 0, \"color\": \"#ff0000\"},\n    {\"x\": 1, \"y\": 0, \"color\": \"#00ff00\"}\n  ]\n}'></textarea>\n            <button class=\"btn btn-primary\" id=\"apply-gfx-btn\" style=\"width: 100%; margin-top: 12px;\">Render GFX</button>\n            <div class=\"section-title\" style=\"margin-top: 16px;\">Per-Character Colors</div>\n            <div class=\"input-row\">\n              <input type=\"text\" class=\"text-input\" id=\"multicolor-text\" placeholder=\"Text (e.g., HELLO)\">\n            </div>\n            <div class=\"input-row\">\n              <input type=\"text\" class=\"text-input\" id=\"multicolor-colors\" placeholder=\"Colors (e.g., #ff0000,#00ff00,#0000ff)\">\n            </div>\n            <button class=\"btn btn-primary\" id=\"apply-multicolor-btn\" style=\"width: 100%; margin-top: 8px;\">Send Multicolor Text</button>\n          </div>\n        </div>\n      </ha-card>`;\n\n    this._attachListeners();\n  }\n\n  /**\n   * Get text tab form values\n   */\n  _getTextFormValues() {\n    return {\n      text: this.shadowRoot.getElementById('text-input')?.value || '',\n      effect: this.shadowRoot.getElementById('text-effect')?.value || 'fixed',\n      rainbowMode: parseInt(this.shadowRoot.getElementById('rainbow-mode')?.value || '0'),\n      speed: parseInt(this.shadowRoot.getElementById('text-speed')?.value || '50'),\n      fgColor: this.shadowRoot.getElementById('text-color')?.value || '#ff6600',\n      bgColor: this.shadowRoot.getElementById('bg-color')?.value || '#000000',\n      font: this.shadowRoot.getElementById('font-select')?.value || 'VCR_OSD_MONO'\n    };\n  }\n\n  /**\n   * Get rhythm tab form values\n   */\n  _getRhythmFormValues() {\n    return {\n      style: this._selectedRhythmStyle || 0,\n      levels: [...this._rhythmLevels]\n    };\n  }\n\n  /**\n   * Get GFX/advanced tab form values\n   */\n  _getGfxFormValues() {\n    const jsonText = this.shadowRoot.getElementById('gfx-json')?.value || '';\n    try {\n      return JSON.parse(jsonText);\n    } catch (e) {\n      return null;\n    }\n  }\n\n  /**\n   * Get multicolor text form values\n   */\n  _getMulticolorFormValues() {\n    const text = this.shadowRoot.getElementById('multicolor-text')?.value || '';\n    const colorsStr = this.shadowRoot.getElementById('multicolor-colors')?.value || '';\n    const colors = colorsStr.split(',').map(c => c.trim()).filter(c => c);\n    return { text, colors };\n  }\n\n  /**\n   * Get ambient tab form values\n   */\n  _getAmbientFormValues() {\n    return {\n      effect: this._selectedAmbient || 'rainbow',\n      speed: parseInt(this.shadowRoot.getElementById('ambient-speed')?.value || '50')\n    };\n  }\n\n  /**\n   * Update text preview (without sending to device)\n   */\n  _updateTextPreview() {\n    const { text, effect, speed, fgColor, bgColor, font } = this._getTextFormValues();\n\n    updateDisplayState({\n      text: text || 'Preview',\n      mode: 'text',\n      effect,\n      speed,\n      fgColor,\n      bgColor,\n      font\n    });\n  }\n\n  /**\n   * Update ambient preview\n   */\n  _updateAmbientPreview() {\n    const { effect, speed } = this._getAmbientFormValues();\n\n    updateDisplayState({\n      text: '',\n      mode: 'ambient',\n      effect,\n      speed,\n      fgColor: '#ffffff',\n      bgColor: '#000000'\n    });\n  }\n\n  _attachListeners() {\n    // Tab switching\n    this.shadowRoot.getElementById('tab-text')?.addEventListener('click', () => {\n      this._activeTab = 'text';\n      this.render();\n    });\n\n    this.shadowRoot.getElementById('tab-ambient')?.addEventListener('click', () => {\n      this._activeTab = 'ambient';\n      this.render();\n    });\n\n    this.shadowRoot.getElementById('tab-rhythm')?.addEventListener('click', () => {\n      this._activeTab = 'rhythm';\n      this.render();\n    });\n\n    this.shadowRoot.getElementById('tab-advanced')?.addEventListener('click', () => {\n      this._activeTab = 'advanced';\n      this.render();\n    });\n\n    // === Text Tab Listeners ===\n\n    // Text speed slider with live preview\n    const textSpeed = this.shadowRoot.getElementById('text-speed');\n    if (textSpeed) {\n      textSpeed.style.setProperty('--value', `${textSpeed.value}%`);\n      textSpeed.addEventListener('input', (e) => {\n        e.target.style.setProperty('--value', `${e.target.value}%`);\n        this.shadowRoot.getElementById('text-speed-val').textContent = e.target.value;\n        this._updateTextPreview();\n      });\n    }\n\n    // Text effect dropdown with live preview\n    this.shadowRoot.getElementById('text-effect')?.addEventListener('change', () => {\n      this._updateTextPreview();\n    });\n\n    // Rainbow mode dropdown with live preview\n    this.shadowRoot.getElementById('rainbow-mode')?.addEventListener('change', () => {\n      this._updateTextPreview();\n    });\n\n    // Font selector with live preview\n    this.shadowRoot.getElementById('font-select')?.addEventListener('change', () => {\n      this._updateTextPreview();\n    });\n\n    // Color pickers with live preview\n    this.shadowRoot.getElementById('text-color')?.addEventListener('input', () => {\n      this._updateTextPreview();\n    });\n    this.shadowRoot.getElementById('bg-color')?.addEventListener('input', () => {\n      this._updateTextPreview();\n    });\n\n    // Text input with live preview on typing\n    this.shadowRoot.getElementById('text-input')?.addEventListener('input', () => {\n      this._updateTextPreview();\n    });\n\n    // Send text button\n    this.shadowRoot.getElementById('send-btn')?.addEventListener('click', () => {\n      const { text, effect, rainbowMode, speed, fgColor, bgColor, font } = this._getTextFormValues();\n\n      if (text) {\n        updateDisplayState({\n          text,\n          mode: 'text',\n          effect,\n          speed,\n          fgColor,\n          bgColor,\n          font,\n          rainbowMode\n        });\n\n        if (this._config.entity) {\n          this._hass.callService('text', 'set_value', {\n            entity_id: this._config.entity,\n            value: text\n          });\n        }\n\n        // Map font name for backend (LEGACY uses default CUSONG)\n        const backendFont = font === 'LEGACY' ? 'CUSONG' : font;\n\n        this.callService('ipixel_color', 'display_text', {\n          text,\n          effect,\n          speed,\n          color_fg: this.hexToRgb(fgColor),\n          color_bg: this.hexToRgb(bgColor),\n          font: backendFont,\n          rainbow_mode: rainbowMode,\n        });\n      }\n    });\n\n    // === Ambient Tab Listeners ===\n\n    // Ambient effect grid buttons\n    this.shadowRoot.querySelectorAll('.effect-btn').forEach(btn => {\n      btn.addEventListener('click', (e) => {\n        const effect = e.target.dataset.effect;\n        this._selectedAmbient = effect;\n\n        // Update button states\n        this.shadowRoot.querySelectorAll('.effect-btn').forEach(b => b.classList.remove('active'));\n        e.target.classList.add('active');\n\n        // Live preview\n        this._updateAmbientPreview();\n      });\n    });\n\n    // Ambient speed slider\n    const ambientSpeed = this.shadowRoot.getElementById('ambient-speed');\n    if (ambientSpeed) {\n      ambientSpeed.style.setProperty('--value', `${ambientSpeed.value}%`);\n      ambientSpeed.addEventListener('input', (e) => {\n        e.target.style.setProperty('--value', `${e.target.value}%`);\n        this.shadowRoot.getElementById('ambient-speed-val').textContent = e.target.value;\n        this._updateAmbientPreview();\n      });\n    }\n\n    // Apply ambient effect button\n    this.shadowRoot.getElementById('apply-ambient-btn')?.addEventListener('click', () => {\n      const { effect, speed } = this._getAmbientFormValues();\n\n      updateDisplayState({\n        text: '',\n        mode: 'ambient',\n        effect,\n        speed,\n        fgColor: '#ffffff',\n        bgColor: '#000000'\n      });\n\n      // TODO: Send ambient effect to device when service is available\n      // For now just update the preview\n    });\n\n    // === Rhythm Tab Listeners ===\n\n    // Rhythm style buttons\n    this.shadowRoot.querySelectorAll('.style-btn').forEach(btn => {\n      btn.addEventListener('click', (e) => {\n        const style = parseInt(e.target.dataset.style);\n        this._selectedRhythmStyle = style;\n\n        // Update button states\n        this.shadowRoot.querySelectorAll('.style-btn').forEach(b => b.classList.remove('active'));\n        e.target.classList.add('active');\n      });\n    });\n\n    // Rhythm level sliders\n    this.shadowRoot.querySelectorAll('.rhythm-slider').forEach(slider => {\n      slider.addEventListener('input', (e) => {\n        const band = parseInt(e.target.dataset.band);\n        const value = parseInt(e.target.value);\n        this._rhythmLevels[band] = value;\n        e.target.nextElementSibling.textContent = value;\n      });\n    });\n\n    // Apply rhythm button\n    this.shadowRoot.getElementById('apply-rhythm-btn')?.addEventListener('click', () => {\n      const { style, levels } = this._getRhythmFormValues();\n\n      updateDisplayState({\n        text: '',\n        mode: 'rhythm',\n        rhythmStyle: style,\n        rhythmLevels: levels\n      });\n\n      // Call rhythm service if available\n      this.callService('ipixel_color', 'set_rhythm_level', {\n        style,\n        levels\n      });\n    });\n\n    // === Advanced/GFX Tab Listeners ===\n\n    // Apply GFX button\n    this.shadowRoot.getElementById('apply-gfx-btn')?.addEventListener('click', () => {\n      const gfxData = this._getGfxFormValues();\n      if (!gfxData) {\n        console.warn('iPIXEL: Invalid GFX JSON');\n        return;\n      }\n\n      updateDisplayState({\n        text: '',\n        mode: 'gfx',\n        gfxData\n      });\n\n      // Call GFX service if available\n      this.callService('ipixel_color', 'render_gfx', {\n        data: gfxData\n      });\n    });\n\n    // Apply multicolor text button\n    this.shadowRoot.getElementById('apply-multicolor-btn')?.addEventListener('click', () => {\n      const { text, colors } = this._getMulticolorFormValues();\n\n      if (text && colors.length > 0) {\n        updateDisplayState({\n          text,\n          mode: 'multicolor',\n          colors\n        });\n\n        // Call multicolor text service if available\n        this.callService('ipixel_color', 'display_multicolor_text', {\n          text,\n          colors: colors.map(c => this.hexToRgb(c))\n        });\n      }\n    });\n  }\n\n  static getConfigElement() { return document.createElement('ipixel-simple-editor'); }\n  static getStubConfig() { return { entity: '' }; }\n}\n", "/**\n * iPIXEL Playlist Card\n * Manage presets and scenes for quick display configurations\n */\n\nimport { iPIXELCardBase } from '../base.js';\nimport { iPIXELCardStyles } from '../styles.js';\nimport { getDisplayState, updateDisplayState } from '../state.js';\n\n// Storage key for presets\nconst PRESETS_STORAGE_KEY = 'iPIXEL_Presets';\n\nexport class iPIXELPlaylistCard extends iPIXELCardBase {\n  constructor() {\n    super();\n    this._presets = this._loadPresets();\n    this._editingPreset = null;\n    this._selectedIcon = '\uD83D\uDCFA';\n  }\n\n  _loadPresets() {\n    try {\n      const saved = localStorage.getItem(PRESETS_STORAGE_KEY);\n      return saved ? JSON.parse(saved) : [];\n    } catch (e) {\n      return [];\n    }\n  }\n\n  _savePresets() {\n    try {\n      localStorage.setItem(PRESETS_STORAGE_KEY, JSON.stringify(this._presets));\n    } catch (e) {\n      console.warn('iPIXEL: Failed to save presets', e);\n    }\n  }\n\n  render() {\n    if (!this._hass) return;\n\n    this.shadowRoot.innerHTML = `\n      <style>${iPIXELCardStyles}\n        .preset-list {\n          display: flex;\n          flex-direction: column;\n          gap: 8px;\n          margin-bottom: 16px;\n          max-height: 300px;\n          overflow-y: auto;\n        }\n        .preset-item {\n          display: flex;\n          align-items: center;\n          gap: 8px;\n          padding: 12px;\n          background: rgba(255,255,255,0.05);\n          border-radius: 8px;\n          border: 1px solid rgba(255,255,255,0.1);\n          cursor: pointer;\n          transition: all 0.2s;\n        }\n        .preset-item:hover {\n          background: rgba(255,255,255,0.1);\n          border-color: rgba(255,255,255,0.2);\n        }\n        .preset-item.active {\n          border-color: var(--primary-color, #03a9f4);\n          background: rgba(3, 169, 244, 0.1);\n        }\n        .preset-icon {\n          width: 32px;\n          height: 32px;\n          border-radius: 6px;\n          display: flex;\n          align-items: center;\n          justify-content: center;\n          font-size: 1.2em;\n        }\n        .preset-info {\n          flex: 1;\n          min-width: 0;\n        }\n        .preset-name {\n          font-weight: 500;\n          font-size: 0.9em;\n          white-space: nowrap;\n          overflow: hidden;\n          text-overflow: ellipsis;\n        }\n        .preset-desc {\n          font-size: 0.75em;\n          opacity: 0.6;\n          white-space: nowrap;\n          overflow: hidden;\n          text-overflow: ellipsis;\n        }\n        .preset-actions {\n          display: flex;\n          gap: 4px;\n        }\n        .preset-actions button {\n          padding: 6px;\n          background: transparent;\n          border: none;\n          color: rgba(255,255,255,0.5);\n          cursor: pointer;\n          border-radius: 4px;\n          transition: all 0.2s;\n        }\n        .preset-actions button:hover {\n          background: rgba(255,255,255,0.1);\n          color: #fff;\n        }\n        .preset-actions button.delete:hover {\n          background: rgba(244,67,54,0.2);\n          color: #f44;\n        }\n        .empty-state {\n          text-align: center;\n          padding: 40px 20px;\n          opacity: 0.5;\n        }\n        .empty-state svg {\n          width: 48px;\n          height: 48px;\n          margin-bottom: 12px;\n          opacity: 0.5;\n        }\n        .add-preset-form {\n          background: rgba(255,255,255,0.03);\n          border-radius: 8px;\n          padding: 16px;\n        }\n        .form-row {\n          margin-bottom: 12px;\n        }\n        .form-row label {\n          display: block;\n          font-size: 0.8em;\n          opacity: 0.7;\n          margin-bottom: 4px;\n        }\n        .form-actions {\n          display: flex;\n          gap: 8px;\n          justify-content: flex-end;\n        }\n        .icon-grid {\n          display: grid;\n          grid-template-columns: repeat(8, 1fr);\n          gap: 4px;\n          margin-top: 8px;\n        }\n        .icon-option {\n          width: 32px;\n          height: 32px;\n          border: 1px solid rgba(255,255,255,0.1);\n          border-radius: 4px;\n          display: flex;\n          align-items: center;\n          justify-content: center;\n          cursor: pointer;\n          font-size: 1.1em;\n          transition: all 0.2s;\n          background: transparent;\n        }\n        .icon-option:hover {\n          background: rgba(255,255,255,0.1);\n        }\n        .icon-option.selected {\n          border-color: var(--primary-color, #03a9f4);\n          background: rgba(3, 169, 244, 0.2);\n        }\n      </style>\n      <ha-card>\n        <div class=\"card-content\">\n          <div class=\"card-header\">\n            <div class=\"card-title\">Presets</div>\n            <button class=\"icon-btn\" id=\"add-preset-btn\" title=\"Save Current as Preset\">\n              <svg viewBox=\"0 0 24 24\"><path d=\"M19,13H13V19H11V13H5V11H11V5H13V11H19V13Z\"/></svg>\n            </button>\n          </div>\n\n          <div class=\"preset-list\" id=\"preset-list\">\n            ${this._presets.length === 0 ? `\n              <div class=\"empty-state\">\n                <svg viewBox=\"0 0 24 24\"><path fill=\"currentColor\" d=\"M19,20H5V4H7V7H17V4H19M12,2A1,1 0 0,1 13,3A1,1 0 0,1 12,4A1,1 0 0,1 11,3A1,1 0 0,1 12,2M19,2H14.82C14.4,0.84 13.3,0 12,0C10.7,0 9.6,0.84 9.18,2H5A2,2 0 0,0 3,4V20A2,2 0 0,0 5,22H19A2,2 0 0,0 21,20V4A2,2 0 0,0 19,2Z\"/></svg>\n                <div>No presets saved</div>\n                <div style=\"font-size: 0.85em; margin-top: 4px;\">Click + to save current display</div>\n              </div>\n            ` : this._presets.map((preset, i) => `\n              <div class=\"preset-item\" data-index=\"${i}\">\n                <div class=\"preset-icon\" style=\"background: ${preset.fgColor || '#ff6600'}20; color: ${preset.fgColor || '#ff6600'}\">\n                  ${preset.icon || '\uD83D\uDCFA'}\n                </div>\n                <div class=\"preset-info\">\n                  <div class=\"preset-name\">${this._escapeHtml(preset.name)}</div>\n                  <div class=\"preset-desc\">${preset.mode} \u00B7 ${preset.effect || 'fixed'}${preset.text ? ' \u00B7 \"' + preset.text.substring(0, 15) + (preset.text.length > 15 ? '...' : '') + '\"' : ''}</div>\n                </div>\n                <div class=\"preset-actions\">\n                  <button class=\"edit\" data-action=\"edit\" data-index=\"${i}\" title=\"Edit\">\n                    <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\"><path fill=\"currentColor\" d=\"M20.71,7.04C21.1,6.65 21.1,6 20.71,5.63L18.37,3.29C18,2.9 17.35,2.9 16.96,3.29L15.12,5.12L18.87,8.87M3,17.25V21H6.75L17.81,9.93L14.06,6.18L3,17.25Z\"/></svg>\n                  </button>\n                  <button class=\"delete\" data-action=\"delete\" data-index=\"${i}\" title=\"Delete\">\n                    <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\"><path fill=\"currentColor\" d=\"M19,4H15.5L14.5,3H9.5L8.5,4H5V6H19M6,19A2,2 0 0,0 8,21H16A2,2 0 0,0 18,19V7H6V19Z\"/></svg>\n                  </button>\n                </div>\n              </div>\n            `).join('')}\n          </div>\n\n          <div class=\"add-preset-form\" id=\"preset-form\" style=\"display: none;\">\n            <div class=\"form-row\">\n              <label>Preset Name</label>\n              <input type=\"text\" class=\"text-input\" id=\"preset-name\" placeholder=\"My Preset\">\n            </div>\n            <div class=\"form-row\">\n              <label>Icon</label>\n              <div class=\"icon-grid\" id=\"icon-grid\">\n                ${['\uD83D\uDCFA', '\uD83D\uDCAC', '\u23F0', '\uD83C\uDFB5', '\uD83C\uDFA8', '\u2B50', '\u2764\uFE0F', '\uD83D\uDD25', '\uD83D\uDCA1', '\uD83C\uDF08', '\uD83C\uDFAE', '\uD83D\uDCE2', '\uD83C\uDFE0', '\uD83D\uDD14', '\u2728', '\uD83C\uDF89'].map(icon => `\n                  <button type=\"button\" class=\"icon-option${icon === this._selectedIcon ? ' selected' : ''}\" data-icon=\"${icon}\">${icon}</button>\n                `).join('')}\n              </div>\n            </div>\n            <div class=\"form-actions\">\n              <button class=\"btn btn-secondary\" id=\"cancel-preset-btn\">Cancel</button>\n              <button class=\"btn btn-primary\" id=\"save-preset-btn\">Save Preset</button>\n            </div>\n          </div>\n        </div>\n      </ha-card>`;\n\n    this._attachListeners();\n  }\n\n  _escapeHtml(text) {\n    const div = document.createElement('div');\n    div.textContent = text;\n    return div.innerHTML;\n  }\n\n  _attachListeners() {\n    // Add preset button\n    this.shadowRoot.getElementById('add-preset-btn')?.addEventListener('click', () => {\n      this._editingPreset = null;\n      this._selectedIcon = '\uD83D\uDCFA';\n      this.shadowRoot.getElementById('preset-form').style.display = 'block';\n      this.shadowRoot.getElementById('preset-name').value = '';\n      this.shadowRoot.querySelectorAll('.icon-option').forEach(o => o.classList.remove('selected'));\n      this.shadowRoot.querySelector('.icon-option')?.classList.add('selected');\n    });\n\n    // Cancel button\n    this.shadowRoot.getElementById('cancel-preset-btn')?.addEventListener('click', () => {\n      this.shadowRoot.getElementById('preset-form').style.display = 'none';\n      this._editingPreset = null;\n    });\n\n    // Save button\n    this.shadowRoot.getElementById('save-preset-btn')?.addEventListener('click', () => {\n      const name = this.shadowRoot.getElementById('preset-name').value.trim() || 'Preset';\n      const selectedIcon = this.shadowRoot.querySelector('.icon-option.selected');\n      const icon = selectedIcon?.dataset.icon || '\uD83D\uDCFA';\n      const currentState = getDisplayState();\n\n      const preset = {\n        name,\n        icon,\n        text: currentState.text || '',\n        mode: currentState.mode || 'text',\n        effect: currentState.effect || 'fixed',\n        speed: currentState.speed || 50,\n        fgColor: currentState.fgColor || '#ff6600',\n        bgColor: currentState.bgColor || '#000000',\n        font: currentState.font || 'VCR_OSD_MONO',\n        rainbowMode: currentState.rainbowMode || 0,\n        createdAt: Date.now()\n      };\n\n      if (this._editingPreset !== null) {\n        this._presets[this._editingPreset] = preset;\n      } else {\n        this._presets.push(preset);\n      }\n\n      this._savePresets();\n      this.shadowRoot.getElementById('preset-form').style.display = 'none';\n      this._editingPreset = null;\n      this.render();\n    });\n\n    // Icon selection\n    this.shadowRoot.querySelectorAll('.icon-option').forEach(opt => {\n      opt.addEventListener('click', (e) => {\n        this.shadowRoot.querySelectorAll('.icon-option').forEach(o => o.classList.remove('selected'));\n        e.currentTarget.classList.add('selected');\n        this._selectedIcon = e.currentTarget.dataset.icon;\n      });\n    });\n\n    // Preset item click (apply preset)\n    this.shadowRoot.querySelectorAll('.preset-item').forEach(item => {\n      item.addEventListener('click', (e) => {\n        // Don't apply if clicking action buttons\n        if (e.target.closest('.preset-actions')) return;\n\n        const index = parseInt(item.dataset.index);\n        const preset = this._presets[index];\n        if (preset) {\n          updateDisplayState({\n            text: preset.text,\n            mode: preset.mode,\n            effect: preset.effect,\n            speed: preset.speed,\n            fgColor: preset.fgColor,\n            bgColor: preset.bgColor,\n            font: preset.font,\n            rainbowMode: preset.rainbowMode\n          });\n\n          // Also send to device if text mode\n          if (preset.mode === 'text' && preset.text) {\n            this.callService('ipixel_color', 'display_text', {\n              text: preset.text,\n              effect: preset.effect,\n              speed: preset.speed,\n              color_fg: this.hexToRgb(preset.fgColor),\n              color_bg: this.hexToRgb(preset.bgColor),\n              font: preset.font,\n              rainbow_mode: preset.rainbowMode\n            });\n          }\n\n          // Update active state\n          this.shadowRoot.querySelectorAll('.preset-item').forEach(p => p.classList.remove('active'));\n          item.classList.add('active');\n        }\n      });\n    });\n\n    // Edit preset\n    this.shadowRoot.querySelectorAll('[data-action=\"edit\"]').forEach(btn => {\n      btn.addEventListener('click', (e) => {\n        e.stopPropagation();\n        const index = parseInt(e.currentTarget.dataset.index);\n        const preset = this._presets[index];\n        if (preset) {\n          this._editingPreset = index;\n          this._selectedIcon = preset.icon || '\uD83D\uDCFA';\n          this.shadowRoot.getElementById('preset-form').style.display = 'block';\n          this.shadowRoot.getElementById('preset-name').value = preset.name;\n          this.shadowRoot.querySelectorAll('.icon-option').forEach(o => {\n            o.classList.toggle('selected', o.dataset.icon === preset.icon);\n          });\n        }\n      });\n    });\n\n    // Delete preset\n    this.shadowRoot.querySelectorAll('[data-action=\"delete\"]').forEach(btn => {\n      btn.addEventListener('click', (e) => {\n        e.stopPropagation();\n        const index = parseInt(e.currentTarget.dataset.index);\n        if (confirm('Delete this preset?')) {\n          this._presets.splice(index, 1);\n          this._savePresets();\n          this.render();\n        }\n      });\n    });\n  }\n\n  static getConfigElement() { return document.createElement('ipixel-simple-editor'); }\n  static getStubConfig() { return { entity: '' }; }\n}\n", "/**\n * iPIXEL Schedule Card\n * Time-based content scheduling and power automation\n */\n\nimport { iPIXELCardBase } from '../base.js';\nimport { iPIXELCardStyles } from '../styles.js';\nimport { getDisplayState, updateDisplayState } from '../state.js';\n\n// Storage key for schedules\nconst SCHEDULES_STORAGE_KEY = 'iPIXEL_Schedules';\n\nexport class iPIXELScheduleCard extends iPIXELCardBase {\n  constructor() {\n    super();\n    this._schedules = this._loadSchedules();\n    this._powerSchedule = this._loadPowerSchedule();\n    this._editingSlot = null;\n    this._checkInterval = null;\n  }\n\n  connectedCallback() {\n    // Check schedules every minute\n    this._checkInterval = setInterval(() => this._checkSchedules(), 60000);\n    this._checkSchedules();\n  }\n\n  disconnectedCallback() {\n    if (this._checkInterval) {\n      clearInterval(this._checkInterval);\n    }\n  }\n\n  _loadSchedules() {\n    try {\n      const saved = localStorage.getItem(SCHEDULES_STORAGE_KEY);\n      return saved ? JSON.parse(saved) : [];\n    } catch (e) {\n      return [];\n    }\n  }\n\n  _saveSchedules() {\n    try {\n      localStorage.setItem(SCHEDULES_STORAGE_KEY, JSON.stringify(this._schedules));\n    } catch (e) {\n      console.warn('iPIXEL: Failed to save schedules', e);\n    }\n  }\n\n  _loadPowerSchedule() {\n    try {\n      const saved = localStorage.getItem('iPIXEL_PowerSchedule');\n      return saved ? JSON.parse(saved) : { enabled: false, onTime: '07:00', offTime: '22:00' };\n    } catch (e) {\n      return { enabled: false, onTime: '07:00', offTime: '22:00' };\n    }\n  }\n\n  _savePowerSchedule() {\n    try {\n      localStorage.setItem('iPIXEL_PowerSchedule', JSON.stringify(this._powerSchedule));\n    } catch (e) {\n      console.warn('iPIXEL: Failed to save power schedule', e);\n    }\n  }\n\n  _checkSchedules() {\n    const now = new Date();\n    const currentTime = `${now.getHours().toString().padStart(2, '0')}:${now.getMinutes().toString().padStart(2, '0')}`;\n    const currentDay = now.getDay(); // 0 = Sunday\n\n    // Check content schedules\n    for (const schedule of this._schedules) {\n      if (!schedule.enabled) continue;\n      if (schedule.days && !schedule.days.includes(currentDay)) continue;\n\n      if (schedule.startTime === currentTime) {\n        // Apply this schedule\n        updateDisplayState({\n          text: schedule.text || '',\n          mode: schedule.mode || 'text',\n          effect: schedule.effect || 'fixed',\n          fgColor: schedule.fgColor || '#ff6600',\n          bgColor: schedule.bgColor || '#000000'\n        });\n\n        if (schedule.mode === 'text' && schedule.text) {\n          this.callService('ipixel_color', 'display_text', {\n            text: schedule.text,\n            effect: schedule.effect,\n            color_fg: this.hexToRgb(schedule.fgColor),\n            color_bg: this.hexToRgb(schedule.bgColor)\n          });\n        } else if (schedule.mode === 'clock') {\n          this.callService('ipixel_color', 'set_clock_mode', { style: 1 });\n        }\n      }\n    }\n  }\n\n  render() {\n    if (!this._hass) return;\n    const now = new Date();\n    const nowPos = ((now.getHours() * 60 + now.getMinutes()) / 1440) * 100;\n    const currentTime = `${now.getHours().toString().padStart(2, '0')}:${now.getMinutes().toString().padStart(2, '0')}`;\n\n    // Generate schedule blocks for timeline\n    const scheduleBlocks = this._schedules.filter(s => s.enabled).map(s => {\n      const startMins = this._timeToMinutes(s.startTime);\n      const endMins = s.endTime ? this._timeToMinutes(s.endTime) : startMins + 60;\n      const startPos = (startMins / 1440) * 100;\n      const width = ((endMins - startMins) / 1440) * 100;\n      return `<div class=\"timeline-block\" style=\"left: ${startPos}%; width: ${width}%; background: ${s.fgColor || '#03a9f4'}40;\" title=\"${s.name || 'Schedule'}\"></div>`;\n    }).join('');\n\n    const dayNames = ['Su', 'Mo', 'Tu', 'We', 'Th', 'Fr', 'Sa'];\n\n    this.shadowRoot.innerHTML = `\n      <style>${iPIXELCardStyles}\n        .timeline { background: rgba(255,255,255,0.05); border-radius: 6px; padding: 12px; margin-bottom: 12px; }\n        .timeline-header { display: flex; justify-content: space-between; font-size: 0.7em; opacity: 0.5; margin-bottom: 6px; }\n        .timeline-bar { height: 32px; background: rgba(255,255,255,0.1); border-radius: 4px; position: relative; overflow: hidden; }\n        .timeline-now { position: absolute; width: 2px; height: 100%; background: #f44336; left: ${nowPos}%; z-index: 2; }\n        .timeline-block { position: absolute; height: 100%; border-radius: 2px; z-index: 1; }\n        .power-section { background: rgba(255,255,255,0.03); border-radius: 8px; padding: 12px; margin-bottom: 12px; }\n        .power-row { display: flex; gap: 12px; align-items: center; flex-wrap: wrap; }\n        .power-row label { font-size: 0.85em; }\n        .power-row input[type=\"time\"] {\n          padding: 6px 10px;\n          background: rgba(255,255,255,0.08);\n          border: 1px solid rgba(255,255,255,0.1);\n          border-radius: 4px;\n          color: inherit;\n        }\n        .schedule-list {\n          display: flex;\n          flex-direction: column;\n          gap: 8px;\n          margin-bottom: 12px;\n          max-height: 250px;\n          overflow-y: auto;\n        }\n        .schedule-item {\n          display: flex;\n          align-items: center;\n          gap: 8px;\n          padding: 10px 12px;\n          background: rgba(255,255,255,0.05);\n          border-radius: 8px;\n          border: 1px solid rgba(255,255,255,0.1);\n        }\n        .schedule-toggle {\n          width: 36px;\n          height: 20px;\n          background: rgba(255,255,255,0.1);\n          border-radius: 10px;\n          position: relative;\n          cursor: pointer;\n          transition: background 0.2s;\n        }\n        .schedule-toggle.active {\n          background: var(--primary-color, #03a9f4);\n        }\n        .schedule-toggle::after {\n          content: '';\n          position: absolute;\n          top: 2px;\n          left: 2px;\n          width: 16px;\n          height: 16px;\n          background: #fff;\n          border-radius: 50%;\n          transition: transform 0.2s;\n        }\n        .schedule-toggle.active::after {\n          transform: translateX(16px);\n        }\n        .schedule-info { flex: 1; min-width: 0; }\n        .schedule-name { font-weight: 500; font-size: 0.9em; }\n        .schedule-time { font-size: 0.75em; opacity: 0.6; }\n        .schedule-actions button {\n          padding: 4px;\n          background: transparent;\n          border: none;\n          color: rgba(255,255,255,0.5);\n          cursor: pointer;\n          border-radius: 4px;\n        }\n        .schedule-actions button:hover {\n          background: rgba(255,255,255,0.1);\n          color: #fff;\n        }\n        .add-slot-form {\n          background: rgba(255,255,255,0.03);\n          border-radius: 8px;\n          padding: 16px;\n          margin-top: 12px;\n        }\n        .form-row { margin-bottom: 12px; }\n        .form-row label { display: block; font-size: 0.8em; opacity: 0.7; margin-bottom: 4px; }\n        .form-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }\n        .day-selector {\n          display: flex;\n          gap: 4px;\n          flex-wrap: wrap;\n        }\n        .day-btn {\n          width: 32px;\n          height: 32px;\n          border: 1px solid rgba(255,255,255,0.1);\n          border-radius: 4px;\n          background: transparent;\n          color: rgba(255,255,255,0.6);\n          cursor: pointer;\n          font-size: 0.75em;\n          transition: all 0.2s;\n        }\n        .day-btn.selected {\n          background: var(--primary-color, #03a9f4);\n          border-color: var(--primary-color, #03a9f4);\n          color: #fff;\n        }\n        .form-actions { display: flex; gap: 8px; justify-content: flex-end; margin-top: 16px; }\n        .current-time { font-size: 0.85em; opacity: 0.7; text-align: right; margin-bottom: 4px; }\n      </style>\n      <ha-card>\n        <div class=\"card-content\">\n          <div class=\"current-time\">Current: ${currentTime}</div>\n\n          <div class=\"section-title\">Timeline</div>\n          <div class=\"timeline\">\n            <div class=\"timeline-header\">\n              <span>00:00</span><span>06:00</span><span>12:00</span><span>18:00</span><span>24:00</span>\n            </div>\n            <div class=\"timeline-bar\">\n              ${scheduleBlocks}\n              <div class=\"timeline-now\"></div>\n            </div>\n          </div>\n\n          <div class=\"section-title\">Power Schedule</div>\n          <div class=\"power-section\">\n            <div class=\"power-row\">\n              <div class=\"schedule-toggle ${this._powerSchedule.enabled ? 'active' : ''}\" id=\"power-toggle\"></div>\n              <label>On:</label>\n              <input type=\"time\" id=\"power-on\" value=\"${this._powerSchedule.onTime}\">\n              <label>Off:</label>\n              <input type=\"time\" id=\"power-off\" value=\"${this._powerSchedule.offTime}\">\n              <button class=\"btn btn-primary\" id=\"save-power\">Save</button>\n            </div>\n          </div>\n\n          <div class=\"section-title\">Content Schedules</div>\n          <div class=\"schedule-list\" id=\"schedule-list\">\n            ${this._schedules.length === 0 ? `\n              <div class=\"empty-state\" style=\"padding: 20px; text-align: center; opacity: 0.5;\">\n                No schedules configured\n              </div>\n            ` : this._schedules.map((slot, i) => `\n              <div class=\"schedule-item\" data-index=\"${i}\">\n                <div class=\"schedule-toggle ${slot.enabled ? 'active' : ''}\" data-action=\"toggle\" data-index=\"${i}\"></div>\n                <div class=\"schedule-info\">\n                  <div class=\"schedule-name\">${this._escapeHtml(slot.name || 'Schedule ' + (i + 1))}</div>\n                  <div class=\"schedule-time\">\n                    ${slot.startTime}${slot.endTime ? ' - ' + slot.endTime : ''} \u00B7\n                    ${slot.days ? slot.days.map(d => dayNames[d]).join(', ') : 'Daily'} \u00B7\n                    ${slot.mode || 'text'}\n                  </div>\n                </div>\n                <div class=\"schedule-actions\">\n                  <button data-action=\"edit\" data-index=\"${i}\" title=\"Edit\">\n                    <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\"><path fill=\"currentColor\" d=\"M20.71,7.04C21.1,6.65 21.1,6 20.71,5.63L18.37,3.29C18,2.9 17.35,2.9 16.96,3.29L15.12,5.12L18.87,8.87M3,17.25V21H6.75L17.81,9.93L14.06,6.18L3,17.25Z\"/></svg>\n                  </button>\n                  <button data-action=\"delete\" data-index=\"${i}\" title=\"Delete\">\n                    <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\"><path fill=\"currentColor\" d=\"M19,4H15.5L14.5,3H9.5L8.5,4H5V6H19M6,19A2,2 0 0,0 8,21H16A2,2 0 0,0 18,19V7H6V19Z\"/></svg>\n                  </button>\n                </div>\n              </div>\n            `).join('')}\n          </div>\n\n          <button class=\"btn btn-secondary\" id=\"add-slot\" style=\"width: 100%;\">+ Add Schedule</button>\n\n          <div class=\"add-slot-form\" id=\"slot-form\" style=\"display: none;\">\n            <div class=\"form-row\">\n              <label>Name</label>\n              <input type=\"text\" class=\"text-input\" id=\"slot-name\" placeholder=\"Morning Message\">\n            </div>\n            <div class=\"form-grid\">\n              <div class=\"form-row\">\n                <label>Start Time</label>\n                <input type=\"time\" class=\"text-input\" id=\"slot-start\" value=\"08:00\" style=\"width: 100%;\">\n              </div>\n              <div class=\"form-row\">\n                <label>End Time (optional)</label>\n                <input type=\"time\" class=\"text-input\" id=\"slot-end\" style=\"width: 100%;\">\n              </div>\n            </div>\n            <div class=\"form-row\">\n              <label>Days</label>\n              <div class=\"day-selector\" id=\"day-selector\">\n                ${dayNames.map((name, i) => `\n                  <button type=\"button\" class=\"day-btn selected\" data-day=\"${i}\">${name}</button>\n                `).join('')}\n              </div>\n            </div>\n            <div class=\"form-grid\">\n              <div class=\"form-row\">\n                <label>Mode</label>\n                <select class=\"dropdown\" id=\"slot-mode\">\n                  <option value=\"text\">Text</option>\n                  <option value=\"clock\">Clock</option>\n                  <option value=\"off\">Power Off</option>\n                </select>\n              </div>\n              <div class=\"form-row\">\n                <label>Effect</label>\n                <select class=\"dropdown\" id=\"slot-effect\">\n                  <option value=\"fixed\">Fixed</option>\n                  <option value=\"scroll_ltr\">Scroll Left</option>\n                  <option value=\"scroll_rtl\">Scroll Right</option>\n                  <option value=\"blink\">Blink</option>\n                </select>\n              </div>\n            </div>\n            <div class=\"form-row\" id=\"text-row\">\n              <label>Text</label>\n              <input type=\"text\" class=\"text-input\" id=\"slot-text\" placeholder=\"Good Morning!\">\n            </div>\n            <div class=\"form-grid\">\n              <div class=\"form-row\">\n                <label>Text Color</label>\n                <input type=\"color\" id=\"slot-fg-color\" value=\"#ff6600\" style=\"width: 100%; height: 32px;\">\n              </div>\n              <div class=\"form-row\">\n                <label>Background</label>\n                <input type=\"color\" id=\"slot-bg-color\" value=\"#000000\" style=\"width: 100%; height: 32px;\">\n              </div>\n            </div>\n            <div class=\"form-actions\">\n              <button class=\"btn btn-secondary\" id=\"cancel-slot\">Cancel</button>\n              <button class=\"btn btn-primary\" id=\"save-slot\">Save Schedule</button>\n            </div>\n          </div>\n        </div>\n      </ha-card>`;\n\n    this._attachListeners();\n  }\n\n  _timeToMinutes(time) {\n    const [h, m] = time.split(':').map(Number);\n    return h * 60 + m;\n  }\n\n  _escapeHtml(text) {\n    const div = document.createElement('div');\n    div.textContent = text;\n    return div.innerHTML;\n  }\n\n  _attachListeners() {\n    // Power toggle\n    this.shadowRoot.getElementById('power-toggle')?.addEventListener('click', (e) => {\n      this._powerSchedule.enabled = !this._powerSchedule.enabled;\n      e.currentTarget.classList.toggle('active', this._powerSchedule.enabled);\n    });\n\n    // Save power schedule\n    this.shadowRoot.getElementById('save-power')?.addEventListener('click', () => {\n      this._powerSchedule.onTime = this.shadowRoot.getElementById('power-on')?.value || '07:00';\n      this._powerSchedule.offTime = this.shadowRoot.getElementById('power-off')?.value || '22:00';\n      this._savePowerSchedule();\n\n      this.callService('ipixel_color', 'set_power_schedule', {\n        enabled: this._powerSchedule.enabled,\n        on_time: this._powerSchedule.onTime,\n        off_time: this._powerSchedule.offTime\n      });\n    });\n\n    // Add slot button\n    this.shadowRoot.getElementById('add-slot')?.addEventListener('click', () => {\n      this._editingSlot = null;\n      this._resetSlotForm();\n      this.shadowRoot.getElementById('slot-form').style.display = 'block';\n    });\n\n    // Cancel button\n    this.shadowRoot.getElementById('cancel-slot')?.addEventListener('click', () => {\n      this.shadowRoot.getElementById('slot-form').style.display = 'none';\n      this._editingSlot = null;\n    });\n\n    // Day selector\n    this.shadowRoot.querySelectorAll('.day-btn').forEach(btn => {\n      btn.addEventListener('click', (e) => {\n        e.currentTarget.classList.toggle('selected');\n      });\n    });\n\n    // Mode change (show/hide text field)\n    this.shadowRoot.getElementById('slot-mode')?.addEventListener('change', (e) => {\n      const textRow = this.shadowRoot.getElementById('text-row');\n      if (textRow) {\n        textRow.style.display = e.target.value === 'text' ? 'block' : 'none';\n      }\n    });\n\n    // Save slot\n    this.shadowRoot.getElementById('save-slot')?.addEventListener('click', () => {\n      const selectedDays = Array.from(this.shadowRoot.querySelectorAll('.day-btn.selected'))\n        .map(btn => parseInt(btn.dataset.day));\n\n      const slot = {\n        name: this.shadowRoot.getElementById('slot-name')?.value || 'Schedule',\n        startTime: this.shadowRoot.getElementById('slot-start')?.value || '08:00',\n        endTime: this.shadowRoot.getElementById('slot-end')?.value || '',\n        days: selectedDays.length === 7 ? null : selectedDays,\n        mode: this.shadowRoot.getElementById('slot-mode')?.value || 'text',\n        effect: this.shadowRoot.getElementById('slot-effect')?.value || 'fixed',\n        text: this.shadowRoot.getElementById('slot-text')?.value || '',\n        fgColor: this.shadowRoot.getElementById('slot-fg-color')?.value || '#ff6600',\n        bgColor: this.shadowRoot.getElementById('slot-bg-color')?.value || '#000000',\n        enabled: true\n      };\n\n      if (this._editingSlot !== null) {\n        this._schedules[this._editingSlot] = slot;\n      } else {\n        this._schedules.push(slot);\n      }\n\n      this._saveSchedules();\n      this.shadowRoot.getElementById('slot-form').style.display = 'none';\n      this._editingSlot = null;\n      this.render();\n    });\n\n    // Toggle schedule\n    this.shadowRoot.querySelectorAll('[data-action=\"toggle\"]').forEach(btn => {\n      btn.addEventListener('click', (e) => {\n        const index = parseInt(e.currentTarget.dataset.index);\n        this._schedules[index].enabled = !this._schedules[index].enabled;\n        this._saveSchedules();\n        e.currentTarget.classList.toggle('active', this._schedules[index].enabled);\n      });\n    });\n\n    // Edit schedule\n    this.shadowRoot.querySelectorAll('[data-action=\"edit\"]').forEach(btn => {\n      btn.addEventListener('click', (e) => {\n        const index = parseInt(e.currentTarget.dataset.index);\n        const slot = this._schedules[index];\n        if (slot) {\n          this._editingSlot = index;\n          this._fillSlotForm(slot);\n          this.shadowRoot.getElementById('slot-form').style.display = 'block';\n        }\n      });\n    });\n\n    // Delete schedule\n    this.shadowRoot.querySelectorAll('[data-action=\"delete\"]').forEach(btn => {\n      btn.addEventListener('click', (e) => {\n        const index = parseInt(e.currentTarget.dataset.index);\n        if (confirm('Delete this schedule?')) {\n          this._schedules.splice(index, 1);\n          this._saveSchedules();\n          this.render();\n        }\n      });\n    });\n  }\n\n  _resetSlotForm() {\n    this.shadowRoot.getElementById('slot-name').value = '';\n    this.shadowRoot.getElementById('slot-start').value = '08:00';\n    this.shadowRoot.getElementById('slot-end').value = '';\n    this.shadowRoot.getElementById('slot-mode').value = 'text';\n    this.shadowRoot.getElementById('slot-effect').value = 'fixed';\n    this.shadowRoot.getElementById('slot-text').value = '';\n    this.shadowRoot.getElementById('slot-fg-color').value = '#ff6600';\n    this.shadowRoot.getElementById('slot-bg-color').value = '#000000';\n    this.shadowRoot.querySelectorAll('.day-btn').forEach(btn => btn.classList.add('selected'));\n    this.shadowRoot.getElementById('text-row').style.display = 'block';\n  }\n\n  _fillSlotForm(slot) {\n    this.shadowRoot.getElementById('slot-name').value = slot.name || '';\n    this.shadowRoot.getElementById('slot-start').value = slot.startTime || '08:00';\n    this.shadowRoot.getElementById('slot-end').value = slot.endTime || '';\n    this.shadowRoot.getElementById('slot-mode').value = slot.mode || 'text';\n    this.shadowRoot.getElementById('slot-effect').value = slot.effect || 'fixed';\n    this.shadowRoot.getElementById('slot-text').value = slot.text || '';\n    this.shadowRoot.getElementById('slot-fg-color').value = slot.fgColor || '#ff6600';\n    this.shadowRoot.getElementById('slot-bg-color').value = slot.bgColor || '#000000';\n\n    const selectedDays = slot.days || [0, 1, 2, 3, 4, 5, 6];\n    this.shadowRoot.querySelectorAll('.day-btn').forEach(btn => {\n      btn.classList.toggle('selected', selectedDays.includes(parseInt(btn.dataset.day)));\n    });\n\n    this.shadowRoot.getElementById('text-row').style.display = slot.mode === 'text' ? 'block' : 'none';\n  }\n\n  static getConfigElement() { return document.createElement('ipixel-simple-editor'); }\n  static getStubConfig() { return { entity: '' }; }\n}\n", "/**\n * iPIXEL Pixel Editor Card\n * Canvas-based pixel art editor for LED matrix displays\n * Adapted from iPIXEL PNG Editor by opa-gamert\n */\n\nimport { iPIXELCardBase } from '../base.js';\nimport { iPIXELCardStyles } from '../styles.js';\n\n// Color palette (same as original editor)\nconst PALETTE_COLORS = [\n  '#FFFFFF', '#000000', '#FF0000', '#00FF00',\n  '#0080FF', '#FFFF00', '#FF00FF', '#00FFFF',\n  '#FF8000', '#8000FF', '#2EC4FF', '#0010A0',\n  '#A0FF00', '#FF80C0', '#808080', '#C0C0C0'\n];\n\n// Resolution options for different LED matrices\nconst RESOLUTION_OPTIONS = [\n  { value: '16x16', label: '16\u00D716' },\n  { value: '32x8', label: '32\u00D78' },\n  { value: '32x16', label: '32\u00D716' },\n  { value: '32x32', label: '32\u00D732' },\n  { value: '64x16', label: '64\u00D716' },\n  { value: '96x16', label: '96\u00D716' },\n  { value: '128x16', label: '128\u00D716' },\n];\n\n// Background color for LED backplate\nconst BG_COLOR = { r: 25, g: 25, b: 25 };\n\nexport class iPIXELEditorCard extends iPIXELCardBase {\n  constructor() {\n    super();\n    // Editor state\n    this._width = 64;\n    this._height = 16;\n    this._tool = 'pen';\n    this._drawing = false;\n    this._gridOn = true;\n    this._currentColor = '#ff6600';\n    this._scale = 8;\n    this._sending = false;\n\n    // Canvases (created once, reused)\n    this._logicalCanvas = document.createElement('canvas');\n    this._ctx = this._logicalCanvas.getContext('2d');\n    this._displayCanvas = null;\n    this._dctx = null;\n    this._initialized = false;\n  }\n\n  setConfig(config) {\n    if (!config.entity) throw new Error('Please define an entity');\n    this._config = config;\n    // Don't call render here - wait for hass\n  }\n\n  set hass(hass) {\n    const hadHass = !!this._hass;\n    this._hass = hass;\n\n    // Only do full render on first hass set or config change\n    if (!hadHass) {\n      // Get resolution from device\n      const [w, h] = this.getResolution();\n      this._width = w;\n      this._height = h;\n      this._logicalCanvas.width = w;\n      this._logicalCanvas.height = h;\n      this.render();\n    }\n  }\n\n  render() {\n    if (!this._hass) return;\n\n    const entity = this.getEntity();\n    const isOn = this.isOn();\n    const [deviceWidth, deviceHeight] = this.getResolution();\n\n    // Build resolution options\n    const resolutionOptions = RESOLUTION_OPTIONS.map(opt => {\n      const selected = opt.value === `${this._width}x${this._height}` ? 'selected' : '';\n      return `<option value=\"${opt.value}\" ${selected}>${opt.label}</option>`;\n    }).join('');\n\n    // Build palette swatches\n    const paletteSwatches = PALETTE_COLORS.map(color => {\n      const active = color.toLowerCase() === this._currentColor.toLowerCase() ? 'active' : '';\n      return `<div class=\"color-swatch ${active}\" data-color=\"${color}\" style=\"background:${color}\"></div>`;\n    }).join('');\n\n    this.shadowRoot.innerHTML = `\n      <style>\n        ${iPIXELCardStyles}\n\n        .editor-toolbar {\n          display: flex;\n          gap: 8px;\n          align-items: center;\n          margin-bottom: 12px;\n          flex-wrap: wrap;\n        }\n\n        .tool-group {\n          display: flex;\n          gap: 4px;\n        }\n\n        .color-palette {\n          display: flex;\n          flex-wrap: wrap;\n          gap: 4px;\n          margin-bottom: 12px;\n        }\n\n        .color-swatch {\n          width: 24px;\n          height: 24px;\n          border-radius: 4px;\n          cursor: pointer;\n          border: 2px solid transparent;\n          box-sizing: border-box;\n        }\n\n        .color-swatch:hover {\n          border-color: rgba(255,255,255,0.5);\n        }\n\n        .color-swatch.active {\n          border-color: var(--ipixel-primary);\n          box-shadow: 0 0 0 1px var(--ipixel-primary);\n        }\n\n        .canvas-container {\n          background: #050608;\n          border-radius: 8px;\n          padding: 8px;\n          margin-bottom: 12px;\n          overflow: auto;\n          text-align: center;\n        }\n\n        #editor-canvas {\n          display: inline-block;\n          cursor: crosshair;\n          image-rendering: pixelated;\n          touch-action: none;\n        }\n\n        .info-row {\n          display: flex;\n          justify-content: space-between;\n          font-size: 0.75em;\n          opacity: 0.6;\n          margin-bottom: 8px;\n        }\n\n        .tool-icon {\n          font-size: 16px;\n        }\n\n        .resolution-select {\n          padding: 6px 8px;\n          background: rgba(255,255,255,0.08);\n          border: 1px solid var(--ipixel-border);\n          border-radius: 6px;\n          color: inherit;\n          font-size: 0.85em;\n          cursor: pointer;\n        }\n\n        .send-btn:disabled {\n          opacity: 0.5;\n          cursor: not-allowed;\n        }\n      </style>\n\n      <ha-card>\n        <div class=\"card-content\">\n          <div class=\"card-header\">\n            <div class=\"card-title\">\n              <span class=\"status-dot ${isOn ? '' : 'off'}\"></span>\n              ${this._config.name || 'Pixel Editor'}\n            </div>\n          </div>\n\n          <!-- Toolbar -->\n          <div class=\"editor-toolbar\">\n            <div class=\"tool-group\">\n              <button class=\"icon-btn ${this._tool === 'pen' ? 'active' : ''}\" id=\"pen-tool\" title=\"Pen Tool\">\n                <span class=\"tool-icon\">&#9998;</span>\n              </button>\n              <button class=\"icon-btn ${this._tool === 'eraser' ? 'active' : ''}\" id=\"eraser-tool\" title=\"Eraser Tool\">\n                <span class=\"tool-icon\">&#9746;</span>\n              </button>\n            </div>\n            <input type=\"color\" class=\"color-picker\" id=\"color-picker\" value=\"${this._currentColor}\" title=\"Pick Color\">\n            <button class=\"icon-btn ${this._gridOn ? 'active' : ''}\" id=\"grid-toggle\" title=\"Toggle LED Grid\">\n              <span class=\"tool-icon\">&#9638;</span>\n            </button>\n            <select class=\"resolution-select\" id=\"resolution-select\" title=\"Canvas Size\">\n              ${resolutionOptions}\n            </select>\n          </div>\n\n          <!-- Color Palette -->\n          <div class=\"color-palette\" id=\"palette\">\n            ${paletteSwatches}\n          </div>\n\n          <!-- Canvas -->\n          <div class=\"canvas-container\">\n            <canvas id=\"editor-canvas\"></canvas>\n          </div>\n\n          <!-- Info -->\n          <div class=\"info-row\">\n            <span>Tool: ${this._tool} | Grid: ${this._gridOn ? 'LED' : 'Flat'}</span>\n            <span>Device: ${deviceWidth}\u00D7${deviceHeight}</span>\n          </div>\n\n          <!-- Actions -->\n          <div class=\"button-grid button-grid-3\">\n            <button class=\"btn btn-secondary\" id=\"clear-btn\">Clear</button>\n            <button class=\"btn btn-secondary\" id=\"import-btn\">Import</button>\n            <button class=\"btn btn-primary send-btn\" id=\"send-btn\" ${this._sending ? 'disabled' : ''}>\n              ${this._sending ? 'Sending...' : 'Send to Device'}\n            </button>\n          </div>\n\n          <!-- Hidden file input for import -->\n          <input type=\"file\" id=\"file-input\" accept=\"image/png,image/gif,image/jpeg\" style=\"display:none\">\n        </div>\n      </ha-card>\n    `;\n\n    this._initCanvas();\n    this._attachListeners();\n  }\n\n  _initCanvas() {\n    this._displayCanvas = this.shadowRoot.getElementById('editor-canvas');\n    if (!this._displayCanvas) return;\n\n    this._dctx = this._displayCanvas.getContext('2d');\n\n    // Ensure logical canvas matches dimensions\n    if (this._logicalCanvas.width !== this._width || this._logicalCanvas.height !== this._height) {\n      this._logicalCanvas.width = this._width;\n      this._logicalCanvas.height = this._height;\n    }\n\n    this._updateDisplaySize();\n    this._renderDisplay();\n    this._initialized = true;\n  }\n\n  _updateDisplaySize() {\n    if (!this._displayCanvas) return;\n    this._displayCanvas.width = this._width * this._scale;\n    this._displayCanvas.height = this._height * this._scale;\n  }\n\n  _renderDisplay() {\n    if (!this._dctx || !this._ctx) return;\n\n    this._updateDisplaySize();\n\n    // Panel background\n    this._dctx.fillStyle = '#050608';\n    this._dctx.fillRect(0, 0, this._displayCanvas.width, this._displayCanvas.height);\n\n    const imgData = this._ctx.getImageData(0, 0, this._width, this._height).data;\n    const cellSize = this._scale;\n    const ledRadius = cellSize * 0.38;\n\n    for (let y = 0; y < this._height; y++) {\n      for (let x = 0; x < this._width; x++) {\n        const idx = (y * this._width + x) * 4;\n        const r = imgData[idx];\n        const g = imgData[idx + 1];\n        const b = imgData[idx + 2];\n        const a = imgData[idx + 3];\n\n        const isOffPixel = (a === 0);\n\n        const sx = x * cellSize;\n        const sy = y * cellSize;\n        const cx = sx + cellSize / 2;\n        const cy = sy + cellSize / 2;\n\n        // Background square (backplate)\n        this._dctx.fillStyle = `rgb(${BG_COLOR.r},${BG_COLOR.g},${BG_COLOR.b})`;\n        this._dctx.fillRect(sx, sy, cellSize, cellSize);\n\n        if (this._gridOn) {\n          if (!isOffPixel) {\n            // On-pixel: colored LED + glow\n            const grad = this._dctx.createRadialGradient(\n              cx, cy, ledRadius * 0.3,\n              cx, cy, ledRadius * 1.8\n            );\n            grad.addColorStop(0, `rgba(${r},${g},${b},0.4)`);\n            grad.addColorStop(1, `rgba(${r},${g},${b},0)`);\n            this._dctx.fillStyle = grad;\n            this._dctx.beginPath();\n            this._dctx.arc(cx, cy, ledRadius * 1.8, 0, Math.PI * 2);\n            this._dctx.fill();\n\n            // Core LED (solid circle)\n            this._dctx.fillStyle = `rgb(${r},${g},${b})`;\n            this._dctx.beginPath();\n            this._dctx.arc(cx, cy, ledRadius, 0, Math.PI * 2);\n            this._dctx.fill();\n          } else {\n            // Off-pixel: dark LED dot\n            this._dctx.fillStyle = 'rgb(5,5,5)';\n            this._dctx.beginPath();\n            this._dctx.arc(cx, cy, ledRadius, 0, Math.PI * 2);\n            this._dctx.fill();\n          }\n        } else {\n          // Flat view (no LED grid)\n          if (!isOffPixel) {\n            this._dctx.fillStyle = `rgb(${r},${g},${b})`;\n          } else {\n            this._dctx.fillStyle = `rgb(${BG_COLOR.r},${BG_COLOR.g},${BG_COLOR.b})`;\n          }\n          this._dctx.fillRect(sx, sy, cellSize, cellSize);\n        }\n      }\n    }\n  }\n\n  _getPixelPos(evt) {\n    if (!this._displayCanvas) return null;\n    const rect = this._displayCanvas.getBoundingClientRect();\n    const cellW = rect.width / this._width;\n    const cellH = rect.height / this._height;\n\n    // Handle both mouse and touch events\n    const clientX = evt.touches ? evt.touches[0].clientX : evt.clientX;\n    const clientY = evt.touches ? evt.touches[0].clientY : evt.clientY;\n\n    const x = Math.floor((clientX - rect.left) / cellW);\n    const y = Math.floor((clientY - rect.top) / cellH);\n\n    if (x < 0 || y < 0 || x >= this._width || y >= this._height) return null;\n    return { x, y };\n  }\n\n  _drawAt(evt) {\n    const p = this._getPixelPos(evt);\n    if (!p) return;\n\n    if (this._tool === 'pen') {\n      this._ctx.fillStyle = this._currentColor;\n      this._ctx.fillRect(p.x, p.y, 1, 1);\n    } else {\n      this._ctx.clearRect(p.x, p.y, 1, 1);\n    }\n    this._renderDisplay();\n  }\n\n  _attachListeners() {\n    const canvas = this.shadowRoot.getElementById('editor-canvas');\n    if (!canvas) return;\n\n    // Mouse events\n    canvas.addEventListener('mousedown', (e) => {\n      e.preventDefault();\n      this._drawing = true;\n      this._drawAt(e);\n    });\n\n    canvas.addEventListener('mousemove', (e) => {\n      if (this._drawing) this._drawAt(e);\n    });\n\n    window.addEventListener('mouseup', () => {\n      this._drawing = false;\n    });\n\n    // Touch events for mobile\n    canvas.addEventListener('touchstart', (e) => {\n      e.preventDefault();\n      this._drawing = true;\n      this._drawAt(e);\n    }, { passive: false });\n\n    canvas.addEventListener('touchmove', (e) => {\n      e.preventDefault();\n      if (this._drawing) this._drawAt(e);\n    }, { passive: false });\n\n    canvas.addEventListener('touchend', () => {\n      this._drawing = false;\n    });\n\n    // Tool selection\n    this.shadowRoot.getElementById('pen-tool')?.addEventListener('click', () => {\n      this._tool = 'pen';\n      this.render();\n    });\n\n    this.shadowRoot.getElementById('eraser-tool')?.addEventListener('click', () => {\n      this._tool = 'eraser';\n      this.render();\n    });\n\n    // Color picker\n    this.shadowRoot.getElementById('color-picker')?.addEventListener('input', (e) => {\n      this._currentColor = e.target.value;\n      this._updatePaletteSelection();\n    });\n\n    // Palette swatches\n    this.shadowRoot.querySelectorAll('.color-swatch').forEach(swatch => {\n      swatch.addEventListener('click', () => {\n        this._currentColor = swatch.dataset.color;\n        this.shadowRoot.getElementById('color-picker').value = this._currentColor;\n        this._updatePaletteSelection();\n      });\n    });\n\n    // Grid toggle\n    this.shadowRoot.getElementById('grid-toggle')?.addEventListener('click', () => {\n      this._gridOn = !this._gridOn;\n      this.render();\n    });\n\n    // Resolution change\n    this.shadowRoot.getElementById('resolution-select')?.addEventListener('change', (e) => {\n      const [w, h] = e.target.value.split('x').map(v => parseInt(v, 10));\n      this._resizeCanvas(w, h);\n    });\n\n    // Clear button\n    this.shadowRoot.getElementById('clear-btn')?.addEventListener('click', () => {\n      this._clearCanvas();\n    });\n\n    // Import button\n    this.shadowRoot.getElementById('import-btn')?.addEventListener('click', () => {\n      this.shadowRoot.getElementById('file-input')?.click();\n    });\n\n    // File input handler\n    this.shadowRoot.getElementById('file-input')?.addEventListener('change', (e) => {\n      const file = e.target.files?.[0];\n      if (file) this._handleImport(file);\n    });\n\n    // Send button\n    this.shadowRoot.getElementById('send-btn')?.addEventListener('click', () => {\n      this._sendToDevice();\n    });\n  }\n\n  _updatePaletteSelection() {\n    this.shadowRoot.querySelectorAll('.color-swatch').forEach(swatch => {\n      if (swatch.dataset.color.toLowerCase() === this._currentColor.toLowerCase()) {\n        swatch.classList.add('active');\n      } else {\n        swatch.classList.remove('active');\n      }\n    });\n  }\n\n  _resizeCanvas(w, h) {\n    // Save current content\n    const oldData = this._ctx.getImageData(0, 0, this._width, this._height);\n\n    this._width = w;\n    this._height = h;\n    this._logicalCanvas.width = w;\n    this._logicalCanvas.height = h;\n\n    // Restore content (will be clipped if smaller)\n    this._ctx.putImageData(oldData, 0, 0);\n\n    this._updateDisplaySize();\n    this._renderDisplay();\n\n    // Update info row\n    const infoRow = this.shadowRoot.querySelector('.info-row span:first-child');\n    if (infoRow) {\n      infoRow.textContent = `Tool: ${this._tool} | Grid: ${this._gridOn ? 'LED' : 'Flat'}`;\n    }\n  }\n\n  _clearCanvas() {\n    this._ctx.clearRect(0, 0, this._width, this._height);\n    this._renderDisplay();\n  }\n\n  _handleImport(file) {\n    const reader = new FileReader();\n    reader.onload = (ev) => {\n      const img = new Image();\n      img.onload = () => {\n        // Scale image to canvas size\n        this._ctx.clearRect(0, 0, this._width, this._height);\n        this._ctx.imageSmoothingEnabled = false;\n        this._ctx.drawImage(img, 0, 0, this._width, this._height);\n        this._renderDisplay();\n      };\n      img.src = ev.target.result;\n    };\n    reader.readAsDataURL(file);\n  }\n\n  async _sendToDevice() {\n    if (this._sending) return;\n\n    this._sending = true;\n    this.render();\n\n    try {\n      const imgData = this._ctx.getImageData(0, 0, this._width, this._height).data;\n      const pixels = [];\n\n      for (let y = 0; y < this._height; y++) {\n        for (let x = 0; x < this._width; x++) {\n          const idx = (y * this._width + x) * 4;\n          const r = imgData[idx];\n          const g = imgData[idx + 1];\n          const b = imgData[idx + 2];\n          const a = imgData[idx + 3];\n\n          // Only send non-transparent pixels\n          if (a > 0) {\n            pixels.push({\n              x,\n              y,\n              color: this._rgbToHex(r, g, b)\n            });\n          }\n        }\n      }\n\n      if (pixels.length > 0) {\n        // Call set_pixels service\n        await this.callService('ipixel_color', 'set_pixels', {\n          pixels\n        });\n      }\n    } catch (err) {\n      console.error('Failed to send pixels to device:', err);\n    } finally {\n      this._sending = false;\n      this.render();\n    }\n  }\n\n  _rgbToHex(r, g, b) {\n    return ((r << 16) | (g << 8) | b).toString(16).padStart(6, '0');\n  }\n\n  static getConfigElement() {\n    return document.createElement('ipixel-simple-editor');\n  }\n\n  static getStubConfig() {\n    return { entity: '' };\n  }\n\n  getCardSize() {\n    return 4;\n  }\n}\n", "/**\n * iPIXEL Card Editor\n * Shared configuration editor for all card types\n */\n\nexport class iPIXELSimpleEditor extends HTMLElement {\n  constructor() {\n    super();\n    this.attachShadow({ mode: 'open' });\n  }\n\n  setConfig(config) {\n    this._config = config;\n    this.render();\n  }\n\n  set hass(hass) {\n    this._hass = hass;\n    this.render();\n  }\n\n  render() {\n    if (!this._hass) return;\n    const entities = Object.keys(this._hass.states)\n      .filter(e => e.startsWith('text.') || e.startsWith('switch.'))\n      .sort();\n\n    this.shadowRoot.innerHTML = `\n      <style>\n        .row { margin-bottom: 12px; }\n        label { display: block; margin-bottom: 4px; font-weight: 500; font-size: 0.9em; }\n        select, input {\n          width: 100%;\n          padding: 8px;\n          border: 1px solid var(--divider-color, #ccc);\n          border-radius: 4px;\n          background: var(--card-background-color);\n          color: inherit;\n          box-sizing: border-box;\n        }\n      </style>\n      <div class=\"row\">\n        <label>Entity</label>\n        <select id=\"entity\">\n          <option value=\"\">Select entity</option>\n          ${entities.map(e => `\n            <option value=\"${e}\" ${this._config?.entity === e ? 'selected' : ''}>\n              ${this._hass.states[e]?.attributes?.friendly_name || e}\n            </option>\n          `).join('')}\n        </select>\n      </div>\n      <div class=\"row\">\n        <label>Name (optional)</label>\n        <input type=\"text\" id=\"name\" value=\"${this._config?.name || ''}\" placeholder=\"Display name\">\n      </div>`;\n\n    this.shadowRoot.querySelectorAll('select, input').forEach(el => {\n      el.addEventListener('change', () => this.fireConfig());\n    });\n  }\n\n  fireConfig() {\n    this.dispatchEvent(new CustomEvent('config-changed', {\n      detail: {\n        config: {\n          type: this._config?.type || 'custom:ipixel-display-card',\n          entity: this.shadowRoot.getElementById('entity')?.value,\n          name: this.shadowRoot.getElementById('name')?.value || undefined,\n        }\n      },\n      bubbles: true,\n      composed: true,\n    }));\n  }\n}\n", "/**\n * iPIXEL Cards for Home Assistant\n * Entry point - imports all modules and registers custom elements\n */\n\nimport { CARD_VERSION } from './version.js';\nimport { iPIXELDisplayCard } from './cards/display-card.js';\nimport { iPIXELControlsCard } from './cards/controls-card.js';\nimport { iPIXELTextCard } from './cards/text-card.js';\nimport { iPIXELPlaylistCard } from './cards/playlist-card.js';\nimport { iPIXELScheduleCard } from './cards/schedule-card.js';\nimport { iPIXELEditorCard } from './cards/editor-card.js';\nimport { iPIXELSimpleEditor } from './editor.js';\n\n// Initialize shared state\nimport './state.js';\n\n// Register custom elements\ncustomElements.define('ipixel-display-card', iPIXELDisplayCard);\ncustomElements.define('ipixel-controls-card', iPIXELControlsCard);\ncustomElements.define('ipixel-text-card', iPIXELTextCard);\ncustomElements.define('ipixel-playlist-card', iPIXELPlaylistCard);\ncustomElements.define('ipixel-schedule-card', iPIXELScheduleCard);\ncustomElements.define('ipixel-editor-card', iPIXELEditorCard);\ncustomElements.define('ipixel-simple-editor', iPIXELSimpleEditor);\n\n// Register with Home Assistant's custom card registry\nwindow.customCards = window.customCards || [];\n[\n  { type: 'ipixel-display-card', name: 'iPIXEL Display', description: 'LED matrix preview with power control' },\n  { type: 'ipixel-controls-card', name: 'iPIXEL Controls', description: 'Brightness, mode, and orientation controls' },\n  { type: 'ipixel-text-card', name: 'iPIXEL Text', description: 'Text input with effects and colors' },\n  { type: 'ipixel-playlist-card', name: 'iPIXEL Playlist', description: 'Playlist management' },\n  { type: 'ipixel-schedule-card', name: 'iPIXEL Schedule', description: 'Power schedule and time slots' },\n  { type: 'ipixel-editor-card', name: 'iPIXEL Pixel Editor', description: 'Draw custom pixel art and send to your LED matrix' },\n].forEach(card => window.customCards.push({\n  ...card,\n  preview: true,\n  documentationURL: 'https://github.com/cagcoach/ha-ipixel-color'\n}));\n\n// Log version\nconsole.info(\n  `%c iPIXEL Cards %c ${CARD_VERSION} `,\n  'background:#03a9f4;color:#fff;padding:2px 6px;border-radius:4px 0 0 4px;',\n  'background:#333;color:#fff;padding:2px 6px;border-radius:0 4px 4px 0;'\n);\n"],
  "mappings": ";;AAGO,MAAM,eAAe;;;ACErB,MAAM,iBAAN,cAA6B,YAAY;AAAA,IAC9C,cAAc;AACZ,YAAM;AACN,WAAK,aAAa,EAAE,MAAM,OAAO,CAAC;AAClC,WAAK,UAAU,CAAC;AAChB,WAAK,QAAQ;AAAA,IACf;AAAA,IAEA,IAAI,KAAK,MAAM;AACb,WAAK,QAAQ;AACb,WAAK,OAAO;AAAA,IACd;AAAA,IAEA,UAAU,QAAQ;AAChB,UAAI,CAAC,OAAO;AAAQ,cAAM,IAAI,MAAM,yBAAyB;AAC7D,WAAK,UAAU;AACf,WAAK,OAAO;AAAA,IACd;AAAA,IAEA,YAAY;AACV,UAAI,CAAC,KAAK,SAAS,CAAC,KAAK,QAAQ;AAAQ,eAAO;AAChD,aAAO,KAAK,MAAM,OAAO,KAAK,QAAQ,MAAM;AAAA,IAC9C;AAAA,IAEA,iBAAiB,QAAQ,SAAS,IAAI;AACpC,UAAI,CAAC,KAAK,SAAS,CAAC,KAAK,QAAQ;AAAQ,eAAO;AAGhD,YAAM,WAAW,KAAK,QAAQ,OAAO,QAAQ,YAAY,EAAE,EAAE,QAAQ,8BAA8B,EAAE;AAGrG,YAAM,UAAU,GAAG,MAAM,IAAI,QAAQ,GAAG,MAAM;AAC9C,UAAI,KAAK,MAAM,OAAO,OAAO;AAAG,eAAO,KAAK,MAAM,OAAO,OAAO;AAGhE,YAAM,UAAU,OAAO,KAAK,KAAK,MAAM,MAAM,EAAE,OAAO,QAAM;AAC1D,YAAI,CAAC,GAAG,WAAW,GAAG,MAAM,GAAG;AAAG,iBAAO;AACzC,cAAM,aAAa,GAAG,QAAQ,YAAY,EAAE;AAC5C,eAAO,WAAW,SAAS,QAAQ,KAAK,SAAS,SAAS,WAAW,QAAQ,QAAQ,EAAE,CAAC;AAAA,MAC1F,CAAC;AAGD,UAAI,QAAQ;AACV,cAAM,aAAa,QAAQ,KAAK,QAAM,GAAG,SAAS,MAAM,CAAC;AACzD,YAAI;AAAY,iBAAO,KAAK,MAAM,OAAO,UAAU;AAAA,MACrD,OAAO;AACL,cAAM,SAAS,QAAQ,KAAK,CAACA,IAAG,MAAMA,GAAE,SAAS,EAAE,MAAM;AACzD,YAAI,OAAO,SAAS;AAAG,iBAAO,KAAK,MAAM,OAAO,OAAO,CAAC,CAAC;AAAA,MAC3D;AAEA,aAAO,QAAQ,SAAS,IAAI,KAAK,MAAM,OAAO,QAAQ,CAAC,CAAC,IAAI;AAAA,IAC9D;AAAA,IAEA,MAAM,YAAY,QAAQ,SAAS,OAAO,CAAC,GAAG;AAC5C,UAAI,CAAC,KAAK;AAAO;AACjB,UAAI;AACF,cAAM,KAAK,MAAM,YAAY,QAAQ,SAAS,IAAI;AAAA,MACpD,SAAS,KAAK;AACZ,gBAAQ,MAAM,+BAA+B,MAAM,IAAI,OAAO,IAAI,GAAG;AAAA,MACvE;AAAA,IACF;AAAA,IAEA,gBAAgB;AACd,YAAM,cAAc,KAAK,iBAAiB,UAAU,QAAQ,KAAK,KAAK,OAAO,OAAO,sBAAsB;AAC1G,YAAM,eAAe,KAAK,iBAAiB,UAAU,SAAS,KAAK,KAAK,OAAO,OAAO,uBAAuB;AAC7G,UAAI,eAAe,cAAc;AAC/B,cAAM,IAAI,SAAS,YAAY,KAAK,GAAGC,KAAI,SAAS,aAAa,KAAK;AACtE,YAAI,CAAC,MAAM,CAAC,KAAK,CAAC,MAAMA,EAAC,KAAK,IAAI,KAAKA,KAAI;AAAG,iBAAO,CAAC,GAAGA,EAAC;AAAA,MAC5D;AACA,aAAO,CAAC,IAAI,EAAE;AAAA,IAChB;AAAA,IAEA,OAAO;AACL,aAAO,KAAK,iBAAiB,QAAQ,GAAG,UAAU;AAAA,IACpD;AAAA,IAEA,SAAS,KAAK;AACZ,YAAMC,KAAI,4CAA4C,KAAK,GAAG;AAC9D,aAAOA,KAAI,CAAC,SAASA,GAAE,CAAC,GAAG,EAAE,GAAG,SAASA,GAAE,CAAC,GAAG,EAAE,GAAG,SAASA,GAAE,CAAC,GAAG,EAAE,CAAC,IAAI,CAAC,KAAK,KAAK,GAAG;AAAA,IAC1F;AAAA,IAEA,SAAS;AAAA,IAA+B;AAAA,IACxC,cAAc;AAAE,aAAO;AAAA,IAAG;AAAA,EAC5B;;;ACrFO,MAAM,mBAAmB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;ACEzB,MAAM,YAAY;AAAA;AAAA,IAEvB,KAAK,CAAC,KAAK,IAAK,IAAK,IAAK,GAAI;AAAA,IAAG,KAAK,CAAC,KAAK,IAAK,IAAK,IAAK,EAAI;AAAA,IAAG,KAAK,CAAC,IAAK,IAAK,IAAK,IAAK,EAAI;AAAA,IAChG,KAAK,CAAC,KAAK,IAAK,IAAK,IAAK,EAAI;AAAA,IAAG,KAAK,CAAC,KAAK,IAAK,IAAK,IAAK,EAAI;AAAA,IAAG,KAAK,CAAC,KAAK,GAAK,GAAK,GAAK,CAAI;AAAA,IAChG,KAAK,CAAC,IAAK,IAAK,IAAK,IAAK,GAAI;AAAA,IAAG,KAAK,CAAC,KAAK,GAAK,GAAK,GAAK,GAAI;AAAA,IAAG,KAAK,CAAC,GAAK,IAAK,KAAK,IAAK,CAAI;AAAA,IAChG,KAAK,CAAC,IAAK,IAAK,IAAK,IAAK,CAAI;AAAA,IAAG,KAAK,CAAC,KAAK,GAAK,IAAK,IAAK,EAAI;AAAA,IAAG,KAAK,CAAC,KAAK,IAAK,IAAK,IAAK,EAAI;AAAA,IAChG,KAAK,CAAC,KAAK,GAAK,IAAK,GAAK,GAAI;AAAA,IAAG,KAAK,CAAC,KAAK,GAAK,GAAK,IAAK,GAAI;AAAA,IAAG,KAAK,CAAC,IAAK,IAAK,IAAK,IAAK,EAAI;AAAA,IAChG,KAAK,CAAC,KAAK,GAAK,GAAK,GAAK,CAAI;AAAA,IAAG,KAAK,CAAC,IAAK,IAAK,IAAK,IAAK,EAAI;AAAA,IAAG,KAAK,CAAC,KAAK,GAAK,IAAK,IAAK,EAAI;AAAA,IAChG,KAAK,CAAC,IAAK,IAAK,IAAK,IAAK,EAAI;AAAA,IAAG,KAAK,CAAC,GAAK,GAAK,KAAK,GAAK,CAAI;AAAA,IAAG,KAAK,CAAC,IAAK,IAAK,IAAK,IAAK,EAAI;AAAA,IAChG,KAAK,CAAC,IAAK,IAAK,IAAK,IAAK,EAAI;AAAA,IAAG,KAAK,CAAC,IAAK,IAAK,IAAK,IAAK,EAAI;AAAA,IAAG,KAAK,CAAC,IAAK,IAAK,GAAK,IAAK,EAAI;AAAA,IAChG,KAAK,CAAC,GAAK,GAAK,KAAK,GAAK,CAAI;AAAA,IAAG,KAAK,CAAC,IAAK,IAAK,IAAK,IAAK,EAAI;AAAA;AAAA,IAG/D,KAAK,CAAC,IAAK,IAAK,IAAK,IAAK,GAAI;AAAA,IAAG,KAAK,CAAC,KAAK,IAAK,IAAK,IAAK,EAAI;AAAA,IAAG,KAAK,CAAC,IAAK,IAAK,IAAK,IAAK,EAAI;AAAA,IAChG,KAAK,CAAC,IAAK,IAAK,IAAK,IAAK,GAAI;AAAA,IAAG,KAAK,CAAC,IAAK,IAAK,IAAK,IAAK,EAAI;AAAA,IAAG,KAAK,CAAC,GAAK,KAAK,GAAK,GAAK,CAAI;AAAA,IAChG,KAAK,CAAC,IAAK,IAAK,IAAK,IAAK,EAAI;AAAA,IAAG,KAAK,CAAC,KAAK,GAAK,GAAK,GAAK,GAAI;AAAA,IAAG,KAAK,CAAC,GAAK,IAAK,KAAK,IAAK,CAAI;AAAA,IAChG,KAAK,CAAC,IAAK,IAAK,IAAK,IAAK,CAAI;AAAA,IAAG,KAAK,CAAC,KAAK,IAAK,IAAK,IAAK,CAAI;AAAA,IAAG,KAAK,CAAC,GAAK,IAAK,KAAK,IAAK,CAAI;AAAA,IAChG,KAAK,CAAC,KAAK,GAAK,IAAK,GAAK,GAAI;AAAA,IAAG,KAAK,CAAC,KAAK,GAAK,GAAK,GAAK,GAAI;AAAA,IAAG,KAAK,CAAC,IAAK,IAAK,IAAK,IAAK,EAAI;AAAA,IAChG,KAAK,CAAC,KAAK,IAAK,IAAK,IAAK,CAAI;AAAA,IAAG,KAAK,CAAC,GAAK,IAAK,IAAK,IAAK,GAAI;AAAA,IAAG,KAAK,CAAC,KAAK,GAAK,GAAK,GAAK,CAAI;AAAA,IAChG,KAAK,CAAC,IAAK,IAAK,IAAK,IAAK,EAAI;AAAA,IAAG,KAAK,CAAC,GAAK,IAAK,IAAK,IAAK,EAAI;AAAA,IAAG,KAAK,CAAC,IAAK,IAAK,IAAK,IAAK,GAAI;AAAA,IAChG,KAAK,CAAC,IAAK,IAAK,IAAK,IAAK,EAAI;AAAA,IAAG,KAAK,CAAC,IAAK,IAAK,IAAK,IAAK,EAAI;AAAA,IAAG,KAAK,CAAC,IAAK,IAAK,IAAK,IAAK,EAAI;AAAA,IAChG,KAAK,CAAC,IAAK,IAAK,IAAK,IAAK,EAAI;AAAA,IAAG,KAAK,CAAC,IAAK,KAAK,IAAK,IAAK,EAAI;AAAA;AAAA,IAG/D,KAAK,CAAC,IAAK,IAAK,IAAK,IAAK,EAAI;AAAA,IAAG,KAAK,CAAC,GAAK,IAAK,KAAK,IAAK,CAAI;AAAA,IAAG,KAAK,CAAC,IAAK,IAAK,IAAK,IAAK,EAAI;AAAA,IAChG,KAAK,CAAC,IAAK,IAAK,IAAK,IAAK,EAAI;AAAA,IAAG,KAAK,CAAC,IAAK,IAAK,IAAK,KAAK,EAAI;AAAA,IAAG,KAAK,CAAC,IAAK,IAAK,IAAK,IAAK,EAAI;AAAA,IAChG,KAAK,CAAC,IAAK,IAAK,IAAK,IAAK,EAAI;AAAA,IAAG,KAAK,CAAC,GAAK,KAAK,GAAK,GAAK,CAAI;AAAA,IAAG,KAAK,CAAC,IAAK,IAAK,IAAK,IAAK,EAAI;AAAA,IAChG,KAAK,CAAC,GAAK,IAAK,IAAK,IAAK,EAAI;AAAA;AAAA,IAG9B,KAAK,CAAC,GAAK,GAAK,GAAK,GAAK,CAAI;AAAA,IAAG,KAAK,CAAC,GAAK,IAAK,IAAK,GAAK,CAAI;AAAA,IAAG,KAAK,CAAC,GAAK,KAAK,IAAK,GAAK,CAAI;AAAA,IAChG,KAAK,CAAC,GAAK,IAAK,IAAK,GAAK,CAAI;AAAA,IAAG,KAAK,CAAC,GAAK,KAAK,IAAK,GAAK,CAAI;AAAA,IAAG,KAAK,CAAC,GAAK,GAAK,IAAK,GAAK,CAAI;AAAA,IAChG,KAAK,CAAC,GAAK,GAAK,IAAK,GAAK,CAAI;AAAA,IAAG,KAAK,CAAC,GAAK,GAAK,GAAK,GAAK,CAAI;AAAA,IAAG,KAAK,CAAC,GAAK,GAAK,IAAK,GAAK,CAAI;AAAA,IAChG,KAAK,CAAC,IAAK,IAAK,IAAK,IAAK,EAAI;AAAA,IAAG,KAAK,CAAC,IAAK,IAAK,IAAK,IAAK,EAAI;AAAA,IAAG,KAAK,CAAC,IAAK,IAAK,GAAK,GAAK,CAAI;AAAA,IAChG,MAAM,CAAC,GAAK,GAAK,GAAK,IAAK,EAAI;AAAA,IAAG,KAAK,CAAC,GAAK,IAAK,IAAK,IAAK,CAAI;AAAA,IAAG,KAAK,CAAC,GAAK,IAAK,IAAK,IAAK,CAAI;AAAA,IACjG,KAAK,CAAC,GAAK,KAAK,IAAK,IAAK,CAAI;AAAA,IAAG,KAAK,CAAC,GAAK,IAAK,IAAK,KAAK,CAAI;AAAA,IAAG,KAAK,CAAC,GAAK,IAAK,IAAK,IAAK,CAAI;AAAA,IAChG,KAAK,CAAC,GAAK,IAAK,IAAK,IAAK,CAAI;AAAA,IAAG,KAAK,CAAC,IAAK,GAAK,IAAK,GAAK,EAAI;AAAA,IAAG,KAAK,CAAC,IAAK,KAAK,IAAK,KAAK,EAAI;AAAA,IAChG,KAAK,CAAC,IAAK,IAAK,IAAK,IAAK,EAAI;AAAA,IAAG,KAAK,CAAC,IAAK,IAAK,IAAK,IAAK,EAAI;AAAA,IAAG,KAAK,CAAC,IAAK,IAAK,GAAK,KAAK,EAAI;AAAA,IAChG,KAAK,CAAC,IAAK,IAAK,KAAK,IAAK,EAAI;AAAA,IAAG,KAAK,CAAC,GAAK,GAAK,GAAK,GAAK,CAAI;AAAA,IAAG,KAAK,CAAC,GAAK,GAAK,GAAK,GAAK,CAAI;AAAA,IAChG,KAAK,CAAC,GAAK,GAAK,GAAK,GAAK,CAAI;AAAA,IAAG,KAAK,CAAC,GAAK,GAAK,GAAK,GAAK,CAAI;AAAA,IAAG,KAAK,CAAC,GAAK,GAAK,GAAK,IAAK,CAAI;AAAA,EAClG;AAWO,WAAS,aAAa,MAAM,OAAO,QAAQ,UAAU,WAAW,UAAU,QAAQ;AACvF,UAAM,SAAS,CAAC;AAChB,UAAM,YAAY;AAClB,UAAM,aAAa;AACnB,UAAM,SAAS,KAAK,OAAO,SAAS,cAAc,CAAC;AAGnD,aAAS,IAAI,GAAG,IAAI,QAAQ,KAAK;AAC/B,eAAS,IAAI,GAAG,IAAI,OAAO,KAAK;AAC9B,eAAO,KAAK,OAAO;AAAA,MACrB;AAAA,IACF;AAGA,UAAM,YAAY,KAAK,SAAS,YAAY;AAC5C,UAAM,SAAS,KAAK,IAAI,GAAG,KAAK,OAAO,QAAQ,aAAa,CAAC,CAAC;AAG9D,QAAI,UAAU;AACd,eAAW,QAAQ,MAAM;AACvB,YAAM,WAAW,UAAU,IAAI,KAAK,UAAU,GAAG;AACjD,eAAS,MAAM,GAAG,MAAM,GAAG,OAAO;AAChC,iBAAS,MAAM,GAAG,MAAM,GAAG,OAAO;AAChC,gBAAM,UAAW,SAAS,GAAG,KAAK,MAAO;AACzC,gBAAM,KAAK,UAAU;AACrB,gBAAM,KAAK,SAAS;AACpB,cAAI,MAAM,KAAK,KAAK,SAAS,KAAK,UAAU,MAAM,GAAG;AACnD,mBAAO,KAAK,QAAQ,EAAE,IAAI,UAAU,UAAU;AAAA,UAChD;AAAA,QACF;AAAA,MACF;AACA,iBAAW;AAAA,IACb;AACA,WAAO;AAAA,EACT;AAYO,WAAS,mBAAmB,MAAM,cAAc,QAAQ,UAAU,WAAW,UAAU,QAAQ;AACpG,UAAM,YAAY;AAClB,UAAM,aAAa;AACnB,UAAM,SAAS,KAAK,OAAO,SAAS,cAAc,CAAC;AAGnD,UAAM,iBAAiB,KAAK,SAAS;AAGrC,UAAM,gBAAgB,eAAe,iBAAiB;AAGtD,UAAM,SAAS,CAAC;AAChB,aAAS,IAAI,GAAG,IAAI,QAAQ,KAAK;AAC/B,eAAS,IAAI,GAAG,IAAI,eAAe,KAAK;AACtC,eAAO,KAAK,OAAO;AAAA,MACrB;AAAA,IACF;AAGA,QAAI,UAAU;AACd,eAAW,QAAQ,MAAM;AACvB,YAAM,WAAW,UAAU,IAAI,KAAK,UAAU,GAAG;AACjD,eAAS,MAAM,GAAG,MAAM,GAAG,OAAO;AAChC,iBAAS,MAAM,GAAG,MAAM,GAAG,OAAO;AAChC,gBAAM,UAAW,SAAS,GAAG,KAAK,MAAO;AACzC,gBAAM,KAAK,UAAU;AACrB,gBAAM,KAAK,SAAS;AACpB,cAAI,MAAM,KAAK,KAAK,iBAAiB,KAAK,UAAU,MAAM,GAAG;AAC3D,mBAAO,KAAK,gBAAgB,EAAE,IAAI,UAAU,UAAU;AAAA,UACxD;AAAA,QACF;AAAA,MACF;AACA,iBAAW;AAAA,IACb;AAEA,WAAO,EAAE,QAAQ,OAAO,cAAc;AAAA,EACxC;;;ACpIA,MAAM,eAAe;AAAA,IACnB,gBAAgB;AAAA,MACd,IAAI,EAAE,WAAW,IAAI,QAAQ,CAAC,GAAG,CAAC,GAAG,iBAAiB,IAAI,WAAW,KAAK;AAAA,MAC1E,IAAI,EAAE,WAAW,IAAI,QAAQ,CAAC,GAAG,CAAC,GAAG,iBAAiB,IAAI,WAAW,KAAK;AAAA,MAC1E,IAAI,EAAE,WAAW,IAAI,QAAQ,CAAC,IAAI,CAAC,GAAG,iBAAiB,IAAI,WAAW,MAAM;AAAA,IAC9E;AAAA,IACA,UAAU;AAAA,MACR,IAAI,EAAE,WAAW,IAAI,QAAQ,CAAC,GAAG,EAAE,GAAG,iBAAiB,IAAI,WAAW,MAAM;AAAA,MAC5E,IAAI,EAAE,WAAW,IAAI,QAAQ,CAAC,GAAG,CAAC,GAAG,iBAAiB,IAAI,WAAW,MAAM;AAAA,MAC3E,IAAI,EAAE,WAAW,IAAI,QAAQ,CAAC,GAAG,CAAC,GAAG,iBAAiB,IAAI,WAAW,MAAM;AAAA,IAC7E;AAAA,EACF;AAGA,MAAM,gBAAgB,CAAC;AACvB,MAAM,mBAAmB,CAAC;AAM1B,WAAS,WAAW,UAAU;AAE5B,UAAM,kBAAkB,OAAO,OAAO,mBAAmB,eACjC,OAAO,SAAS,SAAS,SAAS,WAAW,KAC7C,OAAO,SAAS,SAAS,SAAS,YAAY,KAC9C,SAAS,cAAc,gBAAgB,MAAM;AAErE,QAAI,iBAAiB;AAEnB,aAAO,iCAAiC,QAAQ;AAAA,IAClD;AAIA,UAAM,WAAW,OAAO,SAAS,SAAS,UAAU,GAAG,OAAO,SAAS,SAAS,YAAY,GAAG,IAAI,CAAC;AACpG,WAAO,GAAG,QAAQ,SAAS,QAAQ;AAAA,EACrC;AAOA,iBAAsB,SAAS,UAAU;AAEvC,QAAI,cAAc,QAAQ,MAAM;AAAM,aAAO;AAC7C,QAAI,cAAc,QAAQ,MAAM;AAAO,aAAO;AAG9C,QAAI,iBAAiB,QAAQ;AAAG,aAAO,iBAAiB,QAAQ;AAGhE,qBAAiB,QAAQ,KAAK,YAAY;AACxC,YAAM,UAAU,WAAW,QAAQ;AAEnC,UAAI;AACF,cAAM,OAAO,IAAI,SAAS,UAAU,OAAO,OAAO,GAAG;AACrD,cAAM,aAAa,MAAM,KAAK,KAAK;AACnC,iBAAS,MAAM,IAAI,UAAU;AAC7B,sBAAc,QAAQ,IAAI;AAC1B,gBAAQ,IAAI,gBAAgB,QAAQ,sBAAsB;AAC1D,eAAO;AAAA,MACT,SAASC,IAAG;AACV,gBAAQ,KAAK,+BAA+B,QAAQ,KAAKA,EAAC;AAC1D,sBAAc,QAAQ,IAAI;AAC1B,eAAO;AAAA,MACT;AAAA,IACF,GAAG;AAEH,WAAO,iBAAiB,QAAQ;AAAA,EAClC;AAOO,WAAS,aAAa,UAAU;AACrC,WAAO,cAAc,QAAQ,MAAM;AAAA,EACrC;AAOA,WAAS,aAAa,QAAQ;AAC5B,QAAI,UAAU;AAAI,aAAO;AACzB,QAAI,UAAU;AAAI,aAAO;AACzB,WAAO;AAAA,EACT;AAOA,WAAS,SAAS,KAAK;AACrB,UAAM,SAAS,4CAA4C,KAAK,GAAG;AACnE,WAAO,SAAS;AAAA,MACd,GAAG,SAAS,OAAO,CAAC,GAAG,EAAE;AAAA,MACzB,GAAG,SAAS,OAAO,CAAC,GAAG,EAAE;AAAA,MACzB,GAAG,SAAS,OAAO,CAAC,GAAG,EAAE;AAAA,IAC3B,IAAI,EAAE,GAAG,GAAG,GAAG,GAAG,GAAG,EAAE;AAAA,EACzB;AAYO,WAAS,mBAAmB,MAAM,OAAO,QAAQ,UAAU,WAAW,UAAU,QAAQ,WAAW,gBAAgB;AAExH,UAAM,cAAc,aAAa,QAAQ;AACzC,QAAI,CAAC,aAAa;AAChB,cAAQ,KAAK,yBAAyB,QAAQ,EAAE;AAChD,aAAO;AAAA,IACT;AAGA,QAAI,CAAC,aAAa,QAAQ,GAAG;AAE3B,eAAS,QAAQ;AACjB,aAAO;AAAA,IACT;AAGA,UAAM,YAAY,aAAa,MAAM;AACrC,UAAM,UAAU,YAAY,SAAS;AAGrC,UAAM,SAAS,SAAS,cAAc,QAAQ;AAC9C,WAAO,QAAQ;AACf,WAAO,SAAS;AAChB,UAAM,MAAM,OAAO,WAAW,IAAI;AAGlC,QAAI,wBAAwB;AAG5B,QAAI,YAAY;AAChB,QAAI,SAAS,GAAG,GAAG,OAAO,MAAM;AAGhC,QAAI,CAAC,QAAQ,KAAK,KAAK,MAAM,IAAI;AAC/B,YAAMC,UAAS,CAAC;AAChB,eAASC,KAAI,GAAGA,KAAI,QAAQ,QAAQA,MAAK;AACvC,QAAAD,QAAO,KAAK,OAAO;AAAA,MACrB;AACA,aAAOA;AAAA,IACT;AAGA,QAAI,OAAO,GAAG,QAAQ,SAAS,OAAO,QAAQ;AAC9C,QAAI,YAAY;AAChB,QAAI,eAAe;AAGnB,UAAM,cAAc,IAAI,YAAY,IAAI;AACxC,UAAM,YAAY,YAAY;AAG9B,UAAM,IAAI,KAAK,OAAO,QAAQ,aAAa,CAAC,IAAI,QAAQ,OAAO,CAAC;AAChE,UAAM,IAAI,KAAK,OAAO,SAAS,QAAQ,aAAa,CAAC,IAAI,QAAQ,OAAO,CAAC;AAGzE,QAAI,SAAS,MAAM,GAAG,CAAC;AAGvB,UAAM,YAAY,IAAI,aAAa,GAAG,GAAG,OAAO,MAAM;AACtD,UAAM,SAAS,CAAC;AAGhB,UAAM,KAAK,SAAS,OAAO;AAC3B,UAAM,KAAK,SAAS,OAAO;AAE3B,aAASC,KAAI,GAAGA,KAAI,UAAU,KAAK,QAAQA,MAAK,GAAG;AACjD,YAAMC,KAAI,UAAU,KAAKD,EAAC;AAC1B,YAAM,IAAI,UAAU,KAAKA,KAAI,CAAC;AAC9B,YAAM,IAAI,UAAU,KAAKA,KAAI,CAAC;AAI9B,YAAM,QAAQC,KAAI,IAAI,KAAK;AAE3B,UAAI,QAAQ,QAAQ,iBAAiB;AACnC,eAAO,KAAK,OAAO;AAAA,MACrB,OAAO;AACL,eAAO,KAAK,OAAO;AAAA,MACrB;AAAA,IACF;AAEA,WAAO;AAAA,EACT;AAYO,WAAS,yBAAyB,MAAM,cAAc,QAAQ,UAAU,WAAW,UAAU,QAAQ,WAAW,gBAAgB;AAErI,UAAM,cAAc,aAAa,QAAQ;AACzC,QAAI,CAAC,aAAa;AAChB,aAAO;AAAA,IACT;AAGA,QAAI,CAAC,aAAa,QAAQ,GAAG;AAC3B,eAAS,QAAQ;AACjB,aAAO;AAAA,IACT;AAGA,UAAM,YAAY,aAAa,MAAM;AACrC,UAAM,UAAU,YAAY,SAAS;AAGrC,UAAM,aAAa,SAAS,cAAc,QAAQ;AAClD,UAAM,UAAU,WAAW,WAAW,IAAI;AAC1C,YAAQ,OAAO,GAAG,QAAQ,SAAS,OAAO,QAAQ;AAClD,UAAM,YAAY,KAAK,KAAK,QAAQ,YAAY,IAAI,EAAE,KAAK;AAG3D,UAAM,gBAAgB,eAAe,YAAY;AAGjD,UAAM,SAAS,SAAS,cAAc,QAAQ;AAC9C,WAAO,QAAQ;AACf,WAAO,SAAS;AAChB,UAAM,MAAM,OAAO,WAAW,IAAI;AAClC,QAAI,wBAAwB;AAG5B,QAAI,YAAY;AAChB,QAAI,SAAS,GAAG,GAAG,eAAe,MAAM;AAGxC,QAAI,CAAC,QAAQ,KAAK,KAAK,MAAM,IAAI;AAC/B,YAAMF,UAAS,CAAC;AAChB,eAASC,KAAI,GAAGA,KAAI,gBAAgB,QAAQA,MAAK;AAC/C,QAAAD,QAAO,KAAK,OAAO;AAAA,MACrB;AACA,aAAO,EAAE,QAAAA,SAAQ,OAAO,cAAc;AAAA,IACxC;AAGA,QAAI,OAAO,GAAG,QAAQ,SAAS,OAAO,QAAQ;AAC9C,QAAI,YAAY;AAChB,QAAI,eAAe;AAGnB,UAAM,IAAI,eAAe,QAAQ,OAAO,CAAC;AACzC,UAAM,IAAI,KAAK,OAAO,SAAS,QAAQ,aAAa,CAAC,IAAI,QAAQ,OAAO,CAAC;AACzE,QAAI,SAAS,MAAM,GAAG,CAAC;AAGvB,UAAM,YAAY,IAAI,aAAa,GAAG,GAAG,eAAe,MAAM;AAC9D,UAAM,SAAS,CAAC;AAEhB,aAASC,KAAI,GAAGA,KAAI,UAAU,KAAK,QAAQA,MAAK,GAAG;AACjD,YAAMC,KAAI,UAAU,KAAKD,EAAC;AAC1B,YAAM,IAAI,UAAU,KAAKA,KAAI,CAAC;AAC9B,YAAM,IAAI,UAAU,KAAKA,KAAI,CAAC;AAE9B,YAAM,QAAQC,KAAI,IAAI,KAAK;AAE3B,UAAI,QAAQ,QAAQ,iBAAiB;AACnC,eAAO,KAAK,OAAO;AAAA,MACrB,OAAO;AACL,eAAO,KAAK,OAAO;AAAA,MACrB;AAAA,IACF;AAEA,WAAO,EAAE,QAAQ,OAAO,cAAc;AAAA,EACxC;;;AC3RA,MAAI,cAAY,SAASC,IAAEC,IAAEC,IAAEC,IAAE;AAAC,WAAO,KAAID,OAAIA,KAAE,UAAW,SAASE,IAAEC,IAAE;AAAC,eAAS,EAAEL,IAAE;AAAC,YAAG;AAAC,UAAAM,GAAEH,GAAE,KAAKH,EAAC,CAAC;AAAA,QAAC,SAAOA,IAAE;AAAC,UAAAK,GAAEL,EAAC;AAAA,QAAC;AAAA,MAAC;AAAC,eAAS,EAAEA,IAAE;AAAC,YAAG;AAAC,UAAAM,GAAEH,GAAE,MAAMH,EAAC,CAAC;AAAA,QAAC,SAAOA,IAAE;AAAC,UAAAK,GAAEL,EAAC;AAAA,QAAC;AAAA,MAAC;AAAC,eAASM,GAAEN,IAAE;AAAC,YAAIC;AAAE,QAAAD,GAAE,OAAKI,GAAEJ,GAAE,KAAK,KAAGC,KAAED,GAAE,OAAMC,cAAaC,KAAED,KAAE,IAAIC,GAAG,SAASF,IAAE;AAAC,UAAAA,GAAEC,EAAC;AAAA,QAAC,CAAE,GAAG,KAAK,GAAE,CAAC;AAAA,MAAC;AAAC,MAAAK,IAAGH,KAAEA,GAAE,MAAMH,IAAEC,MAAG,CAAC,CAAC,GAAG,KAAK,CAAC;AAAA,IAAC,CAAE;AAAA,EAAC;AAAlT,MAAoT,cAAY,SAASD,IAAE;AAAC,WAAO,gBAAgB,eAAa,KAAK,IAAEA,IAAE,QAAM,IAAI,YAAYA,EAAC;AAAA,EAAC;AAAjZ,MAAmZ,cAAY,SAASA,IAAEE,IAAEC,IAAE;AAAC,QAAG,CAAC,OAAO;AAAc,YAAM,IAAI,UAAU,sCAAsC;AAAE,QAAIC,IAAEC,KAAEF,GAAE,MAAMH,IAAEE,MAAG,CAAC,CAAC,GAAE,IAAE,CAAC;AAAE,WAAOE,KAAE,CAAC,GAAE,EAAE,MAAM,GAAE,EAAE,OAAO,GAAE,EAAE,QAAQ,GAAEA,GAAE,OAAO,aAAa,IAAE,WAAU;AAAC,aAAO;AAAA,IAAI,GAAEA;AAAE,aAAS,EAAEJ,IAAE;AAAC,MAAAK,GAAEL,EAAC,MAAII,GAAEJ,EAAC,IAAE,SAASC,IAAE;AAAC,eAAO,IAAI,QAAS,SAASC,IAAEC,IAAE;AAAC,YAAE,KAAK,CAACH,IAAEC,IAAEC,IAAEC,EAAC,CAAC,IAAE,KAAGG,GAAEN,IAAEC,EAAC;AAAA,QAAC,CAAE;AAAA,MAAC;AAAA,IAAE;AAAC,aAASK,GAAEN,IAAEE,IAAE;AAAC,UAAG;AAAC,SAACC,KAAEE,GAAEL,EAAC,EAAEE,EAAC,GAAG,iBAAiB,cAAY,QAAQ,QAAQC,GAAE,MAAM,CAAC,EAAE,KAAKI,IAAEC,EAAC,IAAE,EAAE,EAAE,CAAC,EAAE,CAAC,GAAEL,EAAC;AAAA,MAAC,SAAOH,IAAE;AAAC,UAAE,EAAE,CAAC,EAAE,CAAC,GAAEA,EAAC;AAAA,MAAC;AAAC,UAAIG;AAAA,IAAC;AAAC,aAASI,GAAEP,IAAE;AAAC,MAAAM,GAAE,QAAON,EAAC;AAAA,IAAC;AAAC,aAASQ,GAAER,IAAE;AAAC,MAAAM,GAAE,SAAQN,EAAC;AAAA,IAAC;AAAC,aAAS,EAAEA,IAAEC,IAAE;AAAC,MAAAD,GAAEC,EAAC,GAAE,EAAE,MAAM,GAAE,EAAE,UAAQK,GAAE,EAAE,CAAC,EAAE,CAAC,GAAE,EAAE,CAAC,EAAE,CAAC,CAAC;AAAA,IAAC;AAAA,EAAC;AAEt+B,WAAS,WAAWH,IAAE,EAAC,sBAAqBC,KAAE,MAAG,UAASC,KAAE,SAAQ,WAAU,IAAE,SAAQ,IAAE,CAAC,GAAE;AAAC,WAAO,YAAY,MAAK,WAAW,aAAW;AAAC,YAAMH,KAAE,MAAM,aAAa,CAAAD,OAAG,YAAY,QAAO,QAAO,QAAQ,aAAW;AAAC,cAAMD,KAAE,MAAM,MAAMC,EAAC;AAAE,YAAG,SAAOD,GAAE;AAAK,gBAAM,IAAI,MAAM,kBAAkB;AAAE,eAAOA,GAAE,KAAK,UAAU;AAAA,MAAC,CAAE,GAAGG,EAAC,CAAC;AAAE,UAAG,EAAC,OAAM,GAAE,MAAKG,GAAC,IAAE,MAAM,YAAYJ,GAAE,KAAK,CAAC;AAAE,YAAMK,KAAE,IAAI,YAAYF,EAAC;AAAE,UAAIG,IAAE,IAAE,IAAED,GAAE,OAAO,CAAC,IAAE;AAAG,UAAG,YAAU,OAAO,GAAE;AAAC,YAAG,OAAK;AAAE,gBAAM,IAAI,MAAM,mCAAmC;AAAE,QAAAC,KAAE,IAAI,OAAO,EAAE,QAAQ,yBAAwB,MAAM,GAAE,GAAG;AAAA,MAAC;AAAM,QAAAA,KAAE,UAAK,IAAI,KAAK,EAAE,KAAK,IAAE,IAAI,OAAO,EAAE,QAAO,EAAE,QAAM,GAAG,IAAE;AAAE,UAAI,IAAE;AAAE,iBAAO;AAAC,cAAMR,KAAEQ,GAAE,KAAK,CAAC;AAAE,YAAG,SAAOR;AAAE,gBAAM,MAAM,YAAY,EAAE,UAAU,GAAEA,GAAE,KAAK,CAAC,GAAE,IAAEQ,GAAE;AAAA,aAAc;AAAC,cAAG,SAAKF;AAAE;AAAM,gBAAMN,KAAE,EAAE,UAAU,CAAC;AAAE,WAAC,EAAC,OAAM,GAAE,MAAKM,GAAC,IAAE,MAAM,YAAYJ,GAAE,KAAK,CAAC,IAAG,IAAEF,MAAG,IAAEO,GAAE,OAAO,CAAC,IAAE,KAAI,IAAE;AAAA,QAAC;AAAA,MAAC;AAAC,OAACH,MAAG,IAAE,EAAE,YAAU,MAAM,MAAM,YAAY,EAAE,UAAU,CAAC,CAAC;AAAA,IAAE,CAAE;AAAA,EAAC;AAG95B,MAAI,IAAE,SAASF,IAAEF,IAAEC,IAAEE,IAAE;AAAC,WAAO,KAAIF,OAAIA,KAAE,UAAW,SAASI,IAAEE,IAAE;AAAC,eAASC,GAAEN,IAAE;AAAC,YAAG;AAAC,UAAAI,GAAEH,GAAE,KAAKD,EAAC,CAAC;AAAA,QAAC,SAAOA,IAAE;AAAC,UAAAK,GAAEL,EAAC;AAAA,QAAC;AAAA,MAAC;AAAC,eAASE,GAAEF,IAAE;AAAC,YAAG;AAAC,UAAAI,GAAEH,GAAE,MAAMD,EAAC,CAAC;AAAA,QAAC,SAAOA,IAAE;AAAC,UAAAK,GAAEL,EAAC;AAAA,QAAC;AAAA,MAAC;AAAC,eAASI,GAAEJ,IAAE;AAAC,YAAIF;AAAE,QAAAE,GAAE,OAAKG,GAAEH,GAAE,KAAK,KAAGF,KAAEE,GAAE,OAAMF,cAAaC,KAAED,KAAE,IAAIC,GAAG,SAASC,IAAE;AAAC,UAAAA,GAAEF,EAAC;AAAA,QAAC,CAAE,GAAG,KAAKQ,IAAEJ,EAAC;AAAA,MAAC;AAAC,MAAAE,IAAGH,KAAEA,GAAE,MAAMD,IAAEF,MAAG,CAAC,CAAC,GAAG,KAAK,CAAC;AAAA,IAAC,CAAE;AAAA,EAAC;AAAxS,MAA0S,IAAE,SAASE,IAAE;AAAC,QAAG,CAAC,OAAO;AAAc,YAAM,IAAI,UAAU,sCAAsC;AAAE,QAAIF,IAAEC,KAAEC,GAAE,OAAO,aAAa;AAAE,WAAOD,KAAEA,GAAE,KAAKC,EAAC,KAAGA,KAAE,cAAY,OAAO,WAAS,SAASA,EAAC,IAAEA,GAAE,OAAO,QAAQ,EAAE,GAAEF,KAAE,CAAC,GAAEG,GAAE,MAAM,GAAEA,GAAE,OAAO,GAAEA,GAAE,QAAQ,GAAEH,GAAE,OAAO,aAAa,IAAE,WAAU;AAAC,aAAO;AAAA,IAAI,GAAEA;AAAG,aAASG,GAAEF,IAAE;AAAC,MAAAD,GAAEC,EAAC,IAAEC,GAAED,EAAC,KAAG,SAASD,IAAE;AAAC,eAAO,IAAI,QAAS,SAASG,IAAEE,IAAE;AAAC,WAAC,SAASH,IAAEF,IAAEC,IAAEE,IAAE;AAAC,oBAAQ,QAAQA,EAAC,EAAE,KAAM,SAASH,IAAE;AAAC,cAAAE,GAAE,EAAC,OAAMF,IAAE,MAAKC,GAAC,CAAC;AAAA,YAAC,GAAGD,EAAC;AAAA,UAAC,GAAGG,IAAEE,KAAGL,KAAEE,GAAED,EAAC,EAAED,EAAC,GAAG,MAAKA,GAAE,KAAK;AAAA,QAAC,CAAE;AAAA,MAAC;AAAA,IAAC;AAAA,EAAC;AAAE,MAAM,IAAE;AAAR,MAAiB,IAAE,EAAC,WAAU,SAAQ,WAAU,MAAK,KAAI,GAAE,KAAI,GAAE,QAAO,GAAE,QAAO,GAAE,MAAK,GAAE,MAAK,GAAE,MAAK,GAAE,MAAK,GAAE,MAAK,GAAE,MAAK,GAAE,MAAK,GAAE,MAAK,GAAE,UAAS,GAAE,UAAS,GAAE,SAAQ,CAAC,EAAC;AAA3K,MAA6K,IAAE,CAAC,aAAY,aAAY,OAAM,OAAM,UAAS,UAAS,QAAO,QAAO,QAAO,QAAO,QAAO,QAAO,QAAO,QAAO,YAAW,YAAW,SAAS;AAA7T,MAA+T,IAAE,EAAC,IAAG,QAAO,IAAG,QAAO,IAAG,QAAO,IAAG,QAAO,MAAK,QAAO,MAAK,QAAO,MAAK,QAAO,MAAK,QAAO,MAAK,QAAO,MAAK,QAAO,MAAK,QAAO,MAAK,OAAM;AAAzc,MAA2c,IAAE,EAAC,IAAG,GAAE,IAAG,GAAE,IAAG,GAAE,IAAG,GAAE;AAAE,MAAM,IAAN,MAAO;AAAA,IAAC,cAAa;AAAC,WAAK,UAAQ,QAAO,KAAK,YAAU,CAAC,GAAE,KAAK,QAAM,CAAC,GAAE,KAAK,SAAO,oBAAI,OAAI,KAAK,yBAAuB,MAAK,KAAK,sBAAoB,MAAK,KAAK,kBAAgB;AAAA,IAAI;AAAA,IAAC,eAAeC,IAAE;AAAC,UAAIE,IAAEE;AAAE,aAAO,EAAE,MAAK,QAAO,QAAQ,aAAW;AAAC,YAAG;AAAC,eAAK,MAAIJ,IAAE,MAAM,KAAK,gBAAgB;AAAA,QAAC,UAAC;AAAQ,cAAG,eAAa,OAAO,QAAM,WAAS,KAAK;AAAI,gBAAG;AAAC,uBAAQC,IAAEK,KAAE,EAAE,KAAK,GAAG,GAAE,EAAEL,KAAE,MAAMK,GAAE,KAAK,GAAG,QAAM;AAAC,gBAAAL,GAAE;AAAA,cAAK;AAAA,YAAC,SAAOA,IAAE;AAAC,cAAAC,KAAE,EAAC,OAAMD,GAAC;AAAA,YAAC,UAAC;AAAQ,kBAAG;AAAC,gBAAAA,MAAG,CAACA,GAAE,SAAOG,KAAEE,GAAE,YAAU,MAAMF,GAAE,KAAKE,EAAC;AAAA,cAAE,UAAC;AAAQ,oBAAGJ;AAAE,wBAAMA,GAAE;AAAA,cAAK;AAAA,YAAC;AAAA,QAAC;AAAC,eAAO;AAAA,MAAI,CAAE;AAAA,IAAC;AAAA,IAAC,kBAAiB;AAAC,UAAIH,IAAEG;AAAE,aAAO,EAAE,MAAK,QAAO,QAAQ,aAAW;AAAC,mBAAO;AAAC,gBAAMD,KAAE,UAAQC,KAAE,MAAM,UAAQH,KAAE,KAAK,QAAM,WAASA,KAAE,SAAOA,GAAE,KAAK,MAAI,WAASG,KAAE,SAAOA,GAAE,OAAME,KAAEH,GAAE,MAAM,SAAQ,CAAC,GAAEK,KAAEF,GAAE;AAAO,cAAIG;AAAE,cAAG,MAAID,IAAE;AAAC,kBAAMP,KAAEK,GAAE,CAAC,GAAEF,KAAEE,GAAE,CAAC,EAAE,KAAK;AAAE,oBAAOL,IAAE;AAAA,cAAC,KAAI;AAAY,qBAAK,UAAU,aAAW,WAAWG,EAAC;AAAE;AAAA,cAAM,KAAI;AAAO,qBAAK,UAAU,WAASA;AAAE;AAAA,cAAM,KAAI;AAAO,gBAAAK,KAAEL,GAAE,MAAM,GAAG,GAAE,KAAK,UAAU,YAAU,SAASK,GAAE,CAAC,GAAE,EAAE,GAAE,KAAK,UAAU,OAAK,SAASA,GAAE,CAAC,GAAE,EAAE,GAAE,KAAK,UAAU,OAAK,SAASA,GAAE,CAAC,GAAE,EAAE;AAAE;AAAA,cAAM,KAAI;AAAkB,gBAAAA,KAAEL,GAAE,MAAM,GAAG,GAAE,KAAK,UAAU,OAAK,SAASK,GAAE,CAAC,GAAE,EAAE,GAAE,KAAK,UAAU,OAAK,SAASA,GAAE,CAAC,GAAE,EAAE,GAAE,KAAK,UAAU,UAAQ,SAASA,GAAE,CAAC,GAAE,EAAE,GAAE,KAAK,UAAU,UAAQ,SAASA,GAAE,CAAC,GAAE,EAAE;AAAE;AAAA,cAAM,KAAI;AAAkB,uBAAO,KAAK,sBAAsB,GAAE,MAAK,MAAM,KAAK,cAAc;AAAA,cAAG,KAAI;AAAU,6BAAY,KAAK,aAAW,MAAM,QAAQ,KAAK,UAAU,OAAO,MAAI,KAAK,UAAU,UAAQ,CAAC,IAAG,KAAK,UAAU,QAAQ,KAAKL,GAAE,QAAQ,kCAAiC,EAAE,CAAC;AAAE;AAAA,cAAM,KAAI;AAAS,gBAAAK,KAAEL,GAAE,MAAM,GAAG,GAAE,KAAK,UAAU,OAAK,SAASK,GAAE,CAAC,GAAE,EAAE,GAAE,KAAK,UAAU,OAAK,SAASA,GAAE,CAAC,GAAE,EAAE;AAAE;AAAA,cAAM,KAAI;AAAS,gBAAAA,KAAEL,GAAE,MAAM,GAAG,GAAE,KAAK,UAAU,OAAK,SAASK,GAAE,CAAC,GAAE,EAAE,GAAE,KAAK,UAAU,OAAK,SAASA,GAAE,CAAC,GAAE,EAAE;AAAE;AAAA,cAAM,KAAI;AAAU,gBAAAA,KAAEL,GAAE,MAAM,GAAG,GAAE,KAAK,UAAU,OAAK,SAASK,GAAE,CAAC,GAAE,EAAE,GAAE,KAAK,UAAU,OAAK,SAASA,GAAE,CAAC,GAAE,EAAE;AAAE;AAAA,cAAM,KAAI;AAAU,gBAAAA,KAAEL,GAAE,MAAM,GAAG,GAAE,KAAK,UAAU,OAAK,SAASK,GAAE,CAAC,GAAE,EAAE,GAAE,KAAK,UAAU,OAAK,SAASA,GAAE,CAAC,GAAE,EAAE;AAAE;AAAA,cAAM,KAAI;AAAU,gBAAAA,KAAE,EAAE,MAAML,EAAC,GAAE,KAAK,UAAU,WAAS,SAASK,GAAE,CAAC,GAAE,EAAE,GAAE,KAAK,UAAU,WAAS,SAASA,GAAE,CAAC,GAAE,EAAE;AAAE;AAAA,cAAM,KAAI;AAAA,cAAa,KAAI;AAAiB,qBAAK,UAAUR,GAAE,YAAY,CAAC,IAAE,SAASG,IAAE,EAAE;AAAE;AAAA,cAAM,KAAI;AAAQ,uBAAO,QAAQ,KAAK,8FAA8F,GAAE,KAAK,sBAAsB,GAAE,KAAK,kBAAgBD,IAAE,MAAK,MAAM,KAAK,oBAAoB;AAAA,cAAG,KAAI;AAAY,uBAAO,QAAQ,KAAK,8FAA8F,GAAE,QAAQ,KAAK,0BAA0B,GAAE,KAAK,sBAAsB,GAAE,KAAK,sBAAoBA,IAAE,MAAK,MAAM,KAAK,iBAAiB;AAAA,YAAE;AAAA,UAAC;AAAC,cAAG,MAAIK,MAAG,cAAYF,GAAE,CAAC,EAAE,KAAK;AAAE,mBAAO,QAAQ,KAAK,8FAA8F,GAAE,KAAK,QAAQ,KAAK,oCAAoC;AAAA,QAAC;AAAA,MAAC,CAAE;AAAA,IAAC;AAAA,IAAC,wBAAuB;AAAC,sBAAe,KAAK,cAAY,KAAK,UAAU,aAAW,IAAG,KAAK,UAAQ,KAAK;AAAA,IAAS;AAAA,IAAC,gBAAe;AAAC,UAAIL,IAAEC;AAAE,aAAO,EAAE,MAAK,QAAO,QAAQ,aAAW;AAAC,mBAAO;AAAC,gBAAMC,MAAG,UAAQD,KAAE,MAAM,UAAQD,KAAE,KAAK,QAAM,WAASA,KAAE,SAAOA,GAAE,KAAK,MAAI,WAASC,KAAE,SAAOA,GAAE,OAAO,MAAM,SAAQ,CAAC,GAAEE,KAAED,GAAE;AAAO,cAAG,MAAIC,IAAE;AAAC,kBAAMH,KAAEE,GAAE,CAAC,GAAED,KAAEC,GAAE,CAAC,EAAE,QAAQ,kCAAiC,EAAE;AAAE,0BAAYF,MAAG,aAAY,KAAK,SAAO,MAAM,QAAQ,KAAK,MAAM,OAAO,MAAI,KAAK,MAAM,UAAQ,CAAC,IAAG,KAAK,MAAM,QAAQ,KAAKC,GAAE,QAAQ,kCAAiC,EAAE,CAAC,KAAG,KAAK,MAAMD,GAAE,YAAY,CAAC,IAAEC;AAAA,UAAC,WAAS,MAAIE,IAAE;AAAC,kBAAMH,KAAEE,GAAE,CAAC,EAAE,KAAK;AAAE,gBAAG,oBAAkBF;AAAE,qBAAO,MAAK,MAAM,KAAK,oBAAoB;AAAG,gBAAG,cAAYA;AAAE,qBAAO,KAAK,QAAQ,KAAK,oCAAoC;AAAE,iBAAK,MAAMA,EAAC,IAAE;AAAA,UAAI;AAAA,QAAC;AAAA,MAAC,CAAE;AAAA,IAAC;AAAA,IAAC,sBAAqB;AAAC,UAAIA,IAAEC;AAAE,aAAO,EAAE,MAAK,QAAO,QAAQ,aAAW;AAAC,YAAIC;AAAE,YAAG,SAAO,KAAK,kBAAgBA,KAAE,UAAQD,KAAE,MAAM,UAAQD,KAAE,KAAK,QAAM,WAASA,KAAE,SAAOA,GAAE,KAAK,MAAI,WAASC,KAAE,SAAOA,GAAE,SAAOC,KAAE,KAAK,iBAAgB,KAAK,kBAAgB,OAAM,cAAYA,GAAE,KAAK;AAAE,iBAAO,KAAK,QAAQ,KAAK,oCAAoC;AAAE,cAAMC,KAAED,GAAE,MAAM,SAAQ,CAAC;AAAE,oBAAUC,GAAE,CAAC,IAAE,KAAK,yBAAuB,SAASA,GAAE,CAAC,EAAE,KAAK,GAAE,EAAE,KAAG,KAAK,sBAAoBD,IAAE,QAAQ,KAAK,uDAAuD,IAAG,MAAM,KAAK,iBAAiB;AAAA,MAAC,CAAE;AAAA,IAAC;AAAA,IAAC,mBAAkB;AAAC,UAAIF,IAAEG;AAAE,aAAO,EAAE,MAAK,QAAO,QAAQ,aAAW;AAAC,YAAID,KAAE,GAAEG,KAAE,CAAC,MAAK,MAAK,MAAK,MAAK,MAAK,MAAK,MAAK,MAAK,MAAK,MAAK,MAAK,MAAK,MAAK,MAAK,MAAK,MAAK,IAAI,GAAEE,KAAE,CAAC,GAAEC,KAAE,OAAGJ,KAAE;AAAG,mBAAO;AAAC,cAAIE;AAAE,cAAG,SAAO,KAAK,sBAAoBA,KAAE,UAAQH,KAAE,MAAM,UAAQH,KAAE,KAAK,QAAM,WAASA,KAAE,SAAOA,GAAE,KAAK,MAAI,WAASG,KAAE,SAAOA,GAAE,SAAOG,KAAE,KAAK,qBAAoB,KAAK,sBAAoB,OAAM,QAAMA;AAAE,mBAAO,QAAQ,KAAK,2CAA2C,GAAE,KAAK,KAAK,uBAAuB;AAAE,gBAAMG,KAAEH,GAAE,MAAM,SAAQ,CAAC,GAAE,IAAEG,GAAE;AAAO,cAAG,MAAI,GAAE;AAAC,kBAAMT,KAAES,GAAE,CAAC,GAAEN,KAAEM,GAAE,CAAC,EAAE,KAAK;AAAE,gBAAIF;AAAE,oBAAOP,IAAE;AAAA,cAAC,KAAI;AAAY,gBAAAK,KAAE,CAAC,MAAK,MAAK,MAAK,MAAK,MAAK,MAAK,MAAK,MAAK,MAAK,MAAK,MAAK,MAAK,MAAK,MAAK,MAAK,MAAK,IAAI,GAAEA,GAAE,CAAC,IAAEF,IAAEC,KAAE;AAAG;AAAA,cAAM,KAAI;AAAW,gBAAAF,KAAE,SAASC,IAAE,EAAE,GAAEE,GAAE,CAAC,IAAEH;AAAE;AAAA,cAAM,KAAI;AAAM,gBAAAK,KAAEJ,GAAE,MAAM,GAAG,GAAEE,GAAE,CAAC,IAAE,SAASE,GAAE,CAAC,GAAE,EAAE,GAAEF,GAAE,CAAC,IAAE,SAASE,GAAE,CAAC,GAAE,EAAE,GAAEF,GAAE,CAAC,IAAE,SAASE,GAAE,CAAC,GAAE,EAAE,GAAEF,GAAE,CAAC,IAAE,SAASE,GAAE,CAAC,GAAE,EAAE;AAAE;AAAA,cAAM,KAAI;AAAS,gBAAAA,KAAEJ,GAAE,MAAM,GAAG,GAAEE,GAAE,CAAC,IAAE,SAASE,GAAE,CAAC,GAAE,EAAE,GAAEF,GAAE,CAAC,IAAE,SAASE,GAAE,CAAC,GAAE,EAAE;AAAE;AAAA,cAAM,KAAI;AAAS,gBAAAA,KAAEJ,GAAE,MAAM,GAAG,GAAEE,GAAE,CAAC,IAAE,SAASE,GAAE,CAAC,GAAE,EAAE,GAAEF,GAAE,CAAC,IAAE,SAASE,GAAE,CAAC,GAAE,EAAE;AAAE;AAAA,cAAM,KAAI;AAAU,gBAAAA,KAAEJ,GAAE,MAAM,GAAG,GAAEE,GAAE,EAAE,IAAE,SAASE,GAAE,CAAC,GAAE,EAAE,GAAEF,GAAE,EAAE,IAAE,SAASE,GAAE,CAAC,GAAE,EAAE;AAAE;AAAA,cAAM,KAAI;AAAU,gBAAAA,KAAEJ,GAAE,MAAM,GAAG,GAAEE,GAAE,EAAE,IAAE,SAASE,GAAE,CAAC,GAAE,EAAE,GAAEF,GAAE,EAAE,IAAE,SAASE,GAAE,CAAC,GAAE,EAAE;AAAE;AAAA,cAAM,KAAI;AAAU,gBAAAA,KAAE,EAAE,MAAMJ,EAAC,GAAEE,GAAE,EAAE,IAAE,SAASE,GAAE,CAAC,GAAE,EAAE,GAAEF,GAAE,EAAE,IAAE,SAASE,GAAE,CAAC,GAAE,EAAE;AAAA,YAAC;AAAA,UAAC,WAAS,MAAI,GAAE;AAAC,kBAAMP,KAAES,GAAE,CAAC,EAAE,KAAK;AAAE,oBAAOT,IAAE;AAAA,cAAC,KAAI;AAAS,gBAAAO,KAAE,CAAC,GAAEC,KAAE;AAAG;AAAA,cAAM,KAAI;AAAU,gBAAAA,KAAE,OAAGH,GAAE,EAAE,IAAEE,IAAE,KAAK,OAAO,IAAIL,IAAEG,EAAC,GAAED,KAAE;AAAG;AAAA,cAAM,KAAI;AAAU,oBAAGA;AAAE,yBAAO,KAAK,KAAK,uBAAuB;AAAA,cAAE;AAAQ,gBAAAI,MAAGD,GAAE,KAAKP,EAAC;AAAA,YAAC;AAAA,UAAC;AAAA,QAAC;AAAA,MAAC,CAAE;AAAA,IAAC;AAAA,IAAC,yBAAwB;AAAC,YAAME,KAAE,KAAK,OAAO;AAAK,WAAK,2BAAyBA,OAAI,SAAO,KAAK,yBAAuB,QAAQ,KAAK,wDAAwD,IAAE,QAAQ,KAAK,8CAA8C,KAAK,uBAAuB,SAAS,CAAC,iDAAiDA,GAAE,SAAS,CAAC,EAAE;AAAA,IAAE;AAAA,IAAC,IAAI,SAAQ;AAAC,aAAO,KAAK,OAAO;AAAA,IAAI;AAAA,IAAC,QAAQA,IAAEF,IAAE;AAAC,YAAMC,KAAE,QAAMC,KAAEA,KAAE,GAAEC,KAAE,QAAMH,KAAEA,KAAE;AAAK,UAAIK;AAAE,YAAME,KAAE,CAAC,GAAG,KAAK,OAAO,KAAK,CAAC;AAAE,cAAON,IAAE;AAAA,QAAC,KAAK;AAAE,UAAAI,KAAEE,GAAE,KAAM,CAACL,IAAEF,OAAIE,KAAEF,EAAE;AAAE;AAAA,QAAM,KAAK;AAAE,UAAAK,KAAEE;AAAE;AAAA,QAAM,KAAK;AAAE,UAAAF,KAAEE,GAAE,KAAM,CAACL,IAAEF,OAAIA,KAAEE,EAAE;AAAE;AAAA,QAAM,KAAI;AAAG,UAAAG,KAAEE,GAAE,QAAQ;AAAA,MAAC;AAAC,UAAG,SAAOJ,IAAE;AAAC,cAAMD,KAAE,CAAAA,OAAG;AAAC,cAAG,YAAU,OAAOC;AAAE,mBAAOD,KAAEC;AAAE,cAAG,MAAM,QAAQA,EAAC,KAAG,MAAIA,GAAE,UAAQ,YAAU,OAAOA,GAAE,CAAC,KAAG,YAAU,OAAOA,GAAE,CAAC;AAAE,mBAAOD,MAAGC,GAAE,CAAC,KAAGD,MAAGC,GAAE,CAAC;AAAE,cAAG,MAAM,QAAQA,EAAC,KAAG,MAAM,QAAQA,GAAE,CAAC,CAAC;AAAE,uBAAUH,MAAKG,IAAE;AAAC,oBAAK,CAACF,IAAEE,EAAC,IAAEH;AAAE,kBAAGE,MAAGC,MAAGD,MAAGD;AAAE,uBAAM;AAAA,YAAE;AAAC,iBAAM;AAAA,QAAE;AAAE,QAAAI,KAAEA,GAAE,OAAOH,EAAC;AAAA,MAAC;AAAC,aAAOG;AAAA,IAAC;AAAA,IAAC,CAAC,WAAWH,IAAEF,IAAE;AAAC,iBAAUC,MAAK,KAAK,QAAQC,IAAEF,EAAC;AAAE,cAAM,KAAK,UAAUC,EAAC;AAAA,IAAC;AAAA,IAAC,UAAUC,IAAE;AAAC,YAAMF,KAAE,KAAK,OAAO,IAAIE,EAAC;AAAE,UAAG,QAAMF;AAAE,eAAO,QAAQ,KAAK,UAAU,OAAO,cAAcE,EAAC,CAAC,gBAAgBA,GAAE,SAAS,CAAC,kDAAkD,GAAE;AAAK;AAAC,cAAMA,KAAE,CAAC;AAAE,eAAO,EAAE,QAAS,CAACD,IAAEE,OAAI;AAAC,cAAIE,IAAEE,IAAEC;AAAE,UAAAH,KAAEH,IAAEK,KAAEN,IAAEO,KAAER,GAAEG,EAAC,GAAEE,GAAEE,EAAC,IAAEC;AAAA,QAAC,CAAE,GAAE,IAAI,EAAEN,IAAE,IAAI;AAAA,MAAC;AAAA,IAAC;AAAA,IAAC,MAAMA,IAAE;AAAC,YAAMF,KAAEE,GAAE,YAAY,CAAC;AAAE,aAAO,WAASF,KAAE,OAAK,KAAK,UAAUA,EAAC;AAAA,IAAC;AAAA,IAAC,YAAYE,IAAE;AAAC,YAAMF,KAAE,CAAC,GAAEC,KAAEC,GAAE;AAAO,eAAQC,IAAEE,KAAE,GAAEA,KAAEJ,IAAEI,MAAI;AAAC,QAAAF,KAAED,GAAEG,EAAC;AAAE,cAAMJ,KAAEE,GAAE,YAAY,CAAC;AAAE,mBAASF,MAAG,KAAK,OAAO,IAAIA,EAAC,KAAGD,GAAE,KAAKG,EAAC;AAAA,MAAC;AAAC,aAAO,MAAIH,GAAE,SAAOA,KAAE;AAAA,IAAI;AAAA,IAAC,QAAQE,IAAEF,KAAE,CAAC,GAAE;AAAC,UAAIC,IAAEI,IAAED,IAAE,GAAE,GAAE,GAAE;AAAE,YAAM,IAAE,UAAQH,KAAED,GAAE,cAAY,WAASC,KAAEA,KAAE,KAAI,IAAE,UAAQI,KAAEL,GAAE,SAAO,WAASK,KAAEA,KAAE,GAAE,IAAE,UAAQD,KAAEJ,GAAE,cAAY,WAASI,KAAEA,KAAE,QAAO,IAAE,UAAQ,IAAEJ,GAAE,2BAAyB,WAAS,KAAG,GAAE,IAAE,UAAQ,IAAEA,GAAE,YAAU,WAAS,IAAE,IAAE;AAAK,UAAG,WAAS,KAAK;AAAQ,cAAM,IAAI,MAAM,oBAAoB;AAAE,UAAI,GAAE,GAAE,GAAE,GAAE,GAAE,GAAE,GAAE,GAAE,GAAE,GAAE,GAAE,GAAE,GAAE,GAAE,GAAE,GAAE,GAAE;AAAE,YAAM,IAAE,UAAQ,IAAE,EAAE,CAAC,MAAI,WAAS,IAAE,IAAE,GAAE,IAAE,EAAE,MAAM,GAAE,CAAC,GAAE,IAAE,EAAE,MAAM,GAAE,CAAC;AAAE,WAAK,KAAG,KAAK,KAAG,IAAE,EAAE,CAAC,GAAE,IAAE,EAAE,CAAC,MAAI,IAAE,GAAE,IAAE,IAAG,MAAI,KAAG,MAAI,IAAE,IAAE,IAAE,MAAI,KAAG,OAAK,MAAI,IAAE,IAAG,MAAI,KAAG,OAAK,IAAE,IAAE,IAAE,MAAI,KAAG,MAAI,MAAI,IAAE,IAAG,MAAI,MAAI,IAAE,IAAE,IAAE,KAAK,QAAQ,OAAK,KAAK,QAAQ,MAAK,IAAE,KAAG,IAAE,QAAO,IAAE,WAAS,IAAE,QAAO,IAAE,SAAQ,IAAE,KAAK,KAAK,UAAQ,KAAK,QAAQ,CAAC,IAAE,KAAK,KAAK,UAAQ,KAAK,QAAQ,CAAC,IAAE;AAAM,YAAM,IAAE,CAAC;AAAE,UAAE,CAAC;AAAE,YAAM,IAAE,CAAC;AAAE,UAAE,CAAC,GAAE,IAAE;AAAE,YAAM,IAAE,MAAI;AAAC,UAAE,KAAK,CAAC,GAAE,IAAE,EAAE,MAAM,IAAE,EAAE,IAAI,GAAE,EAAE,KAAK,CAAC;AAAA,MAAC,GAAE,IAAEE,GAAE,OAAO,QAAQ,EAAE;AAAE,WAAI,IAAE,WAAK;AAAC,YAAG;AAAE,cAAE;AAAA,aAAO;AAAC,cAAG,IAAE,UAAQ,IAAE,EAAE,KAAK,MAAI,WAAS,IAAE,SAAO,EAAE,OAAM,WAAS;AAAE;AAAM,gBAAMA,KAAE,KAAK,UAAU,CAAC;AAAE,cAAE,SAAOA,KAAEA,KAAE,IAAE,aAAa,IAAE,IAAE,IAAI,EAAE,GAAE,IAAI,IAAE,IAAI,EAAE,GAAE,IAAI,GAAE,IAAE,EAAE,KAAK,GAAE,IAAE,EAAE,MAAM,GAAE,IAAE,GAAE,MAAI,KAAG,WAAS,KAAG,WAAS,MAAI,IAAE,EAAE,KAAK,CAAC,KAAG,EAAE,KAAK,CAAC,GAAE,QAAM,MAAI,IAAE,IAAG,QAAM,KAAG,WAAS,MAAI,IAAE,IAAE;AAAA,QAAG;AAAC,YAAG,WAAS,KAAG,WAAS,KAAG,WAAS,KAAG,WAAS,KAAG,WAAS;AAAE,cAAG,KAAG,IAAE,GAAE,KAAG;AAAE,cAAE,KAAK,CAAC,GAAE,EAAE,KAAK,CAAC;AAAA,eAAM;AAAC,gBAAG,MAAI,EAAE;AAAO,oBAAM,IAAI,MAAM,mBAAmB,CAAC,0DAA0D,EAAE,IAAI,CAAC,gBAAgB,CAAC,YAAY,CAAC,GAAG;AAAE,cAAE,GAAE,IAAE,GAAE,IAAE,CAAC,GAAE,IAAE,CAAC,GAAE,IAAE;AAAA,UAAE;AAAA,MAAC;AAAC,YAAI,EAAE,UAAQ,EAAE;AAAE,YAAM,IAAE,EAAE,IAAK,CAACA,IAAEF,OAAI,EAAE,UAAUE,IAAE,EAAC,WAAU,GAAE,OAAM,GAAE,YAAW,EAAEF,EAAC,EAAC,CAAC,CAAE;AAAE,aAAO,EAAE,UAAU,GAAE,EAAC,WAAU,GAAE,OAAM,EAAC,CAAC;AAAA,IAAC;AAAA,IAAC,KAAKE,IAAEF,KAAE,CAAC,GAAE;AAAC,YAAK,EAAC,WAAUC,IAAE,MAAKE,IAAE,WAAUE,IAAE,wBAAuBE,IAAE,SAAQC,GAAC,IAAER;AAAE,aAAO,KAAK,QAAQE,GAAE,MAAM,EAAE,EAAE,IAAK,CAAAA,OAAG;AAAC,cAAMF,KAAEE,GAAE,YAAY,CAAC;AAAE,eAAO,WAASF,KAAE,OAAKA;AAAA,MAAC,CAAE,GAAE,EAAC,WAAUC,IAAE,MAAKE,IAAE,WAAUE,IAAE,wBAAuBE,IAAE,SAAQC,GAAC,CAAC;AAAA,IAAC;AAAA,IAAC,QAAQN,KAAE,CAAC,GAAE;AAAC,YAAK,EAAC,OAAMF,IAAE,GAAEC,IAAE,WAAUE,IAAE,MAAKE,IAAE,WAAUE,IAAE,wBAAuBC,GAAC,IAAEN,IAAEE,KAAE,QAAMC,KAAEA,KAAE;AAAE,aAAO,KAAK,QAAQ,KAAK,QAAQL,IAAEC,EAAC,GAAE,EAAC,WAAUE,IAAE,MAAKC,IAAE,WAAUG,IAAE,wBAAuBC,GAAC,CAAC;AAAA,IAAC;AAAA,EAAC;AAAC,MAAM,IAAN,MAAO;AAAA,IAAC,YAAYN,IAAEF,IAAE;AAAC,WAAK,OAAKE,IAAE,KAAK,OAAKF;AAAA,IAAC;AAAA,IAAC,WAAU;AAAC,aAAO,KAAK,KAAK,EAAE,SAAS;AAAA,IAAC;AAAA,IAAC,OAAM;AAAC,UAAIE;AAAE,aAAM,WAAS,KAAK,UAAU,KAAK,MAAK,MAAK,CAAC,IAAE,cAAY,UAAQA,KAAE,KAAK,KAAK,YAAU,WAASA,KAAE,SAAOA,GAAE,YAAU;AAAA,IAAI;AAAA,IAAC,KAAI;AAAC,aAAO,KAAK,KAAK;AAAA,IAAS;AAAA,IAAC,MAAK;AAAC,aAAO,OAAO,cAAc,KAAK,GAAG,CAAC;AAAA,IAAC;AAAA,IAAC,KAAKA,IAAEF,IAAE;AAAC,YAAMC,KAAE,QAAMD,KAAEA,KAAE;AAAK,UAAIG;AAAE,cAAO,QAAMD,KAAEA,KAAE,GAAE;AAAA,QAAC,KAAK;AAAE,UAAAC,KAAE,KAAK,WAAW;AAAE;AAAA,QAAM,KAAK;AAAE,UAAAA,KAAE,KAAK,UAAU;AAAE;AAAA,QAAM,KAAK;AAAE,UAAAA,KAAE,KAAK,gBAAgB;AAAE;AAAA,QAAM,KAAI;AAAG,cAAG,SAAOF;AAAE,kBAAM,IAAI,MAAM,wDAAwD;AAAE,UAAAE,KAAE,KAAK,sBAAsBF,EAAC;AAAA,MAAC;AAAC,aAAOE;AAAA,IAAC;AAAA,IAAC,sBAAsBD,IAAE;AAAC,YAAMF,KAAE,KAAK,KAAK,QAAOC,KAAE,KAAK,KAAK,QAAO,CAACE,IAAEE,IAAEE,IAAEC,EAAC,IAAEN;AAAE,aAAO,KAAK,UAAU,EAAE,KAAKC,IAAEE,IAAE,CAACL,KAAEO,IAAE,CAACN,KAAEO,EAAC;AAAA,IAAC;AAAA,IAAC,kBAAiB;AAAC,aAAO,IAAI,EAAE,KAAK,KAAK,QAAQ,IAAK,CAAAN,OAAGA,KAAE,SAASA,IAAE,EAAE,EAAE,SAAS,CAAC,EAAE,SAAS,IAAEA,GAAE,QAAO,GAAG,IAAE,EAAG,CAAC;AAAA,IAAC;AAAA,IAAC,YAAW;AAAC,YAAMA,KAAE,KAAK,KAAK,KAAIF,KAAE,KAAK,KAAK,KAAIC,KAAE,KAAK,gBAAgB,GAAEE,KAAEF,GAAE,SAAQI,KAAEF,GAAE;AAAO,aAAOE,OAAIL,MAAG,QAAQ,KAAK,UAAU,KAAK,KAAK,UAAU,SAAS,CAAC,gBAAgB,KAAK,KAAK,UAAU,SAAS,CAAC,YAAYA,GAAE,SAAS,CAAC,4CAA4CK,GAAE,SAAS,CAAC,EAAE,GAAEJ,GAAE,UAAQE,GAAE,IAAK,CAAAH,OAAGA,GAAE,MAAM,GAAEE,EAAC,CAAE,GAAED;AAAA,IAAC;AAAA,IAAC,aAAY;AAAC,YAAMC,KAAE,KAAK,KAAK;AAAQ,UAAG,WAASA;AAAE,cAAM,IAAI,MAAM,oBAAoB;AAAE,aAAO,KAAK,sBAAsB,CAACA,GAAE,MAAKA,GAAE,MAAKA,GAAE,SAAQA,GAAE,OAAO,CAAC;AAAA,IAAC;AAAA,IAAC,OAAOA,KAAE,CAAC,GAAE;AAAC,UAAIF,IAAEC,IAAEE,IAAEE;AAAE,YAAME,KAAE,UAAQP,KAAEE,GAAE,SAAO,WAASF,KAAEA,KAAE,GAAEQ,KAAE,UAAQP,KAAEC,GAAE,eAAa,WAASD,MAAGA,IAAEG,KAAE,UAAQD,KAAED,GAAE,SAAO,WAASC,KAAEA,KAAE,MAAKG,KAAE,UAAQD,KAAEH,GAAE,SAAO,WAASG,KAAEA,KAAE;AAAK,UAAII;AAAE,YAAM,IAAE,KAAK,KAAK,QAAO,IAAE,KAAK,KAAK;AAAO,cAAOF,IAAE;AAAA,QAAC,KAAK;AAAE,gBAAML,KAAE,KAAK,KAAK;AAAQ,cAAG,WAASA;AAAE,kBAAM,IAAI,MAAM,oBAAoB;AAAE,UAAAO,KAAE,CAACP,GAAE,SAAQA,GAAE,OAAO;AAAE;AAAA,QAAM,KAAK;AAAA,QAAE,KAAK;AAAE,UAAAO,KAAE,CAAC,GAAE,CAAC;AAAE;AAAA,QAAM,KAAI;AAAG,cAAG,SAAOL,MAAG,SAAOE;AAAE,kBAAM,IAAI,MAAM,yEAAyE;AAAE,UAAAG,KAAE,CAACL,IAAEE,EAAC;AAAA,MAAC;AAAC,aAAOE,KAAEC,KAAE,CAAC,IAAEA,GAAE,CAAC,GAAE,IAAEA,GAAE,CAAC,CAAC;AAAA,IAAC;AAAA,EAAC;AAAC,MAAM,IAAN,MAAM,GAAC;AAAA,IAAC,YAAYP,IAAE;AAAC,WAAK,UAAQA;AAAA,IAAC;AAAA,IAAC,WAAU;AAAC,aAAO,KAAK,QAAQ,KAAK,IAAI,EAAE,QAAQ,MAAK,GAAG,EAAE,QAAQ,MAAK,GAAG,EAAE,QAAQ,MAAK,GAAG;AAAA,IAAC;AAAA,IAAC,OAAM;AAAC,aAAM,UAAU,KAAK,UAAU,KAAK,SAAQ,MAAK,CAAC,CAAC;AAAA,IAAG;AAAA,IAAC,QAAO;AAAC,aAAO,KAAK,QAAQ,CAAC,EAAE;AAAA,IAAM;AAAA,IAAC,SAAQ;AAAC,aAAO,KAAK,QAAQ;AAAA,IAAM;AAAA,IAAC,QAAO;AAAC,aAAO,IAAI,GAAE,CAAC,GAAG,KAAK,OAAO,CAAC;AAAA,IAAC;AAAA,IAAC,OAAO,cAAcA,IAAEF,IAAEC,IAAE;AAAC,UAAIE,KAAED;AAAE,YAAMG,KAAEH,GAAE;AAAO,UAAIK,KAAE;AAAE,MAAAP,KAAE,MAAIO,KAAE,IAAEP,IAAEG,KAAEA,GAAE,SAASI,KAAEF,IAAE,GAAG,IAAGL,KAAEC,KAAEI,OAAIF,KAAEA,GAAE,OAAOH,KAAEC,KAAEI,KAAEF,GAAE,QAAO,GAAG;AAAG,YAAMK,KAAER,KAAEO;AAAE,aAAOJ,GAAE,MAAMK,IAAEA,KAAEP,EAAC;AAAA,IAAC;AAAA,IAAC,OAAO,uBAAuBC,IAAEF,IAAEC,IAAE;AAAC,YAAME,KAAE,QAAMF,KAAEA,KAAE;AAAE,UAAG,MAAIE;AAAE,eAAOD,KAAEF;AAAE,YAAMK,KAAEH,GAAE,QAAOK,KAAEF,KAAEF,IAAEK,KAAED,KAAEP,GAAE,QAAOI,KAAE,KAAK,IAAI,GAAEG,EAAC,GAAED,KAAE,KAAK,IAAID,IAAEG,EAAC,GAAE,IAAE,GAAE,cAAcN,IAAEE,IAAEE,KAAEF,EAAC,GAAE,IAAE,GAAE,cAAcJ,IAAEI,KAAEG,IAAED,KAAEF,EAAC;AAAE,aAAO,EAAE,MAAM,EAAE,EAAE,IAAK,CAACF,IAAEF,QAAK,SAAS,EAAEA,EAAC,GAAE,EAAE,KAAG,SAASE,IAAE,EAAE,GAAG,SAAS,CAAE,EAAE,KAAK,EAAE;AAAA,IAAC;AAAA,IAAC,OAAO,0BAA0BA,IAAEF,IAAEC,IAAE;AAAC,YAAME,KAAE,QAAMF,KAAEA,KAAE;AAAE,UAAII,IAAEE;AAAE,UAAG,MAAIJ;AAAE,eAAOD,GAAE,OAAOF,EAAC;AAAE,YAAMQ,KAAEN,GAAE,CAAC,EAAE,QAAOE,KAAEF,GAAE,QAAOI,KAAEF,KAAED,IAAEM,KAAEH,KAAEN,GAAE,QAAO,IAAE,KAAK,IAAI,GAAEM,EAAC,GAAE,IAAE,KAAK,IAAIF,IAAEK,EAAC,GAAE,IAAE,CAAC;AAAE,eAAQR,KAAE,GAAEA,KAAE,GAAEA;AAAI,QAAAI,KAAEJ,KAAE,KAAGA,MAAGG,KAAE,IAAI,OAAOI,EAAC,IAAEN,GAAED,EAAC,GAAEM,KAAEN,KAAEK,MAAGL,MAAGQ,KAAE,IAAI,OAAOD,EAAC,IAAER,GAAEC,KAAEK,EAAC,GAAE,EAAE,KAAKD,GAAE,MAAM,EAAE,EAAE,IAAK,CAACH,IAAEF,QAAK,SAASO,GAAEP,EAAC,GAAE,EAAE,KAAG,SAASE,IAAE,EAAE,GAAG,SAAS,CAAE,EAAE,KAAK,EAAE,CAAC;AAAE,aAAO;AAAA,IAAC;AAAA,IAAC,OAAO,cAAcA,IAAEF,IAAEC,IAAEE,IAAEE,IAAE;AAAC,UAAIE;AAAE,YAAMC,KAAE,CAAC,GAAEJ,KAAEF,GAAE;AAAO,eAAQI,KAAE,GAAEA,KAAEL,IAAEK;AAAI,QAAAC,KAAEH,KAAEC,KAAEJ,KAAEK,IAAEC,KAAE,KAAGA,MAAGH,KAAEI,GAAE,KAAK,IAAI,OAAOR,EAAC,CAAC,IAAEQ,GAAE,KAAK,GAAE,cAAcN,GAAEK,EAAC,GAAEJ,IAAEH,EAAC,CAAC;AAAE,aAAOQ;AAAA,IAAC;AAAA,IAAC,KAAKN,IAAEF,IAAEC,IAAEE,IAAE;AAAC,YAAME,KAAE,QAAMJ,KAAEA,KAAE,GAAEM,KAAE,QAAMJ,KAAEA,KAAE;AAAE,aAAO,KAAK,UAAQ,GAAE,cAAc,KAAK,SAAQD,IAAEF,IAAEK,IAAEE,EAAC,GAAE;AAAA,IAAI;AAAA,IAAC,QAAQL,IAAE;AAAC,YAAMF,KAAE,KAAK,SAAQC,KAAEC,GAAE;AAAQ,aAAOF,GAAE,WAASC,GAAE,UAAQ,QAAQ,KAAK,8CAA8C,GAAED,GAAE,CAAC,EAAE,WAASC,GAAE,CAAC,EAAE,UAAQ,QAAQ,KAAK,6CAA6C,GAAE,KAAK,UAAQD,GAAE,IAAK,CAACE,IAAEF,OAAI;AAAC,cAAMG,KAAED,IAAEG,KAAEJ,GAAED,EAAC;AAAE,eAAOG,GAAE,MAAM,EAAE,EAAE,IAAK,CAACD,IAAEF,QAAK,SAASK,GAAEL,EAAC,GAAE,EAAE,KAAG,SAASE,IAAE,EAAE,GAAG,SAAS,CAAE,EAAE,KAAK,EAAE;AAAA,MAAC,CAAE,GAAE;AAAA,IAAI;AAAA,IAAC,OAAO,UAAUA,IAAEF,KAAE,CAAC,GAAE;AAAC,UAAIC,IAAEE,IAAEE;AAAE,YAAME,KAAE,UAAQN,KAAED,GAAE,cAAY,WAASC,KAAEA,KAAE,GAAEO,KAAE,UAAQL,KAAEH,GAAE,UAAQ,WAASG,KAAEA,KAAE,GAAEC,KAAE,UAAQC,KAAEL,GAAE,eAAa,WAASK,KAAEA,KAAE;AAAK,UAAIC,IAAE,GAAE,GAAE,GAAE,GAAE,GAAE;AAAE,UAAGC,KAAE,GAAE;AAAC,YAAE,KAAK,IAAI,GAAGL,GAAE,IAAK,CAAAA,OAAGA,GAAE,OAAO,CAAE,CAAC,GAAE,IAAE,MAAM,CAAC,EAAE,KAAK,EAAE;AAAE,cAAMF,KAAE,CAACE,IAAEF,IAAEC,OAAI,MAAIM,KAAE,GAAE,uBAAuBL,IAAEF,IAAEC,EAAC,IAAE,GAAE,uBAAuBD,IAAEE,IAAED,EAAC;AAAE,iBAAQA,KAAE,GAAEA,KAAE,GAAEA,MAAI;AAAC,cAAEO,KAAE,CAACP,KAAE,IAAEA,IAAE,IAAE;AAAE,gBAAME,KAAED,GAAE;AAAO,mBAAQG,KAAE,GAAEA,KAAEF,IAAEE,MAAI;AAAC,kBAAMF,KAAED,GAAEG,EAAC;AAAE,YAAAD,MAAG,MAAIC,OAAI,IAAED,GAAEC,KAAE,CAAC,IAAGJ,KAAEE,GAAE,OAAO,IAAE,KAAG,IAAE,EAAE,CAAC,IAAEH,GAAE,EAAE,CAAC,GAAEG,GAAE,QAAQ,CAAC,GAAE,CAAC,IAAE,EAAE,IAAE,CAAC,IAAEH,GAAE,EAAE,IAAE,CAAC,GAAEG,GAAE,QAAQA,GAAE,OAAO,IAAE,CAAC,GAAE,CAAC,IAAE,KAAG,IAAE,EAAE,CAAC,IAAEH,GAAE,EAAE,CAAC,GAAE,IAAI,OAAOG,GAAE,MAAM,CAAC,GAAE,CAAC,IAAE,EAAE,IAAE,CAAC,IAAEH,GAAE,EAAE,IAAE,CAAC,GAAE,IAAI,OAAOG,GAAE,MAAM,CAAC,GAAE,CAAC;AAAA,UAAC;AAAA,QAAC;AAAA,MAAC,OAAK;AAAC,YAAE,KAAK,IAAI,GAAGD,GAAE,IAAK,CAAAA,OAAGA,GAAE,MAAM,CAAE,CAAC,GAAE,IAAE,CAAC,GAAE,IAAE;AAAE,cAAMF,KAAEE,GAAE;AAAO,iBAAQD,KAAE,GAAEA,KAAED,IAAEC,MAAI;AAAC,gBAAMD,KAAEE,GAAED,EAAC;AAAE,UAAAG,MAAG,MAAIH,OAAI,IAAEG,GAAEH,KAAE,CAAC,IAAGK,KAAEN,GAAE,SAAQ,IAAEA,GAAE,MAAM,GAAE,MAAI,MAAI,IAAEQ,KAAE,IAAE,IAAE,GAAEF,KAAE,KAAK,cAAcA,IAAE,GAAEN,GAAE,OAAO,GAAE,GAAE,CAAC,IAAG,IAAE,MAAIO,KAAE,GAAE,0BAA0B,GAAED,IAAE,CAAC,IAAE,GAAE,0BAA0BA,IAAE,GAAE,CAAC;AAAA,QAAC;AAAA,MAAC;AAAC,aAAO,IAAI,KAAK,CAAC;AAAA,IAAC;AAAA,IAAC,OAAOJ,IAAEF,KAAE,CAAC,GAAE;AAAC,YAAK,EAAC,WAAUC,IAAE,OAAME,IAAE,QAAOE,GAAC,IAAEL,IAAEO,KAAE,QAAMF,KAAEA,KAAE;AAAE,aAAO,KAAK,UAAQ,GAAE,UAAU,CAAC,MAAKH,EAAC,GAAE,EAAC,WAAUD,IAAE,OAAME,IAAE,YAAW,CAACI,EAAC,EAAC,CAAC,EAAE,SAAQ;AAAA,IAAI;AAAA,IAAC,OAAO,kBAAkBL,IAAEF,IAAEC,IAAE;AAAC,YAAME,KAAE,QAAMH,KAAEA,KAAE,GAAEK,KAAE,QAAMJ,KAAEA,KAAE;AAAE,UAAIM,KAAE,CAAC,GAAGL,EAAC;AAAE,aAAOC,KAAE,MAAII,KAAEA,GAAE,IAAK,CAAAL,OAAGA,GAAE,MAAM,EAAE,EAAE,OAAQ,CAACA,IAAEF,OAAIE,GAAE,OAAO,MAAMC,EAAC,EAAE,KAAKH,EAAC,CAAC,GAAG,CAAC,CAAC,EAAE,KAAK,EAAE,CAAE,IAAGK,KAAE,MAAIE,KAAEA,GAAE,OAAQ,CAACL,IAAEF,OAAIE,GAAE,OAAO,MAAMG,EAAC,EAAE,KAAKL,EAAC,CAAC,GAAG,CAAC,CAAC,IAAGO;AAAA,IAAC;AAAA,IAAC,QAAQL,IAAEF,IAAE;AAAC,aAAO,KAAK,UAAQ,GAAE,kBAAkB,KAAK,SAAQE,IAAEF,EAAC,GAAE;AAAA,IAAI;AAAA,IAAC,QAAQE,IAAEF,IAAE;AAAC,YAAMC,KAAE,YAAU,OAAOC,KAAEA,GAAE,SAAS,IAAEA,IAAEC,KAAE,YAAU,OAAOH,KAAEA,GAAE,SAAS,IAAEA;AAAE,aAAO,KAAK,UAAQ,KAAK,QAAQ,IAAK,CAAAE,QAAI,CAACA,IAAEF,IAAEC,OAAI;AAAC,YAAG,gBAAe,OAAO;AAAU,iBAAOC,GAAE,WAAWF,IAAEC,EAAC;AAAE;AAAC,gBAAME,KAAE,CAAAD,OAAGA,GAAE,QAAQ,yBAAwB,MAAM;AAAE,iBAAOA,GAAE,QAAQ,IAAI,OAAOC,GAAEH,EAAC,GAAE,GAAG,GAAEC,EAAC;AAAA,QAAC;AAAA,MAAC,GAAGC,IAAED,IAAEE,EAAC,CAAE,GAAE;AAAA,IAAI;AAAA,IAAC,OAAOD,IAAEF,IAAE;AAAC,YAAMC,KAAE,QAAMC,KAAEA,KAAE,GAAEC,KAAE,QAAMH,KAAEA,KAAE;AAAG,UAAIK,IAAEE,IAAEC,IAAEJ,IAAEE,IAAEG;AAAE,YAAM,IAAE,KAAK,MAAM;AAAE,aAAOA,KAAE,KAAK,MAAM,GAAEJ,KAAE,KAAK,OAAO,GAAEI,MAAG,KAAK,IAAIR,EAAC,GAAEI,MAAG,KAAK,IAAIF,EAAC,GAAE,EAAE,UAAQ,EAAE,QAAQ,IAAK,CAAAD,OAAGA,GAAE,QAAQ,MAAK,GAAG,CAAE,GAAED,KAAE,KAAGM,KAAE,GAAEH,KAAE,CAACH,OAAIM,KAAEN,IAAEG,KAAE,IAAGD,KAAE,KAAGK,KAAE,GAAEF,KAAE,CAACH,OAAIK,KAAEL,IAAEG,KAAE,IAAG,KAAK,KAAKG,IAAEJ,IAAEE,IAAEC,EAAC,GAAE,EAAE,KAAKC,IAAEJ,IAAED,IAAEE,EAAC,GAAE,EAAE,QAAQ,IAAI,GAAE,KAAK,UAAQ,EAAE,SAAQ;AAAA,IAAI;AAAA,IAAC,KAAKJ,IAAE;AAAC,UAAIF,IAAEC,IAAEE,IAAEE,IAAEE,IAAEC,IAAEJ,IAAEE,IAAEG,IAAE,GAAE,GAAE,GAAE,GAAE;AAAE,YAAM,IAAE,QAAMP,KAAEA,KAAE;AAAE,UAAI,GAAE,GAAE,GAAE;AAAE,UAAE,KAAK,MAAM,GAAE,IAAE,KAAK,OAAO,GAAE,KAAG,GAAE,KAAG,GAAE,KAAK,KAAK,GAAE,GAAE,IAAG,EAAE;AAAE,YAAM,IAAE,KAAK,OAAO,CAAC,GAAE,IAAE,EAAE;AAAO,eAAQA,KAAE,GAAEA,KAAE,GAAEA,MAAI;AAAC,YAAE,EAAEA,EAAC;AAAE,cAAMQ,KAAE,EAAE;AAAO,iBAAQC,KAAE,GAAEA,KAAED,IAAEC;AAAI,cAAE,EAAEA,EAAC,GAAE,MAAI,OAAKX,KAAE,EAAEE,EAAC,GAAGD,KAAEU,KAAE,CAAC,MAAIX,GAAEC,EAAC,IAAE,KAAIE,KAAE,EAAED,EAAC,GAAGG,KAAEM,KAAE,CAAC,MAAIR,GAAEE,EAAC,IAAE,KAAIE,KAAE,EAAEL,KAAE,CAAC,GAAGS,EAAC,MAAIJ,GAAEI,EAAC,IAAE,KAAIH,KAAE,EAAEN,KAAE,CAAC,GAAGS,EAAC,MAAIH,GAAEG,EAAC,IAAE,IAAG,MAAI,OAAKP,KAAE,EAAEF,KAAE,CAAC,GAAGI,KAAEK,KAAE,CAAC,MAAIP,GAAEE,EAAC,IAAE,KAAIG,KAAE,EAAEP,KAAE,CAAC,GAAG,IAAES,KAAE,CAAC,MAAIF,GAAE,CAAC,IAAE,KAAI,IAAE,EAAEP,KAAE,CAAC,GAAG,IAAES,KAAE,CAAC,MAAI,EAAE,CAAC,IAAE,KAAI,IAAE,EAAET,KAAE,CAAC,GAAG,IAAES,KAAE,CAAC,MAAI,EAAE,CAAC,IAAE;AAAA,MAAI;AAAC,aAAO,KAAK,UAAQ,EAAE,IAAK,CAAAT,OAAGA,GAAE,IAAK,CAAAA,OAAGA,GAAE,SAAS,CAAE,EAAE,KAAK,EAAE,CAAE,GAAE;AAAA,IAAI;AAAA,IAAC,QAAQA,IAAE;AAAC,YAAMF,KAAE,QAAME,KAAEA,KAAE,GAAED,KAAE,KAAK,MAAM,GAAEE,KAAE,KAAK,OAAO,GAAEE,KAAEJ,KAAED;AAAE,aAAO,MAAIK,KAAE,OAAK,KAAK,KAAKJ,KAAED,KAAEK,IAAEF,EAAC;AAAA,IAAC;AAAA,IAAC,OAAOD,IAAE;AAAC,UAAIF;AAAE,cAAO,QAAME,KAAEA,KAAE,GAAE;AAAA,QAAC,KAAK;AAAE,UAAAF,KAAE,KAAK,QAAQ,KAAK,IAAI;AAAE;AAAA,QAAM,KAAK;AAAE,UAAAA,KAAE,KAAK;AAAQ;AAAA,QAAM,KAAK;AAAE,UAAAA,KAAE,KAAK,QAAQ,IAAK,CAAAE,OAAGA,GAAE,MAAM,EAAE,EAAE,IAAK,CAAAA,OAAG,SAASA,IAAE,EAAE,CAAE,CAAE;AAAE;AAAA,QAAM,KAAK;AAAE,UAAAF,KAAE,CAAC,EAAE,OAAO,GAAG,KAAK,OAAO,CAAC,CAAC;AAAE;AAAA,QAAM,KAAK;AAAE,UAAAA,KAAE,KAAK,QAAQ,IAAK,CAAAE,OAAG;AAAC,gBAAG,CAAC,UAAU,KAAKA,EAAC;AAAE,oBAAM,IAAI,MAAM,0BAA0BA,EAAC,EAAE;AAAE,mBAAO,SAASA,IAAE,CAAC,EAAE,SAAS,EAAE,EAAE,SAAS,KAAG,KAAK,MAAM,KAAG,KAAK,MAAM,IAAE,CAAC,GAAE,GAAG;AAAA,UAAC,CAAE;AAAE;AAAA,QAAM,KAAK;AAAE,UAAAF,KAAE,KAAK,QAAQ,IAAK,CAAAE,OAAG;AAAC,gBAAG,CAAC,UAAU,KAAKA,EAAC;AAAE,oBAAM,IAAI,MAAM,0BAA0BA,EAAC,EAAE;AAAE,mBAAO,SAASA,IAAE,CAAC;AAAA,UAAC,CAAE;AAAA,MAAC;AAAC,aAAOF;AAAA,IAAC;AAAA,IAAC,YAAYE,IAAEF,IAAE;AAAC,YAAMC,KAAE,QAAMD,KAAEA,KAAE,EAAC,GAAE,MAAK,GAAE,SAAQ,GAAE,MAAK;AAAE,aAAO,KAAK,OAAO,CAAC,EAAE,QAAS,CAACA,IAAEG,OAAI;AAAC,QAAAH,GAAE,QAAS,CAACA,IAAEK,OAAI;AAAC,gBAAME,KAAEP,GAAE,SAAS;AAAE,cAAG,QAAMO,MAAG,QAAMA,MAAG,QAAMA,IAAE;AAAC,kBAAMP,KAAEC,GAAEM,EAAC;AAAE,oBAAMP,OAAIE,GAAE,YAAUF,IAAEE,GAAE,SAASG,IAAEF,IAAE,GAAE,CAAC;AAAA,UAAE;AAAA,QAAC,CAAE;AAAA,MAAC,CAAE,GAAE;AAAA,IAAI;AAAA,EAAC;AAAC,MAAM,QAAM,CAAAH,OAAG,EAAE,QAAO,QAAO,QAAQ,aAAW;AAAC,WAAO,MAAM,IAAI,IAAG,eAAeA,EAAC;AAAA,EAAC,CAAE;;;ACJrziB,MAAM,kBAAkB;AAAA,IACtB,gBAAgB;AAAA,MACd,IAAI,EAAE,MAAM,uBAAuB,SAAS,EAAE;AAAA,MAC9C,IAAI,EAAE,MAAM,uBAAuB,SAAS,EAAE;AAAA,MAC9C,IAAI,EAAE,MAAM,uBAAuB,SAAS,EAAE;AAAA;AAAA,IAChD;AAAA,IACA,UAAU;AAAA,MACR,IAAI,EAAE,MAAM,iBAAiB,SAAS,GAAG;AAAA;AAAA,MACzC,IAAI,EAAE,MAAM,iBAAiB,SAAS,EAAE;AAAA,MACxC,IAAI,EAAE,MAAM,iBAAiB,SAAS,EAAE;AAAA,IAC1C;AAAA,EACF;AAGA,MAAM,YAAY,oBAAI,IAAI;AAC1B,MAAMY,oBAAmB,oBAAI,IAAI;AAMjC,WAAS,cAAc,UAAU;AAE/B,UAAM,kBAAkB,OAAO,OAAO,mBAAmB,eACjC,OAAO,SAAS,SAAS,SAAS,WAAW,KAC7C,OAAO,SAAS,SAAS,SAAS,YAAY,KAC9C,SAAS,cAAc,gBAAgB,MAAM;AAErE,QAAI,iBAAiB;AAEnB,aAAO,iCAAiC,QAAQ;AAAA,IAClD;AAIA,UAAM,WAAW,OAAO,SAAS,SAAS,UAAU,GAAG,OAAO,SAAS,SAAS,YAAY,GAAG,IAAI,CAAC;AACpG,WAAO,GAAG,QAAQ,SAAS,QAAQ;AAAA,EACrC;AAOA,WAASC,cAAa,QAAQ;AAC5B,QAAI,UAAU;AAAI,aAAO;AACzB,QAAI,UAAU;AAAI,aAAO;AACzB,WAAO;AAAA,EACT;AAQA,iBAAsB,YAAY,UAAU,YAAY,IAAI;AAC1D,UAAM,WAAW,GAAG,QAAQ,IAAI,SAAS;AAGzC,QAAI,UAAU,IAAI,QAAQ,GAAG;AAC3B,aAAO,UAAU,IAAI,QAAQ;AAAA,IAC/B;AAGA,QAAID,kBAAiB,IAAI,QAAQ,GAAG;AAClC,aAAOA,kBAAiB,IAAI,QAAQ;AAAA,IACtC;AAGA,UAAM,aAAa,gBAAgB,QAAQ;AAC3C,QAAI,CAAC,cAAc,CAAC,WAAW,SAAS,GAAG;AACzC,cAAQ,KAAK,kCAAkC,QAAQ,cAAc,SAAS,EAAE;AAChF,aAAO;AAAA,IACT;AAEA,UAAM,SAAS,WAAW,SAAS;AAGnC,UAAM,eAAe,YAAY;AAC/B,UAAI;AACF,cAAM,UAAU,cAAc,OAAO,IAAI;AACzC,gBAAQ,IAAI,uBAAuB,OAAO,KAAK;AAE/C,cAAM,OAAO,MAAM,MAAM,WAAW,OAAO,CAAC;AAE5C,cAAM,SAAS,EAAE,MAAM,OAAO;AAC9B,kBAAU,IAAI,UAAU,MAAM;AAC9B,gBAAQ,IAAI,oBAAoB,QAAQ,KAAK,SAAS,yBAAyB;AAC/E,eAAO;AAAA,MACT,SAASE,IAAG;AACV,gBAAQ,KAAK,mCAAmC,QAAQ,KAAK,SAAS,QAAQA,EAAC;AAC/E,QAAAF,kBAAiB,OAAO,QAAQ;AAChC,eAAO;AAAA,MACT;AAAA,IACF,GAAG;AAEH,IAAAA,kBAAiB,IAAI,UAAU,WAAW;AAC1C,WAAO;AAAA,EACT;AAQO,WAAS,gBAAgB,UAAU,YAAY,IAAI;AACxD,UAAM,WAAW,GAAG,QAAQ,IAAI,SAAS;AACzC,WAAO,UAAU,IAAI,QAAQ;AAAA,EAC/B;AAYO,WAAS,gBAAgB,MAAM,OAAO,QAAQ,UAAU,WAAW,UAAU,QAAQ,WAAW,gBAAgB;AACrH,UAAM,YAAYC,cAAa,MAAM;AACrC,UAAM,WAAW,GAAG,QAAQ,IAAI,SAAS;AACzC,UAAM,SAAS,UAAU,IAAI,QAAQ;AAErC,QAAI,CAAC,QAAQ;AAEX,kBAAY,UAAU,SAAS;AAC/B,aAAO;AAAA,IACT;AAEA,UAAM,EAAE,MAAM,OAAO,IAAI;AAGzB,UAAM,SAAS,IAAI,MAAM,QAAQ,MAAM,EAAE,KAAK,OAAO;AAGrD,QAAI,CAAC,QAAQ,KAAK,KAAK,MAAM,IAAI;AAC/B,aAAO;AAAA,IACT;AAEA,QAAI;AAGF,YAAM,SAAS,KAAK,KAAK,MAAM,EAAE,WAAW,QAAQ,MAAM,EAAE,CAAC;AAC7D,YAAM,UAAU,OAAO;AACvB,YAAM,YAAY,OAAO,MAAM;AAC/B,YAAM,aAAa,OAAO,OAAO;AAGjC,YAAM,UAAU,KAAK,OAAO,QAAQ,aAAa,CAAC;AAClD,YAAM,UAAU,KAAK,OAAO,SAAS,cAAc,CAAC,KAAK,OAAO,WAAW;AAG3E,eAAS,MAAM,GAAG,MAAM,YAAY,OAAO;AACzC,cAAM,UAAU,QAAQ,GAAG,KAAK;AAChC,iBAAS,MAAM,GAAG,MAAM,QAAQ,QAAQ,OAAO;AAC7C,gBAAM,KAAK,UAAU;AACrB,gBAAM,KAAK,UAAU;AAGrB,cAAI,MAAM,KAAK,KAAK,SAAS,MAAM,KAAK,KAAK,QAAQ;AACnD,kBAAM,MAAM,KAAK,QAAQ;AAEzB,mBAAO,GAAG,IAAI,QAAQ,GAAG,MAAM,MAAM,UAAU;AAAA,UACjD;AAAA,QACF;AAAA,MACF;AAAA,IACF,SAASC,IAAG;AACV,cAAQ,KAAK,qCAAqCA,EAAC;AACnD,aAAO;AAAA,IACT;AAEA,WAAO;AAAA,EACT;AAYO,WAAS,sBAAsB,MAAM,cAAc,QAAQ,UAAU,WAAW,UAAU,QAAQ,WAAW,gBAAgB;AAClI,UAAM,YAAYD,cAAa,MAAM;AACrC,UAAM,WAAW,GAAG,QAAQ,IAAI,SAAS;AACzC,UAAM,SAAS,UAAU,IAAI,QAAQ;AAErC,QAAI,CAAC,QAAQ;AACX,kBAAY,UAAU,SAAS;AAC/B,aAAO;AAAA,IACT;AAEA,UAAM,EAAE,MAAM,OAAO,IAAI;AAGzB,QAAI,CAAC,QAAQ,KAAK,KAAK,MAAM,IAAI;AAC/B,YAAM,gBAAgB,eAAe;AACrC,YAAM,SAAS,IAAI,MAAM,gBAAgB,MAAM,EAAE,KAAK,OAAO;AAC7D,aAAO,EAAE,QAAQ,OAAO,cAAc;AAAA,IACxC;AAEA,QAAI;AAEF,YAAM,SAAS,KAAK,KAAK,MAAM,EAAE,WAAW,QAAQ,MAAM,EAAE,CAAC;AAC7D,YAAM,UAAU,OAAO;AACvB,YAAM,YAAY,OAAO,MAAM;AAC/B,YAAM,aAAa,OAAO,OAAO;AAGjC,YAAM,gBAAgB,eAAe,YAAY;AACjD,YAAM,SAAS,IAAI,MAAM,gBAAgB,MAAM,EAAE,KAAK,OAAO;AAG7D,YAAM,SAAS;AACf,YAAM,UAAU,KAAK,OAAO,SAAS,cAAc,CAAC,KAAK,OAAO,WAAW;AAG3E,eAAS,MAAM,GAAG,MAAM,YAAY,OAAO;AACzC,cAAM,UAAU,QAAQ,GAAG,KAAK;AAChC,iBAAS,MAAM,GAAG,MAAM,QAAQ,QAAQ,OAAO;AAC7C,gBAAM,KAAK,SAAS;AACpB,gBAAM,KAAK,UAAU;AAErB,cAAI,MAAM,KAAK,KAAK,iBAAiB,MAAM,KAAK,KAAK,QAAQ;AAC3D,kBAAM,MAAM,KAAK,gBAAgB;AACjC,mBAAO,GAAG,IAAI,QAAQ,GAAG,MAAM,MAAM,UAAU;AAAA,UACjD;AAAA,QACF;AAAA,MACF;AAEA,aAAO,EAAE,QAAQ,OAAO,cAAc;AAAA,IACxC,SAASC,IAAG;AACV,cAAQ,KAAK,4CAA4CA,EAAC;AAC1D,aAAO;AAAA,IACT;AAAA,EACF;;;ACpPO,MAAM,cAAN,MAAkB;AAAA,IACvB,YAAY,UAAU;AACpB,WAAK,WAAW;AAAA,IAClB;AAAA;AAAA;AAAA;AAAA,IAKA,KAAK,YAAY,OAAO;AACtB,YAAM,EAAE,OAAO,OAAO,IAAI,KAAK;AAE/B,cAAQ,YAAY;AAAA,QAClB,KAAK;AAAA,QACL,KAAK;AACH,gBAAM,SAAS;AACf;AAAA,QAEF,KAAK;AACH,gBAAM,UAAU;AAChB;AAAA,QAEF,KAAK;AAAA,QACL,KAAK;AACH,gBAAM,SAAS,CAAC;AAChB,mBAASC,KAAI,GAAGA,KAAI,QAAQ,QAAQA,MAAK;AACvC,kBAAM,OAAOA,EAAC,IAAI,KAAK,OAAO,IAAI,KAAK,KAAK;AAAA,UAC9C;AACA;AAAA,QAEF,KAAK;AACH,gBAAM,WAAW;AACjB;AAAA,QAEF,KAAK;AACH,gBAAM,UAAU;AAChB,gBAAM,YAAY;AAClB;AAAA,QAEF,KAAK;AACH,gBAAM,YAAY;AAClB,gBAAM,gBAAgB;AACtB;AAAA,QAEF,KAAK;AACH,gBAAM,SAAS;AACf,gBAAM,YAAY;AAClB;AAAA,QAEF,KAAK;AACH,gBAAM,WAAW,CAAC;AAElB,mBAASA,KAAI,GAAGA,KAAI,KAAK,MAAM,QAAQ,SAAS,GAAG,GAAGA,MAAK;AACzD,kBAAM,SAAS,KAAK;AAAA,cAClB,GAAG,KAAK,MAAM,KAAK,OAAO,IAAI,KAAK;AAAA,cACnC,GAAG,KAAK,MAAM,KAAK,OAAO,IAAI,MAAM;AAAA,cACpC,YAAY,KAAK,OAAO;AAAA,cACxB,OAAO,OAAO,KAAK,OAAO,IAAI;AAAA,YAChC,CAAC;AAAA,UACH;AACA;AAAA,MACJ;AAAA,IACF;AAAA;AAAA;AAAA;AAAA,IAKA,KAAK,YAAY,OAAO;AACtB,YAAM,EAAE,OAAO,cAAc,IAAI,KAAK;AAEtC,cAAQ,YAAY;AAAA,QAClB,KAAK;AACH,gBAAM,UAAU;AAChB,cAAI,MAAM,UAAU,EAAE,iBAAiB,QAAQ;AAC7C,kBAAM,SAAS;AAAA,UACjB;AACA;AAAA,QAEF,KAAK;AACH,gBAAM,UAAU;AAChB,cAAI,MAAM,WAAW,iBAAiB,QAAQ;AAC5C,kBAAM,SAAS,CAAC;AAAA,UAClB;AACA;AAAA,QAEF,KAAK;AACH,gBAAM,UAAU,CAAC,MAAM;AACvB;AAAA,QAEF,KAAK;AACH,gBAAM,YAAY,MAAM,WAAW,KAAK;AACxC;AAAA,QAEF,KAAK;AACH,gBAAM,WAAW,MAAM,YAAY;AACnC,cAAI,MAAM,WAAW,GAAG;AACtB,kBAAM,UAAU;AAChB,kBAAM,YAAY;AAAA,UACpB,WAAW,MAAM,WAAW,GAAG;AAC7B,kBAAM,UAAU;AAChB,kBAAM,YAAY;AAAA,UACpB;AACA;AAAA,QAEF,KAAK;AACH,cAAI,MAAM,OAAO,MAAM,GAAG;AACxB,kBAAM;AAAA,UACR;AACA,gBAAM,gBAAgB,MAAM,OAAO,KAAK;AACxC;AAAA,QAEF,KAAK;AACH,gBAAM,UAAU,MAAM;AACtB,gBAAM,YAAY,KAAK,IAAI,IAAI,iBAAiB,SAAS,KAAK;AAC9D,cAAI,MAAM,UAAU,WAAW;AAC7B,kBAAM,SAAS;AACf,kBAAM,YAAY;AAAA,UACpB,WAAW,MAAM,UAAU,GAAG;AAC5B,kBAAM,SAAS;AACf,kBAAM,YAAY;AAAA,UACpB;AACA;AAAA,QAEF,KAAK;AAEH,qBAAW,WAAW,MAAM,UAAU;AACpC,oBAAQ,cAAc,QAAQ;AAC9B,gBAAI,QAAQ,aAAa,GAAG;AAC1B,sBAAQ,aAAa;AACrB,sBAAQ,IAAI,KAAK,MAAM,KAAK,OAAO,IAAI,KAAK;AAC5C,sBAAQ,IAAI,KAAK,MAAM,KAAK,OAAO,IAAI,KAAK,SAAS,MAAM;AAAA,YAC7D;AAAA,UACF;AACA;AAAA,MACJ;AAAA,IACF;AAAA;AAAA;AAAA;AAAA,IAKA,OAAO,YAAY,OAAO,QAAQ,gBAAgB,eAAe;AAC/D,YAAM,EAAE,OAAO,OAAO,IAAI,KAAK;AAC/B,YAAM,YAAY,kBAAkB,UAAU,CAAC;AAC/C,YAAM,gBAAgB,UAAU,CAAC;AACjC,YAAM,WAAW,iBAAiB;AAElC,eAAS,IAAI,GAAG,IAAI,QAAQ,KAAK;AAC/B,iBAAS,IAAI,GAAG,IAAI,OAAO,KAAK;AAC9B,cAAI;AACJ,cAAI,UAAU;AAGd,cAAI,eAAe,gBAAgB,eAAe,gBAAgB,eAAe,UAAU;AACzF,sBAAU,KAAK,MAAM,UAAU;AAC/B,mBAAO,UAAU;AAAG,yBAAW;AAC/B,mBAAO,WAAW;AAAU,yBAAW;AACvC,oBAAQ,UAAU,IAAI,WAAW,OAAO,KAAK;AAAA,UAC/C,WAAW,eAAe,cAAc;AAEtC,kBAAM,YAAY;AAClB,kBAAM,QAAQ,MAAM,aAAa,KAAK;AACtC,gBAAI,IAAI,MAAM;AACZ,sBAAQ,cAAc,IAAI,QAAQ,CAAC,KAAK;AAAA,YAC1C,WAAW,MAAM,QAAQ,MAAM,eAAe;AAC5C,sBAAQ;AAAA,YACV,OAAO;AACL,sBAAQ;AAAA,YACV;AAAA,UACF,OAAO;AACL,oBAAQ,cAAc,IAAI,QAAQ,CAAC,KAAK;AAAA,UAC1C;AAGA,cAAI,CAACC,IAAG,GAAG,CAAC,IAAI,KAAK,UAAU,KAAK;AACpC,gBAAM,QAAQA,KAAI,MAAM,IAAI,MAAM,IAAI;AAGtC,cAAI,OAAO;AACT,oBAAQ,YAAY;AAAA,cAClB,KAAK;AACH,oBAAI,CAAC,MAAM,SAAS;AAClB,kBAAAA,KAAI,IAAI,IAAI;AAAA,gBACd;AACA;AAAA,cAEF,KAAK,QAAQ;AACX,sBAAM,QAAQ,MAAM,SAAS,IAAI,QAAQ,CAAC,KAAK;AAC/C,sBAAM,OAAO,MAAM,QAAQ;AAC3B,sBAAM,SAAS,MAAM,MAAM,KAAK,IAAI,KAAK,IAAI,QAAQ,OAAO,GAAG,CAAC;AAChE,gBAAAA,MAAK;AACL,qBAAK;AACL,qBAAK;AACL;AAAA,cACF;AAAA,cAEA,KAAK,UAAU;AACb,sBAAM,QAAQ,MAAM,SAAS,IAAI,QAAQ,CAAC,KAAK;AAC/C,sBAAM,OAAO,MAAM,QAAQ;AAC3B,sBAAM,SAAS,MAAM,MAAM,KAAK,IAAI,KAAK,IAAI,QAAQ,OAAO,OAAO,IAAI,GAAG,CAAC;AAC3E,gBAAAA,MAAK;AACL,qBAAK;AACL,qBAAK;AACL;AAAA,cACF;AAAA,cAEA,KAAK,SAAS;AACZ,sBAAM,MAAM,MAAM,YAAY;AAC9B,sBAAM,OAAO,KAAK,IAAI,IAAI,GAAG;AAC7B,sBAAM,SAAS,OAAO,IAAI,IAAI;AAC9B,gBAAAA,MAAK;AACL,qBAAK;AACL,qBAAK;AACL;AAAA,cACF;AAAA,cAEA,KAAK,QAAQ;AACX,sBAAM,UAAU,MAAM,WAAW;AACjC,gBAAAA,MAAK;AACL,qBAAK;AACL,qBAAK;AACL;AAAA,cACF;AAAA,YACF;AAAA,UACF;AAGA,cAAI,eAAe,aAAa,MAAM,UAAU;AAC9C,uBAAW,WAAW,MAAM,UAAU;AACpC,kBAAI,QAAQ,MAAM,KAAK,QAAQ,MAAM,GAAG;AACtC,sBAAM,mBAAmB,KAAK,IAAI,QAAQ,aAAa,KAAK,EAAE;AAC9D,gBAAAA,KAAI,KAAK,IAAI,KAAKA,KAAI,mBAAmB,GAAG;AAC5C,oBAAI,KAAK,IAAI,KAAK,IAAI,mBAAmB,GAAG;AAC5C,oBAAI,KAAK,IAAI,KAAK,IAAI,mBAAmB,GAAG;AAAA,cAC9C;AAAA,YACF;AAAA,UACF;AAEA,eAAK,SAAS,SAAS,GAAG,GAAG,CAACA,IAAG,GAAG,CAAC,CAAC;AAAA,QACxC;AAAA,MACF;AAAA,IACF;AAAA;AAAA;AAAA;AAAA,IAKA,UAAU,KAAK;AACb,UAAI,CAAC,OAAO,QAAQ,UAAU,QAAQ;AAAQ,eAAO,CAAC,IAAI,IAAI,EAAE;AAChE,UAAI,QAAQ;AAAW,eAAO,CAAC,GAAG,GAAG,CAAC;AAEtC,YAAM,SAAS,4CAA4C,KAAK,GAAG;AACnE,aAAO,SACH,CAAC,SAAS,OAAO,CAAC,GAAG,EAAE,GAAG,SAAS,OAAO,CAAC,GAAG,EAAE,GAAG,SAAS,OAAO,CAAC,GAAG,EAAE,CAAC,IAC1E,CAAC,IAAI,IAAI,EAAE;AAAA,IACjB;AAAA,EACF;;;AC7PA,WAAS,SAASC,IAAGC,IAAG,GAAG;AACzB,QAAIC,IAAG,GAAG;AACV,UAAMC,KAAI,KAAK,MAAMH,KAAI,CAAC;AAC1B,UAAM,IAAIA,KAAI,IAAIG;AAClB,UAAM,IAAI,KAAK,IAAIF;AACnB,UAAM,IAAI,KAAK,IAAI,IAAIA;AACvB,UAAMG,KAAI,KAAK,KAAK,IAAI,KAAKH;AAE7B,YAAQE,KAAI,GAAG;AAAA,MACb,KAAK;AAAG,QAAAD,KAAI;AAAG,YAAIE;AAAG,YAAI;AAAG;AAAA,MAC7B,KAAK;AAAG,QAAAF,KAAI;AAAG,YAAI;AAAG,YAAI;AAAG;AAAA,MAC7B,KAAK;AAAG,QAAAA,KAAI;AAAG,YAAI;AAAG,YAAIE;AAAG;AAAA,MAC7B,KAAK;AAAG,QAAAF,KAAI;AAAG,YAAI;AAAG,YAAI;AAAG;AAAA,MAC7B,KAAK;AAAG,QAAAA,KAAIE;AAAG,YAAI;AAAG,YAAI;AAAG;AAAA,MAC7B,KAAK;AAAG,QAAAF,KAAI;AAAG,YAAI;AAAG,YAAI;AAAG;AAAA,IAC/B;AAEA,WAAO,CAACA,KAAI,KAAK,IAAI,KAAK,IAAI,GAAG;AAAA,EACnC;AAKO,MAAM,iBAAN,MAAqB;AAAA,IAC1B,YAAY,UAAU;AACpB,WAAK,WAAW;AAAA,IAClB;AAAA;AAAA;AAAA;AAAA,IAKA,KAAK,YAAY,OAAO;AACtB,YAAM,EAAE,OAAO,OAAO,IAAI,KAAK;AAE/B,cAAQ,YAAY;AAAA,QAClB,KAAK;AACH,gBAAM,WAAW;AACjB;AAAA,QAEF,KAAK;AAEH,gBAAM,aAAa;AAAA,YACjB,CAAC,GAAG,KAAK,CAAC;AAAA;AAAA,YACV,CAAC,GAAG,KAAK,GAAG;AAAA;AAAA,YACZ,CAAC,KAAK,GAAG,GAAG;AAAA;AAAA,UACd;AACA,gBAAM,YAAY,WAAW,KAAK,MAAM,KAAK,OAAO,IAAI,WAAW,MAAM,CAAC;AAE1E,gBAAM,SAAS,CAAC;AAChB,mBAAS,IAAI,GAAG,IAAI,QAAQ,KAAK;AAC/B,kBAAM,OAAO,KAAK,MAAM,KAAK,EAAE,KAAK,IAAI,EAAE,IAAI,MAAM,CAAC,GAAG,GAAG,CAAC,CAAC,CAAC;AAAA,UAChE;AACA;AAAA,QAEF,KAAK;AACH,gBAAM,OAAO;AACb;AAAA,QAEF,KAAK;AACH,gBAAM,OAAO;AACb;AAAA,QAEF,KAAK;AAEH,gBAAM,OAAO,CAAC;AACd,mBAASC,KAAI,GAAGA,KAAI,QAAQ,QAAQA,MAAK;AACvC,kBAAM,KAAKA,EAAC,IAAI;AAAA,UAClB;AAEA,gBAAM,UAAU,KAAK,mBAAmB;AACxC;AAAA,QAEF,KAAK;AAEH,gBAAM,UAAU,CAAC;AACjB,gBAAM,WAAW,CAAC;AAClB,mBAASA,KAAI,GAAGA,KAAI,QAAQ,QAAQA,MAAK;AACvC,kBAAM,QAAQA,EAAC,IAAI;AACnB,kBAAM,SAASA,EAAC,IAAI;AAAA,UACtB;AACA,gBAAM,UAAU;AAChB;AAAA,QAEF,KAAK;AAEH,gBAAM,QAAQ,CAAC;AACf,gBAAM,WAAW,KAAK,MAAM,QAAQ,SAAS,IAAI;AACjD,mBAASA,KAAI,GAAGA,KAAI,UAAUA,MAAK;AACjC,kBAAM,MAAM,KAAK;AAAA,cACf,GAAG,KAAK,MAAM,KAAK,OAAO,IAAI,KAAK;AAAA,cACnC,GAAG,KAAK,MAAM,KAAK,OAAO,IAAI,MAAM;AAAA,cACpC,YAAY,KAAK,OAAO;AAAA,cACxB,OAAO,OAAO,KAAK,OAAO,IAAI;AAAA,cAC9B,OAAO,KAAK,OAAO,IAAI,KAAK,KAAK;AAAA,YACnC,CAAC;AAAA,UACH;AACA;AAAA,QAEF,KAAK;AAEH,gBAAM,YAAY,CAAC;AACnB,mBAASA,KAAI,GAAGA,KAAI,IAAIA,MAAK;AAC3B,kBAAM,UAAU,KAAK,KAAK,wBAAwB,OAAO,QAAQ,IAAI,CAAC;AAAA,UACxE;AACA;AAAA,QAGF,KAAK;AACH,gBAAM,OAAO;AACb;AAAA,QAEF,KAAK;AACH,gBAAM,OAAO;AACb;AAAA,QAEF,KAAK;AACH,gBAAM,OAAO;AACb;AAAA,QAEF,KAAK;AACH,gBAAM,OAAO;AAEb,gBAAM,QAAQ,CAAC;AACf,mBAASA,KAAI,GAAGA,KAAI,QAAQ,QAAQA,MAAK;AACvC,kBAAM,MAAMA,EAAC,IAAI,KAAK,OAAO,IAAI,KAAK,KAAK;AAAA,UAC7C;AACA;AAAA,QAEF,KAAK;AACH,gBAAM,OAAO;AACb;AAAA,MACJ;AAAA,IACF;AAAA;AAAA;AAAA;AAAA,IAKA,KAAK,YAAY,OAAO;AACtB,YAAM,EAAE,OAAO,OAAO,IAAI,KAAK;AAE/B,cAAQ,YAAY;AAAA,QAClB,KAAK;AACH,gBAAM,YAAY,MAAM,WAAW,QAAQ;AAC3C;AAAA,QAEF,KAAK;AACH,eAAK,YAAY,OAAO,OAAO,MAAM;AACrC;AAAA,QAEF,KAAK;AAAA,QACL,KAAK;AACH,gBAAM,QAAQ,MAAM,QAAQ,KAAK;AACjC;AAAA,QAEF,KAAK;AACH,eAAK,UAAU,OAAO,OAAO,MAAM;AACnC;AAAA,QAEF,KAAK;AACH,eAAK,WAAW,OAAO,OAAO,MAAM;AACpC;AAAA,QAEF,KAAK;AAEH,qBAAW,QAAQ,MAAM,OAAO;AAC9B,iBAAK,SAAS,KAAK;AAAA,UACrB;AACA;AAAA,QAEF,KAAK;AAEH,mBAASA,KAAI,GAAGA,KAAI,MAAM,UAAU,QAAQA,MAAK;AAC/C,kBAAM,IAAI,MAAM,UAAUA,EAAC;AAC3B,cAAE,KAAK,EAAE;AACT,cAAE,KAAK,EAAE;AACT,cAAE,YAAY,EAAE;AAGhB,gBAAI,EAAE,IAAI,QAAQ;AAChB,oBAAM,UAAUA,EAAC,IAAI,KAAK,wBAAwB,OAAO,QAAQ,KAAK;AAAA,YACxE;AAAA,UACF;AACA;AAAA,QAGF,KAAK;AAAA,QACL,KAAK;AAAA,QACL,KAAK;AAAA,QACL,KAAK;AAAA,QACL,KAAK;AACH,gBAAM,QAAQ,MAAM,QAAQ,KAAK;AACjC;AAAA,MACJ;AAAA,IACF;AAAA;AAAA;AAAA;AAAA,IAKA,OAAO,YAAY,OAAO;AACxB,cAAQ,YAAY;AAAA,QAClB,KAAK;AACH,eAAK,eAAe,KAAK;AACzB;AAAA,QACF,KAAK;AACH,eAAK,cAAc,KAAK;AACxB;AAAA,QACF,KAAK;AACH,eAAK,cAAc,KAAK;AACxB;AAAA,QACF,KAAK;AACH,eAAK,gBAAgB,KAAK;AAC1B;AAAA,QACF,KAAK;AACH,eAAK,YAAY,KAAK;AACtB;AAAA,QACF,KAAK;AACH,eAAK,aAAa,KAAK;AACvB;AAAA,QACF,KAAK;AACH,eAAK,aAAa,KAAK;AACvB;AAAA,QACF,KAAK;AACH,eAAK,gBAAgB,KAAK;AAC1B;AAAA,QAGF,KAAK;AACH,eAAK,kBAAkB,KAAK;AAC5B;AAAA,QACF,KAAK;AACH,eAAK,mBAAmB,KAAK;AAC7B;AAAA,QACF,KAAK;AACH,eAAK,gBAAgB,KAAK;AAC1B;AAAA,QACF,KAAK;AACH,eAAK,YAAY,KAAK;AACtB;AAAA,QACF,KAAK;AACH,eAAK,cAAc,KAAK;AACxB;AAAA,MACJ;AAAA,IACF;AAAA;AAAA,IAIA,eAAe,OAAO;AACpB,YAAM,EAAE,OAAO,OAAO,IAAI,KAAK;AAC/B,YAAM,WAAW,MAAM,YAAY;AAEnC,eAAS,IAAI,GAAG,IAAI,OAAO,KAAK;AAC9B,cAAM,OAAO,WAAW,IAAI,SAAS;AACrC,cAAM,CAACD,IAAG,GAAG,CAAC,IAAI,SAAS,KAAK,GAAG,GAAG;AACtC,iBAAS,IAAI,GAAG,IAAI,QAAQ,KAAK;AAC/B,eAAK,SAAS,SAAS,GAAG,GAAG,CAACA,IAAG,GAAG,CAAC,CAAC;AAAA,QACxC;AAAA,MACF;AAAA,IACF;AAAA,IAEA,YAAY,OAAO,OAAO,QAAQ;AAChC,YAAM,SAAS,MAAM;AACrB,YAAM,YAAY,MAAM;AACxB,YAAM,aAAa;AAGnB,aAAO,IAAI;AACX,YAAM,SAAS,OAAO,CAAC,EAAE,IAAI,CAAC,CAACA,IAAG,GAAG,CAAC,MAAM;AAAA,QAC1CA,MAAK,IAAI;AAAA,QACT,KAAK,IAAI;AAAA,QACT,KAAK,IAAI;AAAA,MACX,CAAC;AACD,aAAO,QAAQ,KAAK,MAAM,KAAK,UAAU,MAAM,CAAC,CAAC;AAGjD,eAAS,IAAI,GAAG,IAAI,OAAO,KAAK;AAC9B,YAAI,KAAK,OAAO,IAAI,MAAM;AACxB,iBAAO,CAAC,EAAE,CAAC,IAAI;AAAA,YACb,KAAK,MAAM,KAAK,OAAO,IAAI,UAAU,CAAC,CAAC;AAAA,YACvC,KAAK,MAAM,KAAK,OAAO,IAAI,UAAU,CAAC,CAAC;AAAA,YACvC,KAAK,MAAM,KAAK,OAAO,IAAI,UAAU,CAAC,CAAC;AAAA,UACzC;AAAA,QACF;AAAA,MACF;AAAA,IACF;AAAA,IAEA,cAAc,OAAO;AACnB,YAAM,EAAE,OAAO,OAAO,IAAI,KAAK;AAC/B,YAAM,SAAS,MAAM;AACrB,UAAI,CAAC;AAAQ;AAEb,eAAS,IAAI,GAAG,IAAI,QAAQ,KAAK;AAC/B,iBAAS,IAAI,GAAG,IAAI,OAAO,KAAK;AAC9B,gBAAM,CAACA,IAAG,GAAG,CAAC,IAAI,OAAO,CAAC,IAAI,CAAC,KAAK,CAAC,GAAG,GAAG,CAAC;AAC5C,eAAK,SAAS,SAAS,GAAG,GAAG,CAACA,IAAG,GAAG,CAAC,CAAC;AAAA,QACxC;AAAA,MACF;AAAA,IACF;AAAA,IAEA,cAAc,OAAO;AACnB,YAAM,EAAE,OAAO,OAAO,IAAI,KAAK;AAC/B,YAAM,OAAO,MAAM,QAAQ;AAC3B,YAAM,UAAU,QAAQ;AACxB,YAAM,UAAU,SAAS;AAEzB,eAAS,IAAI,GAAG,IAAI,OAAO,KAAK;AAC9B,iBAAS,IAAI,GAAG,IAAI,QAAQ,KAAK;AAC/B,gBAAM,KAAK,IAAI;AACf,gBAAM,KAAK,IAAI;AACf,gBAAM,OAAO,KAAK,KAAK,KAAK,KAAK,KAAK,EAAE;AAExC,gBAAM,KAAK,KAAK,IAAI,IAAI,IAAI,IAAI;AAChC,gBAAM,KAAK,KAAK,IAAI,IAAI,IAAI,OAAO,GAAG;AACtC,gBAAM,KAAK,KAAK,IAAI,OAAO,IAAI,OAAO,GAAG;AACzC,gBAAM,KAAK,KAAK,KAAK,IAAI,KAAK,KAAK,OAAO,GAAG;AAE7C,gBAAM,SAAS,KAAK,KAAK,KAAK,KAAK,KAAK;AAExC,gBAAMA,KAAI,KAAK,IAAI,QAAQ,KAAK,KAAK,CAAC,IAAI,MAAM;AAChD,gBAAM,IAAI,KAAK,IAAI,QAAQ,KAAK,KAAK,IAAI,CAAC,IAAI,MAAM;AACpD,gBAAM,IAAI,KAAK,IAAI,QAAQ,KAAK,KAAK,IAAI,CAAC,IAAI,MAAM;AAEpD,eAAK,SAAS,SAAS,GAAG,GAAG,CAACA,KAAI,KAAK,IAAI,KAAK,IAAI,GAAG,CAAC;AAAA,QAC1D;AAAA,MACF;AAAA,IACF;AAAA,IAEA,gBAAgB,OAAO;AACrB,YAAM,EAAE,OAAO,OAAO,IAAI,KAAK;AAC/B,YAAM,OAAO,MAAM,QAAQ;AAC3B,YAAME,KAAI,OAAO;AAEjB,eAAS,IAAI,GAAG,IAAI,OAAO,KAAK;AAC9B,iBAAS,IAAI,GAAG,IAAI,QAAQ,KAAK;AAC/B,gBAAMF,MAAK,KAAK,KAAK,IAAIE,MAAK,IAAI,IAAI,MAAM,OAAO;AACnD,gBAAM,KAAK,KAAK,KAAK,IAAIA,MAAK,IAAI,IAAI,MAAM,OAAO;AACnD,gBAAM,KAAK,KAAK,KAAK,IAAI,IAAIA,MAAK,IAAI,IAAI,MAAM,OAAO;AAEvD,eAAK,SAAS,SAAS,GAAG,GAAG,CAACF,IAAG,GAAG,CAAC,CAAC;AAAA,QACxC;AAAA,MACF;AAAA,IACF;AAAA,IAEA,qBAAqB;AACnB,YAAM,UAAU,CAAC;AACjB,eAASC,KAAI,GAAGA,KAAI,KAAKA,MAAK;AAC5B,YAAID,IAAG,GAAG;AACV,YAAIC,KAAI,IAAI;AACV,UAAAD,KAAIC,KAAI;AACR,cAAI;AACJ,cAAI;AAAA,QACN,WAAWA,KAAI,KAAK;AAClB,UAAAD,KAAI;AACJ,eAAKC,KAAI,MAAM;AACf,cAAI;AAAA,QACN,WAAWA,KAAI,KAAK;AAClB,UAAAD,KAAI;AACJ,cAAI;AACJ,eAAKC,KAAI,OAAO;AAAA,QAClB,OAAO;AACL,UAAAD,KAAI;AACJ,cAAI;AACJ,cAAI;AAAA,QACN;AACA,gBAAQ,KAAK,CAACA,IAAG,GAAG,CAAC,CAAC;AAAA,MACxB;AACA,aAAO;AAAA,IACT;AAAA,IAEA,UAAU,OAAO,OAAO,QAAQ;AAC9B,YAAM,OAAO,MAAM;AAGnB,eAASC,KAAI,GAAGA,KAAI,QAAQ,QAAQA,MAAK;AACvC,aAAKA,EAAC,IAAI,KAAK,IAAI,GAAG,KAAKA,EAAC,IAAI,KAAK,OAAO,IAAI,EAAE;AAAA,MACpD;AAGA,eAAS,IAAI,GAAG,IAAI,SAAS,GAAG,KAAK;AACnC,iBAAS,IAAI,GAAG,IAAI,OAAO,KAAK;AAC9B,gBAAM,MAAM,IAAI,QAAQ;AACxB,gBAAM,SAAS,IAAI,KAAK,QAAQ;AAChC,gBAAM,OAAO,IAAI,QAAQ,KAAK,IAAI,GAAG,IAAI,CAAC;AAC1C,gBAAM,QAAQ,IAAI,QAAQ,KAAK,IAAI,QAAQ,GAAG,IAAI,CAAC;AAEnD,eAAK,GAAG,KAAK,KAAK,KAAK,IAAI,KAAK,IAAI,IAAI,KAAK,KAAK,KAAK;AAAA,QACzD;AAAA,MACF;AAGA,eAAS,IAAI,GAAG,IAAI,OAAO,KAAK;AAC9B,YAAI,KAAK,OAAO,IAAI,KAAK;AACvB,gBAAM,SAAS,KAAK,QAAQ,CAAC,IAAI,MAAM,KAAK,OAAO,IAAI;AAAA,QACzD;AAAA,MACF;AAAA,IACF;AAAA,IAEA,YAAY,OAAO;AACjB,YAAM,EAAE,OAAO,OAAO,IAAI,KAAK;AAC/B,YAAM,OAAO,MAAM;AACnB,YAAM,UAAU,MAAM;AAEtB,eAAS,IAAI,GAAG,IAAI,QAAQ,KAAK;AAC/B,iBAAS,IAAI,GAAG,IAAI,OAAO,KAAK;AAC9B,gBAAM,MAAM,IAAI,QAAQ;AACxB,gBAAMH,KAAI,KAAK,MAAM,KAAK,IAAI,KAAK,KAAK,GAAG,CAAC,CAAC;AAC7C,gBAAM,CAACE,IAAG,GAAG,CAAC,IAAI,QAAQF,EAAC;AAC3B,eAAK,SAAS,SAAS,GAAG,GAAG,CAACE,IAAG,GAAG,CAAC,CAAC;AAAA,QACxC;AAAA,MACF;AAAA,IACF;AAAA,IAEA,WAAW,OAAO,OAAO,QAAQ;AAC/B,YAAM,EAAE,SAAS,UAAU,QAAQ,IAAI;AAGvC,YAAM,OAAO,CAAC,GAAG,QAAQ;AACzB,eAASC,KAAI,GAAGA,KAAI,QAAQ,QAAQA,MAAK;AACvC,iBAASA,EAAC,IAAI,QAAQA,EAAC;AAAA,MACzB;AAGA,eAAS,IAAI,GAAG,IAAI,SAAS,GAAG,KAAK;AACnC,iBAAS,IAAI,GAAG,IAAI,QAAQ,GAAG,KAAK;AAClC,gBAAM,MAAM,IAAI,QAAQ;AACxB,kBAAQ,GAAG,KACT,MAAM,IAAI,KAAK,QAAQ,CAAC,IACxB,MAAM,IAAI,KAAK,QAAQ,CAAC,IACxB,KAAK,IAAI,SAAS,IAAI,EAAE,IACxB,KAAK,IAAI,SAAS,IAAI,EAAE,KACtB,IAAI,QAAQ,GAAG;AACnB,kBAAQ,GAAG,KAAK;AAAA,QAClB;AAAA,MACF;AAGA,UAAI,KAAK,OAAO,IAAI,KAAK;AACvB,cAAM,IAAI,KAAK,MAAM,KAAK,OAAO,KAAK,QAAQ,EAAE,IAAI;AACpD,cAAM,IAAI,KAAK,MAAM,KAAK,OAAO,KAAK,SAAS,EAAE,IAAI;AACrD,gBAAQ,IAAI,QAAQ,CAAC,IAAI;AAAA,MAC3B;AAAA,IACF;AAAA,IAEA,aAAa,OAAO;AAClB,YAAM,EAAE,OAAO,OAAO,IAAI,KAAK;AAC/B,YAAM,UAAU,MAAM;AAEtB,eAAS,IAAI,GAAG,IAAI,QAAQ,KAAK;AAC/B,iBAAS,IAAI,GAAG,IAAI,OAAO,KAAK;AAC9B,gBAAM,MAAM,IAAI,QAAQ;AACxB,gBAAM,QAAQ,KAAK,IAAI,QAAQ,GAAG,CAAC;AACnC,gBAAM,YAAY,KAAK,IAAI,KAAK,QAAQ,CAAC;AAGzC,gBAAMD,KAAI,YAAY,MAAM,YAAY;AACxC,gBAAM,IAAI,YAAY,MAAM,YAAY,MAAM,YAAY;AAC1D,gBAAM,IAAI,KAAK,IAAI,KAAK,KAAK,SAAS;AAEtC,eAAK,SAAS,SAAS,GAAG,GAAG,CAACA,IAAG,GAAG,CAAC,CAAC;AAAA,QACxC;AAAA,MACF;AAAA,IACF;AAAA,IAEA,aAAa,OAAO;AAClB,YAAM,EAAE,OAAO,OAAO,IAAI,KAAK;AAG/B,eAAS,IAAI,GAAG,IAAI,QAAQ,KAAK;AAC/B,iBAAS,IAAI,GAAG,IAAI,OAAO,KAAK;AAC9B,eAAK,SAAS,SAAS,GAAG,GAAG,CAAC,GAAG,GAAG,EAAE,CAAC;AAAA,QACzC;AAAA,MACF;AAGA,iBAAW,QAAQ,MAAM,OAAO;AAC9B,cAAM,cAAc,KAAK,IAAI,KAAK,KAAK,IAAI,MAAM,OAAO;AACxD,cAAM,IAAI,KAAK,MAAM,KAAK,CAAC;AAC3B,cAAM,IAAI,KAAK,MAAM,KAAK,CAAC;AAC3B,YAAI,KAAK,KAAK,IAAI,SAAS,KAAK,KAAK,IAAI,QAAQ;AAC/C,eAAK,SAAS,SAAS,GAAG,GAAG,CAAC,YAAY,YAAY,aAAa,GAAG,CAAC;AAAA,QACzE;AAAA,MACF;AAAA,IACF;AAAA,IAEA,wBAAwB,OAAO,QAAQ,SAAS;AAC9C,YAAM,SAAS;AAAA,QACb,CAAC,KAAK,GAAG,CAAC;AAAA;AAAA,QACV,CAAC,GAAG,KAAK,CAAC;AAAA;AAAA,QACV,CAAC,GAAG,GAAG,GAAG;AAAA;AAAA,QACV,CAAC,KAAK,KAAK,CAAC;AAAA;AAAA,QACZ,CAAC,KAAK,GAAG,GAAG;AAAA;AAAA,QACZ,CAAC,GAAG,KAAK,GAAG;AAAA;AAAA,QACZ,CAAC,KAAK,KAAK,CAAC;AAAA;AAAA,QACZ,CAAC,KAAK,KAAK,GAAG;AAAA;AAAA,MAChB;AAEA,aAAO;AAAA,QACL,GAAG,KAAK,OAAO,IAAI;AAAA,QACnB,GAAG,UAAU,KAAK,OAAO,IAAI,SAAS;AAAA,QACtC,OAAO,MAAM,KAAK,OAAO,IAAI;AAAA,QAC7B,QAAQ,KAAK,OAAO,IAAI,OAAO;AAAA,QAC/B,OAAO,OAAO,KAAK,MAAM,KAAK,OAAO,IAAI,OAAO,MAAM,CAAC;AAAA,QACvD,MAAM,IAAI,KAAK,OAAO;AAAA,QACtB,UAAU,KAAK,OAAO,IAAI,KAAK,KAAK;AAAA,QACpC,gBAAgB,KAAK,OAAO,IAAI,OAAO;AAAA,MACzC;AAAA,IACF;AAAA,IAEA,gBAAgB,OAAO;AACrB,YAAM,EAAE,OAAO,OAAO,IAAI,KAAK;AAG/B,eAAS,IAAI,GAAG,IAAI,QAAQ,KAAK;AAC/B,iBAAS,IAAI,GAAG,IAAI,OAAO,KAAK;AAC9B,eAAK,SAAS,SAAS,GAAG,GAAG,CAAC,IAAI,IAAI,EAAE,CAAC;AAAA,QAC3C;AAAA,MACF;AAGA,iBAAW,KAAK,MAAM,WAAW;AAC/B,cAAM,IAAI,KAAK,MAAM,EAAE,CAAC;AACxB,cAAM,IAAI,KAAK,MAAM,EAAE,CAAC;AAGxB,YAAI,KAAK,KAAK,IAAI,SAAS,KAAK,KAAK,IAAI,QAAQ;AAC/C,eAAK,SAAS,SAAS,GAAG,GAAG,EAAE,KAAK;AAEpC,gBAAM,UAAU,KAAK,IAAI,KAAK,IAAI,EAAE,QAAQ,CAAC,IAAI,MAAM;AACvD,gBAAM,CAACA,IAAG,GAAG,CAAC,IAAI,EAAE;AACpB,eAAK,SAAS,SAAS,GAAG,GAAG,CAACA,KAAI,SAAS,IAAI,SAAS,IAAI,OAAO,CAAC;AAAA,QACtE;AAAA,MACF;AAAA,IACF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAQA,kBAAkB,OAAO;AACvB,YAAM,EAAE,OAAO,OAAO,IAAI,KAAK;AAC/B,YAAM,OAAO,MAAM,QAAQ;AAE3B,eAAS,IAAI,GAAG,IAAI,OAAO,KAAK;AAC9B,iBAAS,IAAI,GAAG,IAAI,QAAQ,KAAK;AAE/B,gBAAM,MAAM,IAAI;AAChB,gBAAM,MAAM,IAAI;AAGhB,gBAAM,IAAI,KAAK,IAAI,MAAM,KAAO,IAAI,IAC1B,KAAK,IAAI,MAAM,KAAO,IAAI,IAC1B,KAAK,KAAK,MAAM,OAAO,KAAO,IAAI,IAClC,KAAK,IAAI,KAAK,MAAM,MAAM,QAAQ,KAAK,MAAM,QAAQ,CAAC,IAAI,KAAO,OAAO,CAAG;AAGrF,gBAAMA,KAAI,KAAK,IAAI,IAAI,KAAK,EAAE,IAAI,MAAM;AACxC,gBAAM,IAAI,KAAK,IAAI,IAAI,KAAK,KAAK,KAAK,IAAI,MAAM;AAChD,gBAAM,IAAI,KAAK,IAAI,IAAI,KAAK,KAAK,KAAK,IAAI,MAAM;AAEhD,eAAK,SAAS,SAAS,GAAG,GAAG,CAACA,KAAI,KAAK,IAAI,KAAK,IAAI,GAAG,CAAC;AAAA,QAC1D;AAAA,MACF;AAAA,IACF;AAAA;AAAA;AAAA;AAAA,IAKA,mBAAmB,OAAO;AACxB,YAAM,EAAE,OAAO,OAAO,IAAI,KAAK;AAC/B,YAAM,OAAO,MAAM,QAAQ;AAC3B,YAAM,UAAU,QAAQ;AACxB,YAAM,UAAU,SAAS;AAEzB,eAAS,IAAI,GAAG,IAAI,OAAO,KAAK;AAC9B,iBAAS,IAAI,GAAG,IAAI,QAAQ,KAAK;AAC/B,gBAAM,KAAK,IAAI;AACf,gBAAM,KAAK,IAAI;AACf,gBAAM,OAAO,KAAK,KAAK,KAAK,KAAK,KAAK,EAAE;AAGxC,gBAAM,OAAO,KAAK,IAAI,OAAO,MAAM,OAAO,CAAG,IAAI,MAAM;AACvD,gBAAM,QAAQ,KAAK,IAAI,OAAO,CAAG,IAAI,MAAM;AAG3C,gBAAM,OAAO,OAAO,KAAK,OAAO,OAAO;AACvC,gBAAM,CAACA,IAAG,GAAG,CAAC,IAAI,SAAS,KAAK,KAAK,OAAO,KAAK;AAEjD,eAAK,SAAS,SAAS,GAAG,GAAG,CAACA,IAAG,GAAG,CAAC,CAAC;AAAA,QACxC;AAAA,MACF;AAAA,IACF;AAAA;AAAA;AAAA;AAAA,IAKA,gBAAgB,OAAO;AACrB,YAAM,EAAE,OAAO,OAAO,IAAI,KAAK;AAC/B,YAAM,OAAO,MAAM,QAAQ;AAC3B,YAAM,UAAU,QAAQ;AACxB,YAAM,UAAU,SAAS;AAEzB,eAAS,IAAI,GAAG,IAAI,OAAO,KAAK;AAC9B,iBAAS,IAAI,GAAG,IAAI,QAAQ,KAAK;AAC/B,gBAAM,KAAK,IAAI;AACf,gBAAM,KAAK,IAAI;AACf,gBAAM,OAAO,KAAK,KAAK,KAAK,KAAK,KAAK,EAAE;AACxC,gBAAM,QAAQ,KAAK,MAAM,IAAI,EAAE;AAG/B,gBAAM,SAAS,KAAK,IAAI,QAAQ,IAAM,OAAO,MAAM,OAAO,CAAG;AAC7D,gBAAM,YAAa,SAAS,MAAM;AAGlC,gBAAMA,KAAI,aAAa,KAAK,IAAI,IAAI,IAAI,MAAM;AAC9C,gBAAM,IAAI,aAAa,KAAK,IAAI,OAAO,KAAK,IAAI,MAAM;AACtD,gBAAM,IAAI,aAAa,KAAK,IAAI,OAAO,KAAK,IAAI,MAAM;AAEtD,eAAK,SAAS,SAAS,GAAG,GAAG,CAACA,KAAI,KAAK,IAAI,KAAK,IAAI,GAAG,CAAC;AAAA,QAC1D;AAAA,MACF;AAAA,IACF;AAAA;AAAA;AAAA;AAAA,IAKA,YAAY,OAAO;AACjB,YAAM,EAAE,OAAO,OAAO,IAAI,KAAK;AAC/B,YAAM,OAAO,MAAM,QAAQ;AAE3B,eAAS,IAAI,GAAG,IAAI,OAAO,KAAK;AAC9B,iBAAS,IAAI,GAAG,IAAI,QAAQ,KAAK;AAC/B,gBAAM,MAAM,IAAI;AAChB,gBAAM,MAAM,IAAI;AAGhB,gBAAM,KAAK,KAAK,IAAI,MAAM,IAAM,OAAO,GAAG,IAAI,KAAK,IAAI,MAAM,IAAM,OAAO,GAAG;AAC7E,gBAAM,KAAK,KAAK,IAAI,MAAM,KAAO,OAAO,GAAG,IAAI,KAAK,IAAI,MAAM,KAAO,OAAO,GAAG;AAC/E,gBAAM,KAAK,KAAK,KAAK,MAAM,OAAO,IAAM,IAAI;AAE5C,gBAAM,SAAS,KAAK,KAAK,KAAK,KAAK;AAGnC,cAAIA,IAAG,GAAG;AACV,cAAI,QAAQ,KAAK;AACf,YAAAA,KAAI,QAAQ,IAAI;AAChB,gBAAI;AACJ,gBAAI;AAAA,UACN,WAAW,QAAQ,KAAK;AACtB,YAAAA,KAAI,OAAO,QAAQ,OAAO,IAAI;AAC9B,iBAAK,QAAQ,OAAO,IAAI;AACxB,gBAAI;AAAA,UACN,OAAO;AACL,YAAAA,KAAI;AACJ,gBAAI,OAAO,QAAQ,OAAO,MAAM;AAChC,iBAAK,QAAQ,OAAO,MAAM;AAAA,UAC5B;AAEA,eAAK,SAAS,SAAS,GAAG,GAAG,CAACA,IAAG,GAAG,CAAC,CAAC;AAAA,QACxC;AAAA,MACF;AAAA,IACF;AAAA;AAAA;AAAA;AAAA,IAKA,cAAc,OAAO;AACnB,YAAM,EAAE,OAAO,OAAO,IAAI,KAAK;AAC/B,YAAM,OAAO,MAAM,QAAQ;AAE3B,eAAS,IAAI,GAAG,IAAI,OAAO,KAAK;AAC9B,iBAAS,IAAI,GAAG,IAAI,QAAQ,KAAK;AAC/B,gBAAM,MAAM,IAAI;AAChB,gBAAM,MAAM,IAAI;AAGhB,gBAAM,QAAQ,KAAK,IAAI,MAAM,IAAM,IAAI,IAAI;AAC3C,gBAAM,QAAQ,KAAK,IAAI,MAAM,IAAM,OAAO,GAAG,IAAI;AACjD,gBAAM,QAAQ,KAAK,IAAI,MAAM,IAAM,OAAO,GAAG,IAAI;AAEjD,gBAAM,WAAW,MAAM,QAAQ,QAAQ;AACvC,gBAAM,eAAe,KAAK,IAAI,MAAM,QAAQ;AAG5C,gBAAM,YAAY,KAAK,IAAI,GAAG,IAAI,eAAe,CAAC;AAClD,gBAAM,OAAO,KAAK,IAAI,WAAW,GAAG;AAGpC,gBAAM,aAAa,KAAK,IAAI,MAAM,IAAM,OAAO,GAAG;AAClD,gBAAMA,KAAI,QAAQ,MAAM,aAAa,OAAO;AAC5C,gBAAM,IAAI,QAAQ,MAAM,KAAK,IAAI,OAAO,GAAG,IAAI,OAAO;AACtD,gBAAM,IAAI,QAAQ,MAAM,aAAa,OAAO;AAG5C,gBAAM,aAAa,KAAK,IAAI,IAAI,QAAQ,IAAI,KAAK,IAAI,MAAM;AAC3D,gBAAM,cAAc,KAAK,IAAI,OAAO,IAAI,IAAI,CAAC,IAAI,MAAM;AAEvD,cAAI,SAASA;AACb,cAAI,SAAS;AACb,cAAI,SAAS;AAEb,cAAI,aAAa,QAAQ,YAAY,KAAK;AACxC,kBAAM,aAAa,cAAc;AACjC,qBAAS,KAAK,IAAIA,IAAG,UAAU;AAC/B,qBAAS,KAAK,IAAI,GAAG,UAAU;AAC/B,qBAAS,KAAK,IAAI,GAAG,aAAa,GAAG;AAAA,UACvC;AAEA,eAAK,SAAS,SAAS,GAAG,GAAG,CAAC,QAAQ,QAAQ,MAAM,CAAC;AAAA,QACvD;AAAA,MACF;AAAA,IACF;AAAA,EACF;;;ACxsBA,WAASG,UAASC,IAAGC,IAAG,GAAG;AACzB,QAAIC,IAAG,GAAG;AACV,UAAMC,KAAI,KAAK,MAAMH,KAAI,CAAC;AAC1B,UAAM,IAAIA,KAAI,IAAIG;AAClB,UAAM,IAAI,KAAK,IAAIF;AACnB,UAAM,IAAI,KAAK,IAAI,IAAIA;AACvB,UAAMG,KAAI,KAAK,KAAK,IAAI,KAAKH;AAE7B,YAAQE,KAAI,GAAG;AAAA,MACb,KAAK;AAAG,QAAAD,KAAI;AAAG,YAAIE;AAAG,YAAI;AAAG;AAAA,MAC7B,KAAK;AAAG,QAAAF,KAAI;AAAG,YAAI;AAAG,YAAI;AAAG;AAAA,MAC7B,KAAK;AAAG,QAAAA,KAAI;AAAG,YAAI;AAAG,YAAIE;AAAG;AAAA,MAC7B,KAAK;AAAG,QAAAF,KAAI;AAAG,YAAI;AAAG,YAAI;AAAG;AAAA,MAC7B,KAAK;AAAG,QAAAA,KAAIE;AAAG,YAAI;AAAG,YAAI;AAAG;AAAA,MAC7B,KAAK;AAAG,QAAAF,KAAI;AAAG,YAAI;AAAG,YAAI;AAAG;AAAA,IAC/B;AAEA,WAAO,CAACA,KAAI,KAAK,IAAI,KAAK,IAAI,GAAG;AAAA,EACnC;AAKO,MAAM,eAAN,MAAmB;AAAA,IACxB,YAAY,UAAU;AACpB,WAAK,WAAW;AAAA,IAClB;AAAA;AAAA;AAAA;AAAA,IAKA,KAAK,YAAY,OAAO;AACtB,cAAQ,YAAY;AAAA,QAClB,KAAK;AACH,gBAAM,MAAM;AACZ;AAAA,QAEF,KAAK;AACH,gBAAM,SAAS;AACf;AAAA,QAEF,KAAK;AACH,gBAAM,gBAAgB;AACtB,gBAAM,YAAY;AAClB,gBAAM,YAAY,MAAM,WAAW;AACnC;AAAA,MACJ;AAAA,IACF;AAAA;AAAA;AAAA;AAAA,IAKA,KAAK,YAAY,OAAO;AACtB,cAAQ,YAAY;AAAA,QAClB,KAAK;AACH,gBAAM,OAAO,MAAM,MAAM,QAAQ;AACjC;AAAA,QAEF,KAAK;AACH,gBAAM,UAAU,MAAM,SAAS,QAAQ;AACvC;AAAA,QAEF,KAAK;AACH,gBAAM,iBAAiB,MAAM,YAAY;AACzC,cAAI,MAAM,iBAAiB,GAAG;AAC5B,kBAAM,gBAAgB;AACtB,kBAAM,YAAY;AAAA,UACpB,WAAW,MAAM,iBAAiB,KAAK;AACrC,kBAAM,gBAAgB;AACtB,kBAAM,YAAY;AAAA,UACpB;AACA;AAAA,MACJ;AAAA,IACF;AAAA;AAAA;AAAA;AAAA,IAKA,OAAO,YAAY,OAAO,QAAQ;AAChC,YAAM,EAAE,OAAO,OAAO,IAAI,KAAK;AAC/B,YAAM,gBAAgB,UAAU,CAAC;AAEjC,eAAS,IAAI,GAAG,IAAI,QAAQ,KAAK;AAC/B,iBAAS,IAAI,GAAG,IAAI,OAAO,KAAK;AAC9B,gBAAM,QAAQ,cAAc,IAAI,QAAQ,CAAC,KAAK;AAC9C,cAAI,CAACA,IAAG,GAAG,CAAC,IAAI,KAAK,UAAU,KAAK;AACpC,gBAAM,QAAQA,KAAI,MAAM,IAAI,MAAM,IAAI;AAEtC,cAAI,OAAO;AACT,oBAAQ,YAAY;AAAA,cAClB,KAAK,eAAe;AAElB,sBAAM,CAAC,IAAI,IAAI,EAAE,IAAIH,UAAS,MAAM,KAAK,GAAG,GAAG;AAE/C,sBAAM,cAAcG,KAAI,IAAI,MAAM,IAAI;AACtC,gBAAAA,KAAI,KAAK;AACT,oBAAI,KAAK;AACT,oBAAI,KAAK;AACT;AAAA,cACF;AAAA,cAEA,KAAK,gBAAgB;AAEnB,sBAAM,OAAO,MAAM,SAAS,IAAI,SAAS;AACzC,sBAAM,CAAC,IAAI,IAAI,EAAE,IAAIH,UAAS,KAAK,GAAG,GAAG;AAEzC,sBAAM,cAAcG,KAAI,IAAI,MAAM,IAAI;AACtC,gBAAAA,KAAI,KAAK;AACT,oBAAI,KAAK;AACT,oBAAI,KAAK;AACT;AAAA,cACF;AAAA,cAEA,KAAK,QAAQ;AAEX,sBAAM,YAAY,KAAK,UAAU,MAAM,aAAa,SAAS;AAC7D,sBAAM,YAAY,MAAM,iBAAiB;AAGzC,gBAAAA,KAAI,UAAU,CAAC,IAAI;AACnB,oBAAI,UAAU,CAAC,IAAI;AACnB,oBAAI,UAAU,CAAC,IAAI;AAGnB,oBAAI,YAAY,KAAK;AACnB,wBAAM,YAAY,YAAY,OAAO;AACrC,kBAAAA,KAAIA,MAAK,MAAMA,MAAK,WAAW;AAC/B,sBAAI,KAAK,MAAM,KAAK,WAAW;AAC/B,sBAAI,KAAK,MAAM,KAAK,WAAW;AAAA,gBACjC;AACA;AAAA,cACF;AAAA,YACF;AAAA,UACF;AAEA,eAAK,SAAS,SAAS,GAAG,GAAG,CAACA,IAAG,GAAG,CAAC,CAAC;AAAA,QACxC;AAAA,MACF;AAAA,IACF;AAAA;AAAA;AAAA;AAAA,IAKA,UAAU,KAAK;AACb,UAAI,CAAC,OAAO,QAAQ,UAAU,QAAQ;AAAQ,eAAO,CAAC,IAAI,IAAI,EAAE;AAChE,UAAI,QAAQ;AAAW,eAAO,CAAC,GAAG,GAAG,CAAC;AAEtC,YAAM,SAAS,4CAA4C,KAAK,GAAG;AACnE,aAAO,SACH,CAAC,SAAS,OAAO,CAAC,GAAG,EAAE,GAAG,SAAS,OAAO,CAAC,GAAG,EAAE,GAAG,SAAS,OAAO,CAAC,GAAG,EAAE,CAAC,IAC1E,CAAC,IAAI,IAAI,EAAE;AAAA,IACjB;AAAA,EACF;;;ACtJO,MAAM,oBAAoB;AAAA,IAC/B,MAAM;AAAA;AAAA,IACN,SAAS;AAAA;AAAA,IACT,OAAO;AAAA;AAAA,EACT;AAGO,MAAM,UAAU;AAAA;AAAA,IAErB,OAAO,EAAE,UAAU,kBAAkB,MAAM,MAAM,SAAS,aAAa,iBAAiB;AAAA,IACxF,YAAY,EAAE,UAAU,kBAAkB,MAAM,MAAM,eAAe,aAAa,6BAA6B;AAAA,IAC/G,YAAY,EAAE,UAAU,kBAAkB,MAAM,MAAM,gBAAgB,aAAa,6BAA6B;AAAA,IAChH,OAAO,EAAE,UAAU,kBAAkB,MAAM,MAAM,SAAS,aAAa,qBAAqB;AAAA,IAC5F,QAAQ,EAAE,UAAU,kBAAkB,MAAM,MAAM,UAAU,aAAa,yBAAyB;AAAA,IAClG,MAAM,EAAE,UAAU,kBAAkB,MAAM,MAAM,QAAQ,aAAa,iBAAiB;AAAA,IACtF,OAAO,EAAE,UAAU,kBAAkB,MAAM,MAAM,SAAS,aAAa,gBAAgB;AAAA,IACvF,MAAM,EAAE,UAAU,kBAAkB,MAAM,MAAM,QAAQ,aAAa,cAAc;AAAA,IACnF,YAAY,EAAE,UAAU,kBAAkB,MAAM,MAAM,cAAc,aAAa,+BAA+B;AAAA,IAChH,QAAQ,EAAE,UAAU,kBAAkB,MAAM,MAAM,UAAU,aAAa,8BAA8B;AAAA,IACvG,SAAS,EAAE,UAAU,kBAAkB,MAAM,MAAM,WAAW,aAAa,yBAAyB;AAAA;AAAA,IAGpG,SAAS,EAAE,UAAU,kBAAkB,SAAS,MAAM,WAAW,aAAa,uBAAuB;AAAA,IACrG,QAAQ,EAAE,UAAU,kBAAkB,SAAS,MAAM,UAAU,aAAa,sBAAsB;AAAA,IAClG,QAAQ,EAAE,UAAU,kBAAkB,SAAS,MAAM,UAAU,aAAa,uBAAuB;AAAA,IACnG,UAAU,EAAE,UAAU,kBAAkB,SAAS,MAAM,YAAY,aAAa,yBAAyB;AAAA,IACzG,MAAM,EAAE,UAAU,kBAAkB,SAAS,MAAM,QAAQ,aAAa,wBAAwB;AAAA,IAChG,OAAO,EAAE,UAAU,kBAAkB,SAAS,MAAM,SAAS,aAAa,qBAAqB;AAAA,IAC/F,OAAO,EAAE,UAAU,kBAAkB,SAAS,MAAM,SAAS,aAAa,sBAAsB;AAAA,IAChG,UAAU,EAAE,UAAU,kBAAkB,SAAS,MAAM,YAAY,aAAa,4BAA4B;AAAA;AAAA,IAE5G,aAAa,EAAE,UAAU,kBAAkB,SAAS,MAAM,eAAe,aAAa,6BAA6B;AAAA,IACnH,cAAc,EAAE,UAAU,kBAAkB,SAAS,MAAM,gBAAgB,aAAa,0BAA0B;AAAA,IAClH,UAAU,EAAE,UAAU,kBAAkB,SAAS,MAAM,YAAY,aAAa,iBAAiB;AAAA,IACjG,MAAM,EAAE,UAAU,kBAAkB,SAAS,MAAM,QAAQ,aAAa,qBAAqB;AAAA,IAC7F,QAAQ,EAAE,UAAU,kBAAkB,SAAS,MAAM,UAAU,aAAa,kBAAkB;AAAA;AAAA,IAG9F,aAAa,EAAE,UAAU,kBAAkB,OAAO,MAAM,eAAe,aAAa,uBAAuB;AAAA,IAC3G,cAAc,EAAE,UAAU,kBAAkB,OAAO,MAAM,gBAAgB,aAAa,2BAA2B;AAAA,IACjH,MAAM,EAAE,UAAU,kBAAkB,OAAO,MAAM,QAAQ,aAAa,oBAAoB;AAAA,EAC5F;AAKO,MAAM,gBAAN,MAAoB;AAAA,IACzB,YAAY,UAAU;AACpB,WAAK,WAAW;AAChB,WAAK,cAAc,IAAI,YAAY,QAAQ;AAC3C,WAAK,iBAAiB,IAAI,eAAe,QAAQ;AACjD,WAAK,eAAe,IAAI,aAAa,QAAQ;AAC7C,WAAK,gBAAgB;AACrB,WAAK,cAAc,CAAC;AAAA,IACtB;AAAA;AAAA;AAAA;AAAA,IAKA,cAAc,YAAY;AACxB,aAAO,QAAQ,UAAU,KAAK,QAAQ;AAAA,IACxC;AAAA;AAAA;AAAA;AAAA,IAKA,qBAAqB,UAAU;AAC7B,aAAO,OAAO,QAAQ,OAAO,EAC1B,OAAO,CAAC,CAAC,GAAG,IAAI,MAAM,KAAK,aAAa,QAAQ,EAChD,IAAI,CAAC,CAAC,MAAM,IAAI,OAAO,EAAE,MAAM,GAAG,KAAK,EAAE;AAAA,IAC9C;AAAA;AAAA;AAAA;AAAA,IAKA,WAAW,YAAY,UAAU,CAAC,GAAG;AACnC,YAAM,OAAO,KAAK,cAAc,UAAU;AAC1C,WAAK,gBAAgB;AACrB,WAAK,cAAc,EAAE,MAAM,GAAG,GAAG,QAAQ;AAEzC,cAAQ,KAAK,UAAU;AAAA,QACrB,KAAK,kBAAkB;AACrB,eAAK,YAAY,KAAK,YAAY,KAAK,WAAW;AAClD;AAAA,QACF,KAAK,kBAAkB;AACrB,eAAK,eAAe,KAAK,YAAY,KAAK,WAAW;AACrD;AAAA,QACF,KAAK,kBAAkB;AACrB,eAAK,aAAa,KAAK,YAAY,KAAK,WAAW;AACnD;AAAA,MACJ;AAEA,aAAO,KAAK;AAAA,IACd;AAAA;AAAA;AAAA;AAAA,IAKA,OAAO;AACL,YAAM,OAAO,KAAK,cAAc,KAAK,aAAa;AAClD,WAAK,YAAY,QAAQ,KAAK,YAAY,QAAQ,KAAK;AAEvD,cAAQ,KAAK,UAAU;AAAA,QACrB,KAAK,kBAAkB;AACrB,eAAK,YAAY,KAAK,KAAK,eAAe,KAAK,WAAW;AAC1D;AAAA,QACF,KAAK,kBAAkB;AACrB,eAAK,eAAe,KAAK,KAAK,eAAe,KAAK,WAAW;AAC7D;AAAA,QACF,KAAK,kBAAkB;AACrB,eAAK,aAAa,KAAK,KAAK,eAAe,KAAK,WAAW;AAC3D;AAAA,MACJ;AAAA,IACF;AAAA;AAAA;AAAA;AAAA,IAKA,OAAO,QAAQ,gBAAgB,eAAe;AAC5C,YAAM,OAAO,KAAK,cAAc,KAAK,aAAa;AAElD,cAAQ,KAAK,UAAU;AAAA,QACrB,KAAK,kBAAkB;AAErB,eAAK,eAAe,OAAO,KAAK,eAAe,KAAK,WAAW;AAC/D;AAAA,QACF,KAAK,kBAAkB;AAErB,eAAK,YAAY,OAAO,KAAK,eAAe,KAAK,aAAa,QAAQ,gBAAgB,aAAa;AACnG;AAAA,QACF,KAAK,kBAAkB;AAErB,eAAK,aAAa,OAAO,KAAK,eAAe,KAAK,aAAa,MAAM;AACrE;AAAA,MACJ;AAAA,IACF;AAAA;AAAA;AAAA;AAAA,IAKA,UAAU,YAAY;AACpB,aAAO,KAAK,cAAc,UAAU,EAAE,aAAa,kBAAkB;AAAA,IACvE;AAAA;AAAA;AAAA;AAAA,IAKA,eAAe,YAAY;AACzB,aAAO,eAAe;AAAA,IACxB;AAAA,EACF;AAGO,MAAM,eAAe,OAAO,QAAQ,OAAO,EAC/C,OAAO,CAAC,CAAC,GAAG,IAAI,MAAM,KAAK,aAAa,kBAAkB,IAAI,EAC9D,IAAI,CAAC,CAAC,IAAI,MAAM,IAAI;AAEhB,MAAM,kBAAkB,OAAO,QAAQ,OAAO,EAClD,OAAO,CAAC,CAAC,GAAG,IAAI,MAAM,KAAK,aAAa,kBAAkB,OAAO,EACjE,IAAI,CAAC,CAAC,IAAI,MAAM,IAAI;AAEhB,MAAM,gBAAgB,OAAO,QAAQ,OAAO,EAChD,OAAO,CAAC,CAAC,GAAG,IAAI,MAAM,KAAK,aAAa,kBAAkB,KAAK,EAC/D,IAAI,CAAC,CAAC,IAAI,MAAM,IAAI;AAEhB,MAAM,cAAc,OAAO,KAAK,OAAO;;;ACyMvC,MAAM,uBAAN,MAA2B;AAAA,IAChC,YAAY,WAAW,UAAU,CAAC,GAAG;AACnC,WAAK,YAAY;AACjB,WAAK,QAAQ,QAAQ,SAAS;AAC9B,WAAK,SAAS,QAAQ,UAAU;AAChC,WAAK,WAAW,QAAQ,YAAY;AACpC,WAAK,cAAc,QAAQ,SAAS;AAGpC,WAAK,QAAQ,QAAQ,SAAS;AAG9B,WAAK,SAAS,CAAC;AACf,WAAK,YAAY;AAGjB,WAAK,eAAe,CAAC;AACrB,WAAK,uBAAuB,CAAC;AAC7B,WAAK,gBAAgB,KAAK;AAG1B,WAAK,SAAS;AACd,WAAK,QAAQ;AACb,WAAK,cAAc;AACnB,WAAK,gBAAgB;AACrB,WAAK,aAAa;AAGlB,WAAK,UAAU;AACf,WAAK,OAAO;AACZ,WAAK,aAAa;AAClB,WAAK,cAAc;AACnB,WAAK,WAAW;AAChB,WAAK,WAAW;AAChB,WAAK,iBAAiB;AAGtB,WAAK,iBAAiB;AAGtB,WAAK,gBAAgB,IAAI,cAAc,IAAI;AAAA,IAC7C;AAAA,IAEA,cAAc;AACZ,WAAK,SAAS,CAAC;AACf,eAASG,KAAI,GAAGA,KAAI,KAAK,QAAQ,KAAK,QAAQA,MAAK;AACjD,aAAK,OAAO,KAAK,CAAC,GAAG,GAAG,CAAC,CAAC;AAAA,MAC5B;AAAA,IACF;AAAA;AAAA;AAAA;AAAA,IAKA,gBAAgB;AACd,YAAM,cAAc,KAAK,QAAQ,KAAK;AACtC,YAAM,eAAe,KAAK,SAAS,KAAK;AAGxC,WAAK,WAAW,SAAS,cAAc,KAAK;AAC5C,WAAK,SAAS,MAAM,UAAU;AAAA;AAAA;AAAA,sBAGZ,KAAK,KAAK,MAAM,KAAK,MAAM;AAAA;AAAA;AAAA;AAAA;AAO7C,UAAI,KAAK,aAAa;AACpB,aAAK,cAAc,SAAS,cAAc,QAAQ;AAClD,aAAK,YAAY,QAAQ;AACzB,aAAK,YAAY,SAAS;AAC1B,aAAK,YAAY,MAAM,UAAU;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uBAMhB,KAAK,QAAQ,GAAG;AAAA;AAAA;AAGjC,aAAK,WAAW,KAAK,YAAY,WAAW,MAAM,EAAE,OAAO,MAAM,CAAC;AAClE,aAAK,SAAS,YAAY,KAAK,WAAW;AAAA,MAC5C;AAGA,WAAK,UAAU,SAAS,cAAc,QAAQ;AAC9C,WAAK,QAAQ,QAAQ;AACrB,WAAK,QAAQ,SAAS;AACtB,WAAK,QAAQ,MAAM,UAAU;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAS7B,WAAK,OAAO,KAAK,QAAQ,WAAW,MAAM,EAAE,OAAO,MAAM,CAAC;AAC1D,WAAK,SAAS,YAAY,KAAK,OAAO;AAGtC,WAAK,aAAa,KAAK,KAAK,gBAAgB,aAAa,YAAY;AAGrE,WAAK,qBAAqB;AAG1B,WAAK,gBAAgB;AAGrB,UAAI,KAAK,aAAa,KAAK,UAAU,gBAAgB,OAAO;AAC1D,aAAK,UAAU,YAAY;AAC3B,aAAK,UAAU,YAAY,KAAK,QAAQ;AAAA,MAC1C;AAEA,WAAK,iBAAiB;AAAA,IACxB;AAAA;AAAA;AAAA;AAAA,IAKA,uBAAuB;AACrB,YAAM,QAAQ,KAAK;AACnB,YAAM,MAAM,KAAK,IAAI,GAAG,KAAK,MAAM,QAAQ,KAAK,QAAQ,CAAC;AACzD,YAAM,YAAY,QAAQ;AAC1B,YAAM,SAAS,KAAK,IAAI,GAAG,KAAK,MAAM,QAAQ,IAAI,CAAC;AAGnD,WAAK,iBAAiB,CAAC;AAEvB,eAAS,KAAK,GAAG,KAAK,OAAO,MAAM;AACjC,iBAAS,KAAK,GAAG,KAAK,OAAO,MAAM;AAEjC,cAAI,SAAS;AAEb,cAAI,KAAK,aAAa,KAAK,WAAW;AAEpC,gBAAI,KAAK,UAAU,KAAK,QAAQ;AAE9B,oBAAM,KAAK,SAAS;AACpB,oBAAM,KAAK,SAAS;AACpB,uBAAU,KAAK,KAAK,KAAK,MAAQ,SAAS;AAAA,YAC5C,WAAW,MAAM,YAAY,UAAU,KAAK,QAAQ;AAElD,oBAAM,KAAK,MAAM,YAAY,SAAS;AACtC,oBAAM,KAAK,SAAS;AACpB,uBAAU,KAAK,KAAK,KAAK,MAAQ,SAAS;AAAA,YAC5C,WAAW,KAAK,UAAU,MAAM,YAAY,QAAQ;AAElD,oBAAM,KAAK,SAAS;AACpB,oBAAM,KAAK,MAAM,YAAY,SAAS;AACtC,uBAAU,KAAK,KAAK,KAAK,MAAQ,SAAS;AAAA,YAC5C,WAAW,MAAM,YAAY,UAAU,MAAM,YAAY,QAAQ;AAE/D,oBAAM,KAAK,MAAM,YAAY,SAAS;AACtC,oBAAM,KAAK,MAAM,YAAY,SAAS;AACtC,uBAAU,KAAK,KAAK,KAAK,MAAQ,SAAS;AAAA,YAC5C,OAAO;AACL,uBAAS;AAAA,YACX;AAAA,UACF;AAEA,eAAK,eAAe,KAAK,MAAM;AAAA,QACjC;AAAA,MACF;AAAA,IACF;AAAA;AAAA;AAAA;AAAA,IAKA,kBAAkB;AAChB,YAAM,OAAO,KAAK,WAAW;AAC7B,YAAM,MAAM,IAAI,MAAM,IAAI,MAAM;AAEhC,eAASA,KAAI,GAAGA,KAAI,KAAK,QAAQA,MAAK,GAAG;AACvC,aAAKA,EAAC,IAAI;AACV,aAAKA,KAAI,CAAC,IAAI;AACd,aAAKA,KAAI,CAAC,IAAI;AACd,aAAKA,KAAI,CAAC,IAAI;AAAA,MAChB;AAAA,IACF;AAAA,IAEA,2BAA2B;AACzB,UAAI,CAAC,KAAK;AAAW,eAAO;AAE5B,UAAI,KAAK,YAAY,KAAK,SAAS,eAAe,KAAK,WAAW;AAChE,eAAO;AAAA,MACT;AAEA,UAAI,KAAK,YAAY,KAAK,UAAU,gBAAgB,OAAO;AACzD,aAAK,UAAU,YAAY;AAC3B,aAAK,UAAU,YAAY,KAAK,QAAQ;AACxC,eAAO;AAAA,MACT;AAEA,aAAO;AAAA,IACT;AAAA,IAEA,SAAS,GAAG,GAAG,OAAO;AACpB,UAAI,KAAK,KAAK,IAAI,KAAK,SAAS,KAAK,KAAK,IAAI,KAAK,QAAQ;AACzD,cAAM,MAAM,IAAI,KAAK,QAAQ;AAC7B,YAAI,MAAM,KAAK,OAAO,QAAQ;AAC5B,eAAK,OAAO,GAAG,IAAI;AAAA,QACrB;AAAA,MACF;AAAA,IACF;AAAA,IAEA,QAAQ;AACN,eAASA,KAAI,GAAGA,KAAI,KAAK,OAAO,QAAQA,MAAK;AAC3C,aAAK,OAAOA,EAAC,IAAI,CAAC,GAAG,GAAG,CAAC;AAAA,MAC3B;AAAA,IACF;AAAA;AAAA;AAAA;AAAA,IAKA,QAAQ;AACN,UAAI,CAAC,KAAK,gBAAgB;AACxB,aAAK,cAAc;AAAA,MACrB,WAAW,CAAC,KAAK,yBAAyB,GAAG;AAC3C,aAAK,cAAc;AAAA,MACrB;AAEA,YAAM,OAAO,KAAK,WAAW;AAC7B,YAAM,QAAQ,KAAK;AACnB,YAAM,cAAc,KAAK,QAAQ;AACjC,YAAM,WAAW,KAAK;AACtB,YAAM,MAAM,IAAI,MAAM,IAAI,MAAM;AAGhC,eAAS,OAAO,GAAG,OAAO,KAAK,QAAQ,QAAQ;AAC7C,iBAAS,OAAO,GAAG,OAAO,KAAK,OAAO,QAAQ;AAC5C,gBAAM,YAAY,OAAO,KAAK,QAAQ;AACtC,gBAAM,QAAQ,KAAK,OAAO,SAAS;AAEnC,cAAI,CAAC,SAAS,CAAC,MAAM,QAAQ,KAAK;AAAG;AAErC,gBAAMC,KAAI,KAAK,MAAM,MAAM,CAAC,CAAC;AAC7B,gBAAM,IAAI,KAAK,MAAM,MAAM,CAAC,CAAC;AAC7B,gBAAM,IAAI,KAAK,MAAM,MAAM,CAAC,CAAC;AAE7B,gBAAM,QAAQ,OAAO;AACrB,gBAAM,QAAQ,OAAO;AAGrB,mBAAS,KAAK,GAAG,KAAK,OAAO,MAAM;AACjC,qBAAS,KAAK,GAAG,KAAK,OAAO,MAAM;AACjC,oBAAM,cAAc,KAAK,QAAQ;AACjC,oBAAM,cAAc,QAAQ,MAAM,eAAe,QAAQ,OAAO;AAEhE,kBAAI,SAAS,WAAW,GAAG;AACzB,qBAAK,SAAS,IAAIA;AAClB,qBAAK,YAAY,CAAC,IAAI;AACtB,qBAAK,YAAY,CAAC,IAAI;AACtB,qBAAK,YAAY,CAAC,IAAI;AAAA,cACxB,OAAO;AACL,qBAAK,SAAS,IAAI;AAClB,qBAAK,YAAY,CAAC,IAAI;AACtB,qBAAK,YAAY,CAAC,IAAI;AACtB,qBAAK,YAAY,CAAC,IAAI;AAAA,cACxB;AAAA,YACF;AAAA,UACF;AAAA,QACF;AAAA,MACF;AAGA,WAAK,KAAK,aAAa,KAAK,YAAY,GAAG,CAAC;AAG5C,UAAI,KAAK,eAAe,KAAK,UAAU;AACrC,aAAK,SAAS,UAAU,KAAK,SAAS,GAAG,CAAC;AAAA,MAC5C;AAAA,IACF;AAAA,IAEA,QAAQ,QAAQ,iBAAiB,MAAM,gBAAgB,MAAM;AAC3D,WAAK,eAAe,UAAU,CAAC;AAE/B,UAAI,gBAAgB;AAClB,aAAK,uBAAuB;AAC5B,aAAK,gBAAgB,iBAAiB,KAAK;AAAA,MAC7C,OAAO;AACL,aAAK,uBAAuB,UAAU,CAAC;AACvC,aAAK,gBAAgB,KAAK;AAAA,MAC5B;AAAA,IACF;AAAA,IAEA,UAAU,QAAQ,QAAQ,IAAI;AAC5B,YAAM,aAAa,KAAK;AAExB,UAAI,KAAK,WAAW,QAAQ;AAC1B,aAAK,SAAS;AACd,aAAK,cAAc,WAAW,QAAQ,EAAE,MAAM,CAAC;AAAA,MACjD;AAEA,WAAK,QAAQ;AAEb,UAAI,cAAc,WAAW,SAAS;AACpC,aAAK,MAAM;AAAA,MACb;AAAA,IACF;AAAA,IAEA,QAAQ;AACN,UAAI,KAAK;AAAY;AACrB,WAAK,aAAa;AAClB,WAAK,gBAAgB,YAAY,IAAI;AACrC,WAAK,SAAS;AAAA,IAChB;AAAA,IAEA,OAAO;AACL,WAAK,aAAa;AAClB,UAAI,KAAK,aAAa;AACpB,6BAAqB,KAAK,WAAW;AACrC,aAAK,cAAc;AAAA,MACrB;AAAA,IACF;AAAA,IAEA,IAAI,YAAY;AACd,aAAO,KAAK;AAAA,IACd;AAAA,IAEA,WAAW;AACT,UAAI,CAAC,KAAK;AAAY;AAEtB,YAAM,MAAM,YAAY,IAAI;AAC5B,YAAM,gBAAgB,OAAO,KAAK,QAAQ,KAAK;AAE/C,UAAI,MAAM,KAAK,iBAAiB,eAAe;AAC7C,aAAK,gBAAgB;AACrB,aAAK,cAAc,KAAK;AAAA,MAC1B;AAEA,WAAK,aAAa;AAClB,WAAK,cAAc,sBAAsB,MAAM,KAAK,SAAS,CAAC;AAAA,IAChE;AAAA,IAEA,eAAe;AACb,WAAK,cAAc;AAAA,QACjB,KAAK;AAAA,QACL,KAAK;AAAA,QACL,KAAK;AAAA,MACP;AACA,WAAK,MAAM;AAAA,IACb;AAAA,IAEA,eAAe;AACb,UAAI,CAAC,KAAK,gBAAgB;AACxB,aAAK,cAAc;AAAA,MACrB;AACA,WAAK,aAAa;AAAA,IACpB;AAAA,IAEA,cAAc,OAAO,QAAQ;AAC3B,UAAI,UAAU,KAAK,SAAS,WAAW,KAAK,QAAQ;AAClD,aAAK,QAAQ;AACb,aAAK,SAAS;AACd,aAAK,gBAAgB;AACrB,aAAK,YAAY;AACjB,aAAK,iBAAiB;AAEtB,aAAK,gBAAgB,IAAI,cAAc,IAAI;AAC3C,YAAI,KAAK,WAAW,SAAS;AAC3B,eAAK,cAAc,WAAW,KAAK,QAAQ,EAAE,OAAO,KAAK,MAAM,CAAC;AAAA,QAClE;AAAA,MACF;AAAA,IACF;AAAA,IAEA,aAAa,WAAW;AACtB,UAAI,cAAc,KAAK,WAAW;AAChC,aAAK,YAAY;AACjB,YAAI,KAAK,YAAY,WAAW;AAC9B,oBAAU,YAAY;AACtB,oBAAU,YAAY,KAAK,QAAQ;AAAA,QACrC;AAAA,MACF;AAAA,IACF;AAAA,IAEA,UAAU;AACR,WAAK,KAAK;AACV,WAAK,UAAU;AACf,WAAK,OAAO;AACZ,WAAK,aAAa;AAClB,WAAK,cAAc;AACnB,WAAK,WAAW;AAChB,WAAK,WAAW;AAChB,WAAK,iBAAiB;AACtB,WAAK,iBAAiB;AAAA,IACxB;AAAA,EACF;;;ACzvBO,MAAM,qBAAqB;AAElC,MAAM,gBAAgB;AAAA,IACpB,MAAM;AAAA,IACN,MAAM;AAAA,IACN,QAAQ;AAAA,IACR,OAAO;AAAA,IACP,SAAS;AAAA,IACT,SAAS;AAAA,IACT,MAAM;AAAA,IACN,YAAY;AAAA,EACd;AAEO,WAAS,mBAAmB;AACjC,QAAI;AACF,YAAM,QAAQ,aAAa,QAAQ,kBAAkB;AACrD,UAAI,OAAO;AACT,eAAO,KAAK,MAAM,KAAK;AAAA,MACzB;AAAA,IACF,SAASC,IAAG;AACV,cAAQ,KAAK,sCAAsCA,EAAC;AAAA,IACtD;AACA,WAAO,EAAE,GAAG,cAAc;AAAA,EAC5B;AAEO,WAAS,iBAAiB,OAAO;AACtC,QAAI;AACF,mBAAa,QAAQ,oBAAoB,KAAK,UAAU,KAAK,CAAC;AAAA,IAChE,SAASA,IAAG;AACV,cAAQ,KAAK,gCAAgCA,EAAC;AAAA,IAChD;AAAA,EACF;AAGA,MAAI,CAAC,OAAO,oBAAoB;AAC9B,WAAO,qBAAqB,iBAAiB;AAAA,EAC/C;AAEO,WAAS,kBAAkB;AAChC,WAAO,OAAO;AAAA,EAChB;AAEO,WAAS,mBAAmB,SAAS;AAC1C,WAAO,qBAAqB;AAAA,MAC1B,GAAG,OAAO;AAAA,MACV,GAAG;AAAA,MACH,YAAY,KAAK,IAAI;AAAA,IACvB;AACA,qBAAiB,OAAO,kBAAkB;AAC1C,WAAO,cAAc,IAAI,YAAY,yBAAyB;AAAA,MAC5D,QAAQ,OAAO;AAAA,IACjB,CAAC,CAAC;AACF,WAAO,OAAO;AAAA,EAChB;;;AC3CA,MAAM,gBAAgB,oBAAI,IAAI;AAEvB,MAAM,oBAAN,cAAgC,eAAe;AAAA,IACpD,cAAc;AACZ,YAAM;AACN,WAAK,YAAY;AACjB,WAAK,oBAAoB;AACzB,WAAK,aAAa;AAClB,WAAK,oBAAoB;AACzB,WAAK,cAAc;AAEnB,WAAK,uBAAuB,CAACC,OAAM;AACjC,aAAK,eAAeA,GAAE,MAAM;AAAA,MAC9B;AACA,aAAO,iBAAiB,yBAAyB,KAAK,oBAAoB;AAAA,IAC5E;AAAA,IAEA,oBAAoB;AAElB,UAAI,CAAC,KAAK,aAAa;AACrB,aAAK,cAAc,YAAY,KAAK,IAAI,CAAC,IAAI,KAAK,OAAO,EAAE,SAAS,EAAE,EAAE,OAAO,GAAG,CAAC,CAAC;AAAA,MACtF;AAGA,UAAI,cAAc,IAAI,KAAK,WAAW,GAAG;AACvC,aAAK,YAAY,cAAc,IAAI,KAAK,WAAW;AAAA,MACrD;AAGA,kBAAY,gBAAgB,EAAE,EAAE,KAAK,MAAM;AACzC,YAAI,KAAK;AAAY,eAAK,eAAe,KAAK,UAAU;AAAA,MAC1D,CAAC;AACD,kBAAY,gBAAgB,EAAE;AAC9B,kBAAY,gBAAgB,EAAE;AAC9B,kBAAY,UAAU,EAAE;AACxB,kBAAY,UAAU,EAAE;AACxB,kBAAY,UAAU,EAAE;AAGxB,eAAS,cAAc;AACvB,eAAS,QAAQ;AAAA,IACnB;AAAA,IAEA,uBAAuB;AACrB,aAAO,oBAAoB,yBAAyB,KAAK,oBAAoB;AAG7E,UAAI,KAAK,aAAa,KAAK,aAAa;AACtC,aAAK,UAAU,KAAK;AACpB,sBAAc,IAAI,KAAK,aAAa,KAAK,SAAS;AAAA,MACpD;AAAA,IACF;AAAA;AAAA;AAAA;AAAA,IAKA,uBAAuB;AACrB,YAAM,CAAC,aAAa,YAAY,IAAI,KAAK,cAAc;AAGvD,UAAI,cAAc,KAAK,eAAe,KAAK,gBAAgB,IAAI;AAC7D,aAAK,oBAAoB,CAAC,aAAa,YAAY;AAEnD,YAAI;AACF,uBAAa,QAAQ,qBAAqB,KAAK,UAAU,CAAC,aAAa,YAAY,CAAC,CAAC;AAAA,QACvF,SAASA,IAAG;AAAA,QAAE;AACd,eAAO,KAAK;AAAA,MACd;AAGA,UAAI;AACF,cAAM,QAAQ,aAAa,QAAQ,mBAAmB;AACtD,YAAI,OAAO;AACT,gBAAM,SAAS,KAAK,MAAM,KAAK;AAC/B,cAAI,MAAM,QAAQ,MAAM,KAAK,OAAO,WAAW,KAAK,OAAO,CAAC,IAAI,KAAK,OAAO,CAAC,IAAI,GAAG;AAClF,iBAAK,oBAAoB;AACzB,mBAAO;AAAA,UACT;AAAA,QACF;AAAA,MACF,SAASA,IAAG;AAAA,MAAE;AAGd,UAAI,KAAK,mBAAmB;AAC1B,eAAO,KAAK;AAAA,MACd;AAGA,UAAI,KAAK,SAAS,SAAS,KAAK,SAAS,QAAQ;AAC/C,eAAO,CAAC,KAAK,QAAQ,OAAO,KAAK,QAAQ,MAAM;AAAA,MACjD;AAEA,aAAO,CAAC,eAAe,IAAI,gBAAgB,EAAE;AAAA,IAC/C;AAAA;AAAA;AAAA;AAAA,IAKA,eAAe,OAAO;AACpB,UAAI,CAAC,KAAK;AAAmB;AAE7B,YAAM,CAAC,OAAO,MAAM,IAAI,KAAK,qBAAqB;AAClD,YAAM,OAAO,KAAK,KAAK;AAGvB,UAAI,CAAC,KAAK,WAAW;AACnB,aAAK,YAAY,IAAI,qBAAkB,KAAK,mBAAmB,EAAE,OAAO,OAAO,CAAC;AAChF,YAAI,KAAK,aAAa;AACpB,wBAAc,IAAI,KAAK,aAAa,KAAK,SAAS;AAAA,QACpD;AAAA,MACF,OAAO;AAEL,aAAK,UAAU,aAAa,KAAK,iBAAiB;AAElD,YAAI,KAAK,UAAU,UAAU,SAAS,KAAK,UAAU,WAAW,QAAQ;AACtE,eAAK,UAAU,cAAc,OAAO,MAAM;AAAA,QAC5C;AAAA,MACF;AAEA,UAAI,CAAC,MAAM;AAET,aAAK,UAAU,QAAQ,CAAC,CAAC;AACzB,aAAK,UAAU,UAAU,SAAS,EAAE;AACpC,aAAK,UAAU,KAAK;AACpB,aAAK,UAAU,aAAa;AAC5B;AAAA,MACF;AAEA,YAAM,OAAO,OAAO,QAAQ;AAC5B,YAAM,SAAS,OAAO,UAAU;AAChC,YAAM,QAAQ,OAAO,SAAS;AAC9B,YAAM,UAAU,OAAO,WAAW;AAClC,YAAM,UAAU,OAAO,WAAW;AAClC,YAAM,OAAO,OAAO,QAAQ;AAC5B,YAAM,OAAO,OAAO,QAAQ;AAG5B,WAAK,aAAa;AAGlB,UAAI,cAAc;AAClB,UAAI,YAAY;AAEhB,UAAI,SAAS,SAAS;AACpB,cAAM,MAAM,oBAAI,KAAK;AACrB,sBAAc,IAAI,mBAAmB,SAAS,EAAE,MAAM,WAAW,QAAQ,WAAW,QAAQ,MAAM,CAAC;AACnG,oBAAY;AAAA,MACd,WAAW,SAAS,OAAO;AACzB,sBAAc;AACd,oBAAY;AAAA,MACd,WAAW,SAAS,UAAU;AAC5B,sBAAc;AACd,oBAAY;AAAA,MACd;AAGA,YAAM,aAAa,QAAQ,MAAM;AACjC,YAAM,YAAY,YAAY,aAAa;AAE3C,UAAI,WAAW;AAEb,aAAK,UAAU,QAAQ,CAAC,GAAG,CAAC,GAAG,KAAK;AAAA,MACtC,OAAO;AAGL,cAAM,YAAYC,cAAa,MAAM;AACrC,cAAM,aAAa,SAAS,YAAY,gBAAgB,MAAM,SAAS;AACvE,cAAM,gBAAgB,SAAS,YAAY,aAAa,IAAI;AAE5D,cAAM,YAAY,CAACC,OAAM,GAAGC,IAAG,IAAI,OAAO;AAExC,cAAI,YAAY;AACd,kBAAM,YAAY,gBAAgBD,OAAM,GAAGC,IAAG,IAAI,IAAI,IAAI;AAC1D,gBAAI;AAAW,qBAAO;AAAA,UACxB;AAEA,cAAI,eAAe;AACjB,kBAAM,eAAe,mBAAmBD,OAAM,GAAGC,IAAG,IAAI,IAAI,IAAI;AAChE,gBAAI;AAAc,qBAAO;AAAA,UAC3B;AAEA,iBAAO,aAAaD,OAAM,GAAGC,IAAG,IAAI,EAAE;AAAA,QACxC;AAEA,cAAM,kBAAkB,CAACD,OAAM,UAAUC,IAAG,IAAI,OAAO;AAErD,cAAI,YAAY;AACd,kBAAM,YAAY,sBAAsBD,OAAM,UAAUC,IAAG,IAAI,IAAI,IAAI;AACvE,gBAAI;AAAW,qBAAO;AAAA,UACxB;AAEA,cAAI,eAAe;AACjB,kBAAM,eAAe,yBAAyBD,OAAM,UAAUC,IAAG,IAAI,IAAI,IAAI;AAC7E,gBAAI;AAAc,qBAAO;AAAA,UAC3B;AAEA,iBAAO,mBAAmBD,OAAM,UAAUC,IAAG,IAAI,EAAE;AAAA,QACrD;AAKA,cAAM,iBAAiB,gBACnB,YAAY,SAAS,KACrB,YAAY,SAAS;AAEzB,cAAM,eAAe,WAAW,gBAAgB,WAAW,gBAAgB,WAAW,aAAa,iBAAiB;AAEpH,YAAI,aAAa;AAEf,gBAAM,eAAe,gBAAgB,aAAa,OAAO,QAAQ,WAAW,OAAO;AACnF,gBAAM,gBAAgB,UAAU,aAAa,OAAO,QAAQ,WAAW,OAAO;AAC9E,eAAK,UAAU,QAAQ,eAAe,aAAa,QAAQ,aAAa,KAAK;AAAA,QAC/E,OAAO;AAEL,gBAAM,SAAS,UAAU,aAAa,OAAO,QAAQ,WAAW,OAAO;AACvE,eAAK,UAAU,QAAQ,MAAM;AAAA,QAC/B;AAAA,MACF;AAGA,WAAK,UAAU,UAAU,QAAQ,KAAK;AAGtC,UAAI,WAAW,SAAS;AACtB,aAAK,UAAU,KAAK;AACpB,aAAK,UAAU,aAAa;AAAA,MAC9B,OAAO;AACL,aAAK,UAAU,MAAM;AAAA,MACvB;AAAA,IACF;AAAA,IAEA,SAAS;AACP,UAAI,CAAC,KAAK;AAAO;AAEjB,YAAM,CAAC,OAAO,MAAM,IAAI,KAAK,qBAAqB;AAClD,YAAM,OAAO,KAAK,KAAK;AACvB,YAAM,OAAO,KAAK,QAAQ,QAAQ,KAAK,UAAU,GAAG,YAAY,iBAAiB;AAGjF,YAAM,cAAc,gBAAgB;AACpC,YAAM,aAAa,KAAK,UAAU;AAClC,YAAM,aAAa,YAAY,SAAS;AACxC,YAAM,aAAa,KAAK,iBAAiB,UAAU,OAAO;AAC1D,YAAM,cAAc,YAAY,SAAS,YAAY,QAAQ;AAE7D,YAAM,cAAc,YAAY,QAAQ;AACxC,YAAM,gBAAgB,YAAY,UAAU;AAC5C,YAAM,eAAe,YAAY,SAAS;AAC1C,YAAM,UAAU,YAAY,WAAW;AACvC,YAAM,UAAU,YAAY,WAAW;AACvC,YAAM,cAAc,YAAY,QAAQ;AAGxC,YAAM,aAAa,QAAQ,aAAa;AACxC,YAAM,YAAY,YAAY,aAAa;AAG3C,YAAM,cAAc,OAAO,QAAQ,OAAO,EACvC,OAAO,CAAC,CAAC,GAAG,IAAI,MAAM,KAAK,aAAa,MAAM,EAC9C,IAAI,CAAC,CAACC,OAAM,IAAI,MAAM,kBAAkBA,KAAI,KAAK,KAAK,IAAI,WAAW,EACrE,KAAK,EAAE;AAEV,YAAM,iBAAiB,OAAO,QAAQ,OAAO,EAC1C,OAAO,CAAC,CAAC,GAAG,IAAI,MAAM,KAAK,aAAa,SAAS,EACjD,IAAI,CAAC,CAACA,OAAM,IAAI,MAAM,kBAAkBA,KAAI,KAAK,KAAK,IAAI,WAAW,EACrE,KAAK,EAAE;AAEV,YAAM,eAAe,OAAO,QAAQ,OAAO,EACxC,OAAO,CAAC,CAAC,GAAG,IAAI,MAAM,KAAK,aAAa,OAAO,EAC/C,IAAI,CAAC,CAACA,OAAM,IAAI,MAAM,kBAAkBA,KAAI,KAAK,KAAK,IAAI,WAAW,EACrE,KAAK,EAAE;AAEV,WAAK,WAAW,YAAY;AAAA,eACjB,gBAAgB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wCAgBS,OAAO,KAAK,KAAK;AAAA,gBACzC,IAAI;AAAA;AAAA,sCAEkB,OAAO,WAAW,EAAE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBAOpC,KAAK,MAAM,MAAM;AAAA;AAAA,2CAEI,OAAO,cAAc,KAAK;AAAA,kBACnD,QAAQ,kBAAkB,UAAU,8BAA8B,QAAQ,aAAa,GAAG,QAAQ,aAAa,YAAY,EAAE;AAAA;AAAA;AAAA;AAAA;AAAA;AAQ3I,WAAK,oBAAoB,KAAK,WAAW,eAAe,gBAAgB;AAGxE,WAAK,eAAe;AAAA,QAClB,MAAM;AAAA,QACN,QAAQ;AAAA,QACR,OAAO;AAAA,QACP;AAAA,QACA;AAAA,QACA,MAAM;AAAA,QACN,MAAM;AAAA,MACR,CAAC;AAED,WAAK,mBAAmB;AAAA,IAC1B;AAAA,IAEA,qBAAqB;AACnB,WAAK,WAAW,eAAe,WAAW,GAAG,iBAAiB,SAAS,MAAM;AAC3E,YAAI,WAAW,KAAK;AACpB,YAAI,CAAC,UAAU;AACb,gBAAM,KAAK,KAAK,iBAAiB,QAAQ;AACzC,cAAI,IAAI;AACN,iBAAK,kBAAkB,GAAG;AAC1B,uBAAW,GAAG;AAAA,UAChB;AAAA,QACF;AAEA,YAAI,YAAY,KAAK,MAAM,OAAO,QAAQ,GAAG;AAC3C,eAAK,MAAM,YAAY,UAAU,UAAU,EAAE,WAAW,SAAS,CAAC;AAAA,QACpE,OAAO;AACL,gBAAM,cAAc,OAAO,KAAK,KAAK,MAAM,MAAM,EAAE,OAAO,CAAAJ,OAAKA,GAAE,WAAW,SAAS,CAAC;AACtF,gBAAM,WAAW,KAAK,QAAQ,QAAQ,QAAQ,YAAY,EAAE,EAAE,QAAQ,8BAA8B,EAAE,KAAK;AAC3G,gBAAM,QAAQ,YAAY,KAAK,CAAAK,OAAKA,GAAE,SAAS,SAAS,UAAU,GAAG,EAAE,CAAC,CAAC;AACzE,cAAI,OAAO;AACT,iBAAK,kBAAkB;AACvB,iBAAK,MAAM,YAAY,UAAU,UAAU,EAAE,WAAW,MAAM,CAAC;AAAA,UACjE,OAAO;AACL,oBAAQ,KAAK,oCAAoC,KAAK,QAAQ,QAAQ,cAAc,WAAW;AAAA,UACjG;AAAA,QACF;AAAA,MACF,CAAC;AAAA,IACH;AAAA,IAEA,OAAO,mBAAmB;AAAE,aAAO,SAAS,cAAc,sBAAsB;AAAA,IAAG;AAAA,IACnF,OAAO,gBAAgB;AAAE,aAAO,EAAE,QAAQ,GAAG;AAAA,IAAG;AAAA,EAClD;;;ACxWA,MAAM,eAAe;AAAA,IACnB,EAAE,OAAO,GAAG,MAAM,oBAAoB;AAAA,IACtC,EAAE,OAAO,GAAG,MAAM,oBAAoB;AAAA,IACtC,EAAE,OAAO,GAAG,MAAM,iBAAiB;AAAA,IACnC,EAAE,OAAO,GAAG,MAAM,kBAAkB;AAAA,IACpC,EAAE,OAAO,GAAG,MAAM,iBAAiB;AAAA,IACnC,EAAE,OAAO,GAAG,MAAM,mBAAmB;AAAA,IACrC,EAAE,OAAO,GAAG,MAAM,oBAAoB;AAAA,IACtC,EAAE,OAAO,GAAG,MAAM,mBAAmB;AAAA,EACvC;AAGA,MAAM,kBAAkB;AAAA,IACtB,EAAE,OAAO,GAAG,MAAM,SAAS;AAAA,IAC3B,EAAE,OAAO,GAAG,MAAM,cAAc;AAAA,IAChC,EAAE,OAAO,GAAG,MAAM,eAAe;AAAA,IACjC,EAAE,OAAO,GAAG,MAAM,YAAY;AAAA,IAC9B,EAAE,OAAO,GAAG,MAAM,cAAc;AAAA,IAChC,EAAE,OAAO,GAAG,MAAM,QAAQ;AAAA,IAC1B,EAAE,OAAO,GAAG,MAAM,cAAc;AAAA,IAChC,EAAE,OAAO,GAAG,MAAM,SAAS;AAAA,EAC7B;AAEO,MAAM,qBAAN,cAAiC,eAAe;AAAA,IACrD,cAAc;AACZ,YAAM;AACN,WAAK,cAAc;AACnB,WAAK,YAAY;AACjB,WAAK,YAAY;AACjB,WAAK,cAAc;AACnB,WAAK,iBAAiB;AAAA,IACxB;AAAA,IAEA,SAAS;AACP,UAAI,CAAC,KAAK;AAAO;AACjB,YAAM,OAAO,KAAK,KAAK;AAGvB,YAAM,mBAAmB,KAAK,iBAAiB,UAAU,cAAc;AACvE,UAAI,kBAAkB;AACpB,aAAK,cAAc,iBAAiB,UAAU;AAAA,MAChD;AAEA,WAAK,WAAW,YAAY;AAAA,eACjB,gBAAgB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wCA0FS,OAAO,WAAW,EAAE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAsC1C,aAAa,IAAI,CAAAC,OAAK,kBAAkBA,GAAE,KAAK,IAAIA,GAAE,UAAU,KAAK,cAAc,cAAc,EAAE,IAAIA,GAAE,IAAI,WAAW,EAAE,KAAK,EAAE,CAAC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,0CAMzG,KAAK,YAAY,WAAW,EAAE;AAAA;AAAA;AAAA;AAAA,0CAI9B,KAAK,YAAY,WAAW,EAAE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBAOxD,gBAAgB,IAAI,OAAK,kBAAkB,EAAE,KAAK,IAAI,EAAE,UAAU,KAAK,iBAAiB,cAAc,EAAE,IAAI,EAAE,IAAI,WAAW,EAAE,KAAK,EAAE,CAAC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,4CAiB3G,KAAK,cAAc,WAAW,EAAE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBAS5D,CAAC,GAAE,GAAE,GAAE,GAAE,GAAE,GAAE,GAAE,GAAE,CAAC,EAAE,IAAI,CAAAC,OAAK,2CAA2CA,EAAC,KAAKA,EAAC,WAAW,EAAE,KAAK,EAAE,CAAC;AAAA;AAAA;AAAA;AAAA,gBAIpG,CAAC,GAAE,GAAE,GAAE,GAAE,GAAE,GAAE,GAAE,GAAE,GAAE,EAAE,EAAE,IAAI,CAAAA,OAAK,kDAAkDA,EAAC,SAAMA,EAAC,WAAW,EAAE,KAAK,EAAE,CAAC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AA0C3H,WAAK,wBAAwB;AAAA,IAC/B;AAAA,IAEA,0BAA0B;AAExB,WAAK,WAAW,iBAAiB,eAAe,EAAE,QAAQ,SAAO;AAC/D,YAAI,iBAAiB,SAAS,CAACC,OAAM;AACnC,gBAAM,SAASA,GAAE,cAAc,QAAQ;AACvC,cAAI,WAAW,SAAS;AACtB,kBAAM,KAAK,KAAK,iBAAiB,QAAQ;AACzC,gBAAI,IAAI;AACN,mBAAK,MAAM,YAAY,UAAU,UAAU,EAAE,WAAW,GAAG,UAAU,CAAC;AAAA,YACxE;AAAA,UACF,WAAW,WAAW,SAAS;AAC7B,+BAAmB,EAAE,MAAM,IAAI,MAAM,QAAQ,QAAQ,SAAS,OAAO,IAAI,SAAS,WAAW,SAAS,UAAU,CAAC;AACjH,iBAAK,YAAY,gBAAgB,cAAc;AAAA,UACjD,WAAW,WAAW,SAAS;AAC7B,iBAAK,oBAAoB;AAAA,UAC3B,WAAW,WAAW,QAAQ;AAC5B,iBAAK,YAAY,gBAAgB,WAAW;AAAA,UAC9C;AAAA,QACF,CAAC;AAAA,MACH,CAAC;AAGD,YAAM,SAAS,KAAK,WAAW,eAAe,YAAY;AAC1D,UAAI,QAAQ;AACV,eAAO,MAAM,YAAY,WAAW,GAAG,OAAO,KAAK,GAAG;AACtD,eAAO,iBAAiB,SAAS,CAACA,OAAM;AACtC,UAAAA,GAAE,OAAO,MAAM,YAAY,WAAW,GAAGA,GAAE,OAAO,KAAK,GAAG;AAC1D,eAAK,WAAW,eAAe,gBAAgB,EAAE,cAAc,GAAGA,GAAE,OAAO,KAAK;AAAA,QAClF,CAAC;AACD,eAAO,iBAAiB,UAAU,CAACA,OAAM;AACvC,eAAK,YAAY,gBAAgB,kBAAkB,EAAE,OAAO,SAASA,GAAE,OAAO,KAAK,EAAE,CAAC;AAAA,QACxF,CAAC;AAAA,MACH;AAGA,WAAK,WAAW,iBAAiB,aAAa,EAAE,QAAQ,SAAO;AAC7D,YAAI,iBAAiB,SAAS,CAACA,OAAM;AACnC,gBAAM,OAAOA,GAAE,cAAc,QAAQ;AACrC,gBAAM,aAAa,KAAK,iBAAiB,UAAU,OAAO;AAC1D,cAAI,YAAY;AACd,iBAAK,MAAM,YAAY,UAAU,iBAAiB,EAAE,WAAW,WAAW,WAAW,QAAQ,KAAK,CAAC;AAAA,UACrG;AAEA,gBAAM,aAAa;AAAA,YACjB,QAAQ;AAAA,YAAW,aAAa;AAAA,YAAW,SAAS;AAAA,YACpD,OAAO;AAAA,YAAW,UAAU;AAAA,UAC9B;AACA,6BAAmB;AAAA,YACjB;AAAA,YACA,SAAS,WAAW,IAAI,KAAK;AAAA,YAC7B,MAAM,SAAS,UAAU,KAAK,OAAO,oBAAoB,QAAQ;AAAA,UACnE,CAAC;AAED,eAAK,WAAW,iBAAiB,aAAa,EAAE,QAAQ,OAAK,EAAE,UAAU,OAAO,QAAQ,CAAC;AACzF,UAAAA,GAAE,cAAc,UAAU,IAAI,QAAQ;AAAA,QACxC,CAAC;AAAA,MACH,CAAC;AAGD,WAAK,WAAW,eAAe,aAAa,GAAG,iBAAiB,UAAU,CAACA,OAAM;AAC/E,aAAK,cAAc,SAASA,GAAE,OAAO,KAAK;AAAA,MAC5C,CAAC;AAED,WAAK,WAAW,eAAe,iBAAiB,GAAG,iBAAiB,SAAS,MAAM;AACjF,aAAK,oBAAoB;AAAA,MAC3B,CAAC;AAGD,WAAK,WAAW,eAAe,YAAY,GAAG,iBAAiB,SAAS,CAACA,OAAM;AAC7E,aAAK,YAAY,CAAC,KAAK;AACvB,QAAAA,GAAE,cAAc,UAAU,OAAO,UAAU,KAAK,SAAS;AAAA,MAC3D,CAAC;AAED,WAAK,WAAW,eAAe,aAAa,GAAG,iBAAiB,SAAS,CAACA,OAAM;AAC9E,aAAK,YAAY,CAAC,KAAK;AACvB,QAAAA,GAAE,cAAc,UAAU,OAAO,UAAU,KAAK,SAAS;AAAA,MAC3D,CAAC;AAGD,WAAK,WAAW,eAAe,gBAAgB,GAAG,iBAAiB,UAAU,CAACA,OAAM;AAClF,aAAK,iBAAiB,SAASA,GAAE,OAAO,KAAK;AAC7C,2BAAmB,EAAE,eAAe,KAAK,eAAe,CAAC;AACzD,aAAK,YAAY,gBAAgB,sBAAsB,EAAE,MAAM,KAAK,eAAe,CAAC;AAAA,MACtF,CAAC;AAGD,WAAK,WAAW,eAAe,aAAa,GAAG,iBAAiB,UAAU,CAACA,OAAM;AAC/E,cAAM,cAAc,SAASA,GAAE,OAAO,KAAK;AAC3C,aAAK,YAAY,gBAAgB,mBAAmB,EAAE,YAAY,CAAC;AAAA,MACrE,CAAC;AAGD,WAAK,WAAW,eAAe,oBAAoB,GAAG,iBAAiB,SAAS,CAACA,OAAM;AACrF,aAAK,cAAc,CAAC,KAAK;AACzB,QAAAA,GAAE,cAAc,UAAU,OAAO,UAAU,KAAK,WAAW;AAE3D,cAAM,mBAAmB,KAAK,iBAAiB,UAAU,cAAc;AACvE,YAAI,kBAAkB;AACpB,eAAK,MAAM,YAAY,UAAU,KAAK,cAAc,YAAY,YAAY;AAAA,YAC1E,WAAW,iBAAiB;AAAA,UAC9B,CAAC;AAAA,QACH,OAAO;AACL,eAAK,YAAY,gBAAgB,mBAAmB,EAAE,SAAS,KAAK,YAAY,CAAC;AAAA,QACnF;AAAA,MACF,CAAC;AAGD,WAAK,WAAW,iBAAiB,eAAe,EAAE,QAAQ,SAAO;AAC/D,YAAI,iBAAiB,SAAS,CAACA,OAAM;AACnC,gBAAM,SAAS,SAASA,GAAE,cAAc,QAAQ,MAAM;AACtD,eAAK,YAAY,gBAAgB,cAAc,EAAE,OAAe,CAAC;AAEjE,eAAK,WAAW,iBAAiB,eAAe,EAAE,QAAQ,OAAK,EAAE,UAAU,OAAO,QAAQ,CAAC;AAC3F,UAAAA,GAAE,cAAc,UAAU,IAAI,QAAQ;AAAA,QACxC,CAAC;AAAA,MACH,CAAC;AAGD,WAAK,WAAW,iBAAiB,eAAe,EAAE,QAAQ,SAAO;AAC/D,YAAI,iBAAiB,SAAS,CAACA,OAAM;AACnC,gBAAM,OAAO,SAASA,GAAE,cAAc,QAAQ,MAAM;AACpD,cAAI,QAAQ,sBAAsB,IAAI,GAAG,GAAG;AAC1C,iBAAK,YAAY,gBAAgB,iBAAiB,EAAE,KAAK,CAAC;AAAA,UAC5D;AAAA,QACF,CAAC;AAAA,MACH,CAAC;AAGD,WAAK,WAAW,eAAe,WAAW,GAAG,iBAAiB,UAAU,CAACA,OAAM;AAC7E,cAAM,OAAO,SAASA,GAAE,OAAO,KAAK;AACpC,2BAAmB,EAAE,UAAU,KAAK,CAAC;AACrC,aAAK,YAAY,gBAAgB,iBAAiB,EAAE,KAAK,CAAC;AAAA,MAC5D,CAAC;AAED,WAAK,WAAW,eAAe,eAAe,GAAG,iBAAiB,UAAU,MAAM;AAChF,aAAK,kBAAkB;AAAA,MACzB,CAAC;AAED,WAAK,WAAW,eAAe,eAAe,GAAG,iBAAiB,UAAU,MAAM;AAChF,aAAK,kBAAkB;AAAA,MACzB,CAAC;AAGD,WAAK,WAAW,eAAe,UAAU,GAAG,iBAAiB,UAAU,CAACA,OAAM;AAC5E,cAAM,OAAOA,GAAE,OAAO;AACtB,YAAI,SAAS,IAAI;AACf,eAAK,YAAY,gBAAgB,gBAAgB,EAAE,KAAW,CAAC;AAE/D,qBAAW,MAAM;AAAE,YAAAA,GAAE,OAAO,QAAQ;AAAA,UAAI,GAAG,GAAG;AAAA,QAChD;AAAA,MACF,CAAC;AAGD,WAAK,WAAW,eAAe,cAAc,GAAG,iBAAiB,SAAS,MAAM;AAC9E,cAAM,UAAU,KAAK,WAAW,eAAe,aAAa,GAAG;AAC/D,YAAI,WAAW,QAAQ,KAAK,GAAG;AAC7B,eAAK,YAAY,gBAAgB,oBAAoB,EAAE,UAAU,QAAQ,KAAK,EAAE,CAAC;AAAA,QACnF;AAAA,MACF,CAAC;AAGD,WAAK,WAAW,eAAe,aAAa,GAAG,iBAAiB,YAAY,CAACA,OAAM;AACjF,YAAIA,GAAE,QAAQ,SAAS;AACrB,gBAAM,UAAUA,GAAE,OAAO;AACzB,cAAI,WAAW,QAAQ,KAAK,GAAG;AAC7B,iBAAK,YAAY,gBAAgB,oBAAoB,EAAE,UAAU,QAAQ,KAAK,EAAE,CAAC;AAAA,UACnF;AAAA,QACF;AAAA,MACF,CAAC;AAAA,IACH;AAAA,IAEA,sBAAsB;AACpB,yBAAmB;AAAA,QACjB,MAAM;AAAA,QACN,MAAM;AAAA,QACN,QAAQ;AAAA,QACR,OAAO;AAAA,QACP,SAAS;AAAA,QACT,SAAS;AAAA,QACT,YAAY,KAAK;AAAA,QACjB,UAAU,KAAK;AAAA,QACf,UAAU,KAAK;AAAA,MACjB,CAAC;AACD,WAAK,YAAY,gBAAgB,kBAAkB;AAAA,QACjD,OAAO,KAAK;AAAA,QACZ,YAAY,KAAK;AAAA,QACjB,WAAW,KAAK;AAAA,MAClB,CAAC;AAAA,IACH;AAAA,IAEA,oBAAoB;AAClB,YAAM,IAAI,SAAS,KAAK,WAAW,eAAe,eAAe,GAAG,SAAS,GAAG;AAChF,YAAM,IAAI,SAAS,KAAK,WAAW,eAAe,eAAe,GAAG,SAAS,GAAG;AAChF,yBAAmB,EAAE,aAAa,GAAG,aAAa,EAAE,CAAC;AACrD,WAAK,YAAY,gBAAgB,mBAAmB,EAAE,GAAG,EAAE,CAAC;AAAA,IAC9D;AAAA,IAEA,OAAO,mBAAmB;AAAE,aAAO,SAAS,cAAc,sBAAsB;AAAA,IAAG;AAAA,IACnF,OAAO,gBAAgB;AAAE,aAAO,EAAE,QAAQ,GAAG;AAAA,IAAG;AAAA,EAClD;;;AC9cA,MAAM,gBAAgB;AAAA,IACpB,EAAE,OAAO,GAAG,MAAM,OAAO;AAAA,IACzB,EAAE,OAAO,GAAG,MAAM,eAAe;AAAA,IACjC,EAAE,OAAO,GAAG,MAAM,gBAAgB;AAAA,IAClC,EAAE,OAAO,GAAG,MAAM,gBAAgB;AAAA,IAClC,EAAE,OAAO,GAAG,MAAM,eAAe;AAAA,IACjC,EAAE,OAAO,GAAG,MAAM,gBAAgB;AAAA,IAClC,EAAE,OAAO,GAAG,MAAM,kBAAkB;AAAA,IACpC,EAAE,OAAO,GAAG,MAAM,mBAAmB;AAAA,IACrC,EAAE,OAAO,GAAG,MAAM,kBAAkB;AAAA,IACpC,EAAE,OAAO,GAAG,MAAM,eAAe;AAAA,EACnC;AAGA,MAAM,gBAAgB;AAAA,IACpB,EAAE,OAAO,GAAG,MAAM,eAAe;AAAA,IACjC,EAAE,OAAO,GAAG,MAAM,gBAAgB;AAAA,IAClC,EAAE,OAAO,GAAG,MAAM,aAAa;AAAA,IAC/B,EAAE,OAAO,GAAG,MAAM,aAAa;AAAA,IAC/B,EAAE,OAAO,GAAG,MAAM,iBAAiB;AAAA,EACrC;AAEO,MAAM,iBAAN,cAA6B,eAAe;AAAA,IACjD,cAAc;AACZ,YAAM;AACN,WAAK,aAAa;AAClB,WAAK,gBAAgB,CAAC,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,CAAC;AACrD,WAAK,uBAAuB;AAC5B,WAAK,mBAAmB;AAAA,IAC1B;AAAA;AAAA;AAAA;AAAA,IAKA,0BAA0B;AACxB,YAAM,cAAc,OAAO,QAAQ,OAAO,EACvC,OAAO,CAAC,CAAC,GAAG,IAAI,MAAM,KAAK,aAAa,kBAAkB,IAAI,EAC9D,IAAI,CAAC,CAAC,MAAM,IAAI,MAAM,kBAAkB,IAAI,KAAK,KAAK,IAAI,WAAW,EACrE,KAAK,EAAE;AAEV,YAAM,eAAe,OAAO,QAAQ,OAAO,EACxC,OAAO,CAAC,CAAC,GAAG,IAAI,MAAM,KAAK,aAAa,kBAAkB,KAAK,EAC/D,IAAI,CAAC,CAAC,MAAM,IAAI,MAAM,kBAAkB,IAAI,KAAK,KAAK,IAAI,WAAW,EACrE,KAAK,EAAE;AAEV,aAAO;AAAA;AAAA,UAED,WAAW;AAAA;AAAA;AAAA,UAGX,YAAY;AAAA;AAAA;AAAA,IAGpB;AAAA;AAAA;AAAA;AAAA,IAKA,6BAA6B;AAC3B,aAAO,OAAO,QAAQ,OAAO,EAC1B,OAAO,CAAC,CAAC,GAAG,IAAI,MAAM,KAAK,aAAa,kBAAkB,OAAO,EACjE,IAAI,CAAC,CAAC,MAAM,IAAI,MAAM,kBAAkB,IAAI,KAAK,KAAK,IAAI,WAAW,EACrE,KAAK,EAAE;AAAA,IACZ;AAAA;AAAA;AAAA;AAAA,IAKA,oBAAoB;AAClB,YAAM,WAAW,KAAK,oBAAoB;AAC1C,aAAO,OAAO,QAAQ,OAAO,EAC1B,OAAO,CAAC,CAAC,GAAG,IAAI,MAAM,KAAK,aAAa,kBAAkB,OAAO,EACjE,IAAI,CAAC,CAAC,MAAM,IAAI,MAAM;AAAA,oCACO,SAAS,WAAW,WAAW,EAAE,kBAAkB,IAAI;AAAA,YAC/E,KAAK,IAAI;AAAA;AAAA,OAEd,EACA,KAAK,EAAE;AAAA,IACZ;AAAA;AAAA;AAAA;AAAA,IAKA,uBAAuB;AACrB,aAAO,cAAc;AAAA,QAAI,UACvB,kBAAkB,KAAK,KAAK,KAAK,KAAK,IAAI;AAAA,MAC5C,EAAE,KAAK,EAAE;AAAA,IACX;AAAA;AAAA;AAAA;AAAA,IAKA,wBAAwB;AACtB,YAAM,WAAW,KAAK,wBAAwB;AAC9C,aAAO,cAAc,IAAI,WAAS;AAAA,iCACL,MAAM,UAAU,WAAW,WAAW,EAAE,iBAAiB,MAAM,KAAK;AAAA,UAC3F,MAAM,IAAI;AAAA;AAAA,KAEf,EAAE,KAAK,EAAE;AAAA,IACZ;AAAA;AAAA;AAAA;AAAA,IAKA,2BAA2B;AACzB,YAAM,SAAS,CAAC,QAAQ,QAAQ,SAAS,SAAS,SAAS,QAAQ,QAAQ,QAAQ,QAAQ,SAAS,OAAO;AAC3G,aAAO,KAAK,cAAc,IAAI,CAAC,OAAOC,OAAM;AAAA;AAAA,iBAE/B,OAAOA,EAAC,CAAC;AAAA,+DACqCA,EAAC,6BAA6B,KAAK;AAAA,mCAC/D,KAAK;AAAA;AAAA,KAEnC,EAAE,KAAK,EAAE;AAAA,IACZ;AAAA,IAEA,SAAS;AACP,UAAI,CAAC,KAAK;AAAO;AAEjB,YAAM,YAAY,KAAK,eAAe;AACtC,YAAM,eAAe,KAAK,eAAe;AACzC,YAAM,cAAc,KAAK,eAAe;AACxC,YAAM,gBAAgB,KAAK,eAAe;AAE1C,WAAK,WAAW,YAAY;AAAA,eACjB,gBAAgB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iCAmGE,YAAY,WAAW,EAAE;AAAA,iCACzB,eAAe,WAAW,EAAE;AAAA,iCAC5B,cAAc,WAAW,EAAE;AAAA,iCAC3B,gBAAgB,WAAW,EAAE;AAAA;AAAA;AAAA;AAAA,oCAI1B,YAAY,WAAW,EAAE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBAWvC,KAAK,wBAAwB,CAAC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBAQ9B,KAAK,qBAAqB,CAAC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oCAgCb,eAAe,WAAW,EAAE;AAAA;AAAA;AAAA,gBAGhD,KAAK,kBAAkB,CAAC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oCAaJ,cAAc,WAAW,EAAE;AAAA;AAAA;AAAA,gBAG/C,KAAK,sBAAsB,CAAC;AAAA;AAAA;AAAA;AAAA,gBAI5B,KAAK,yBAAyB,CAAC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oCAMX,gBAAgB,WAAW,EAAE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAyB7D,WAAK,iBAAiB;AAAA,IACxB;AAAA;AAAA;AAAA;AAAA,IAKA,qBAAqB;AACnB,aAAO;AAAA,QACL,MAAM,KAAK,WAAW,eAAe,YAAY,GAAG,SAAS;AAAA,QAC7D,QAAQ,KAAK,WAAW,eAAe,aAAa,GAAG,SAAS;AAAA,QAChE,aAAa,SAAS,KAAK,WAAW,eAAe,cAAc,GAAG,SAAS,GAAG;AAAA,QAClF,OAAO,SAAS,KAAK,WAAW,eAAe,YAAY,GAAG,SAAS,IAAI;AAAA,QAC3E,SAAS,KAAK,WAAW,eAAe,YAAY,GAAG,SAAS;AAAA,QAChE,SAAS,KAAK,WAAW,eAAe,UAAU,GAAG,SAAS;AAAA,QAC9D,MAAM,KAAK,WAAW,eAAe,aAAa,GAAG,SAAS;AAAA,MAChE;AAAA,IACF;AAAA;AAAA;AAAA;AAAA,IAKA,uBAAuB;AACrB,aAAO;AAAA,QACL,OAAO,KAAK,wBAAwB;AAAA,QACpC,QAAQ,CAAC,GAAG,KAAK,aAAa;AAAA,MAChC;AAAA,IACF;AAAA;AAAA;AAAA;AAAA,IAKA,oBAAoB;AAClB,YAAM,WAAW,KAAK,WAAW,eAAe,UAAU,GAAG,SAAS;AACtE,UAAI;AACF,eAAO,KAAK,MAAM,QAAQ;AAAA,MAC5B,SAASC,IAAG;AACV,eAAO;AAAA,MACT;AAAA,IACF;AAAA;AAAA;AAAA;AAAA,IAKA,2BAA2B;AACzB,YAAM,OAAO,KAAK,WAAW,eAAe,iBAAiB,GAAG,SAAS;AACzE,YAAM,YAAY,KAAK,WAAW,eAAe,mBAAmB,GAAG,SAAS;AAChF,YAAM,SAAS,UAAU,MAAM,GAAG,EAAE,IAAI,OAAK,EAAE,KAAK,CAAC,EAAE,OAAO,OAAK,CAAC;AACpE,aAAO,EAAE,MAAM,OAAO;AAAA,IACxB;AAAA;AAAA;AAAA;AAAA,IAKA,wBAAwB;AACtB,aAAO;AAAA,QACL,QAAQ,KAAK,oBAAoB;AAAA,QACjC,OAAO,SAAS,KAAK,WAAW,eAAe,eAAe,GAAG,SAAS,IAAI;AAAA,MAChF;AAAA,IACF;AAAA;AAAA;AAAA;AAAA,IAKA,qBAAqB;AACnB,YAAM,EAAE,MAAM,QAAQ,OAAO,SAAS,SAAS,KAAK,IAAI,KAAK,mBAAmB;AAEhF,yBAAmB;AAAA,QACjB,MAAM,QAAQ;AAAA,QACd,MAAM;AAAA,QACN;AAAA,QACA;AAAA,QACA;AAAA,QACA;AAAA,QACA;AAAA,MACF,CAAC;AAAA,IACH;AAAA;AAAA;AAAA;AAAA,IAKA,wBAAwB;AACtB,YAAM,EAAE,QAAQ,MAAM,IAAI,KAAK,sBAAsB;AAErD,yBAAmB;AAAA,QACjB,MAAM;AAAA,QACN,MAAM;AAAA,QACN;AAAA,QACA;AAAA,QACA,SAAS;AAAA,QACT,SAAS;AAAA,MACX,CAAC;AAAA,IACH;AAAA,IAEA,mBAAmB;AAEjB,WAAK,WAAW,eAAe,UAAU,GAAG,iBAAiB,SAAS,MAAM;AAC1E,aAAK,aAAa;AAClB,aAAK,OAAO;AAAA,MACd,CAAC;AAED,WAAK,WAAW,eAAe,aAAa,GAAG,iBAAiB,SAAS,MAAM;AAC7E,aAAK,aAAa;AAClB,aAAK,OAAO;AAAA,MACd,CAAC;AAED,WAAK,WAAW,eAAe,YAAY,GAAG,iBAAiB,SAAS,MAAM;AAC5E,aAAK,aAAa;AAClB,aAAK,OAAO;AAAA,MACd,CAAC;AAED,WAAK,WAAW,eAAe,cAAc,GAAG,iBAAiB,SAAS,MAAM;AAC9E,aAAK,aAAa;AAClB,aAAK,OAAO;AAAA,MACd,CAAC;AAKD,YAAM,YAAY,KAAK,WAAW,eAAe,YAAY;AAC7D,UAAI,WAAW;AACb,kBAAU,MAAM,YAAY,WAAW,GAAG,UAAU,KAAK,GAAG;AAC5D,kBAAU,iBAAiB,SAAS,CAACA,OAAM;AACzC,UAAAA,GAAE,OAAO,MAAM,YAAY,WAAW,GAAGA,GAAE,OAAO,KAAK,GAAG;AAC1D,eAAK,WAAW,eAAe,gBAAgB,EAAE,cAAcA,GAAE,OAAO;AACxE,eAAK,mBAAmB;AAAA,QAC1B,CAAC;AAAA,MACH;AAGA,WAAK,WAAW,eAAe,aAAa,GAAG,iBAAiB,UAAU,MAAM;AAC9E,aAAK,mBAAmB;AAAA,MAC1B,CAAC;AAGD,WAAK,WAAW,eAAe,cAAc,GAAG,iBAAiB,UAAU,MAAM;AAC/E,aAAK,mBAAmB;AAAA,MAC1B,CAAC;AAGD,WAAK,WAAW,eAAe,aAAa,GAAG,iBAAiB,UAAU,MAAM;AAC9E,aAAK,mBAAmB;AAAA,MAC1B,CAAC;AAGD,WAAK,WAAW,eAAe,YAAY,GAAG,iBAAiB,SAAS,MAAM;AAC5E,aAAK,mBAAmB;AAAA,MAC1B,CAAC;AACD,WAAK,WAAW,eAAe,UAAU,GAAG,iBAAiB,SAAS,MAAM;AAC1E,aAAK,mBAAmB;AAAA,MAC1B,CAAC;AAGD,WAAK,WAAW,eAAe,YAAY,GAAG,iBAAiB,SAAS,MAAM;AAC5E,aAAK,mBAAmB;AAAA,MAC1B,CAAC;AAGD,WAAK,WAAW,eAAe,UAAU,GAAG,iBAAiB,SAAS,MAAM;AAC1E,cAAM,EAAE,MAAM,QAAQ,aAAa,OAAO,SAAS,SAAS,KAAK,IAAI,KAAK,mBAAmB;AAE7F,YAAI,MAAM;AACR,6BAAmB;AAAA,YACjB;AAAA,YACA,MAAM;AAAA,YACN;AAAA,YACA;AAAA,YACA;AAAA,YACA;AAAA,YACA;AAAA,YACA;AAAA,UACF,CAAC;AAED,cAAI,KAAK,QAAQ,QAAQ;AACvB,iBAAK,MAAM,YAAY,QAAQ,aAAa;AAAA,cAC1C,WAAW,KAAK,QAAQ;AAAA,cACxB,OAAO;AAAA,YACT,CAAC;AAAA,UACH;AAGA,gBAAM,cAAc,SAAS,WAAW,WAAW;AAEnD,eAAK,YAAY,gBAAgB,gBAAgB;AAAA,YAC/C;AAAA,YACA;AAAA,YACA;AAAA,YACA,UAAU,KAAK,SAAS,OAAO;AAAA,YAC/B,UAAU,KAAK,SAAS,OAAO;AAAA,YAC/B,MAAM;AAAA,YACN,cAAc;AAAA,UAChB,CAAC;AAAA,QACH;AAAA,MACF,CAAC;AAKD,WAAK,WAAW,iBAAiB,aAAa,EAAE,QAAQ,SAAO;AAC7D,YAAI,iBAAiB,SAAS,CAACA,OAAM;AACnC,gBAAM,SAASA,GAAE,OAAO,QAAQ;AAChC,eAAK,mBAAmB;AAGxB,eAAK,WAAW,iBAAiB,aAAa,EAAE,QAAQ,OAAK,EAAE,UAAU,OAAO,QAAQ,CAAC;AACzF,UAAAA,GAAE,OAAO,UAAU,IAAI,QAAQ;AAG/B,eAAK,sBAAsB;AAAA,QAC7B,CAAC;AAAA,MACH,CAAC;AAGD,YAAM,eAAe,KAAK,WAAW,eAAe,eAAe;AACnE,UAAI,cAAc;AAChB,qBAAa,MAAM,YAAY,WAAW,GAAG,aAAa,KAAK,GAAG;AAClE,qBAAa,iBAAiB,SAAS,CAACA,OAAM;AAC5C,UAAAA,GAAE,OAAO,MAAM,YAAY,WAAW,GAAGA,GAAE,OAAO,KAAK,GAAG;AAC1D,eAAK,WAAW,eAAe,mBAAmB,EAAE,cAAcA,GAAE,OAAO;AAC3E,eAAK,sBAAsB;AAAA,QAC7B,CAAC;AAAA,MACH;AAGA,WAAK,WAAW,eAAe,mBAAmB,GAAG,iBAAiB,SAAS,MAAM;AACnF,cAAM,EAAE,QAAQ,MAAM,IAAI,KAAK,sBAAsB;AAErD,2BAAmB;AAAA,UACjB,MAAM;AAAA,UACN,MAAM;AAAA,UACN;AAAA,UACA;AAAA,UACA,SAAS;AAAA,UACT,SAAS;AAAA,QACX,CAAC;AAAA,MAIH,CAAC;AAKD,WAAK,WAAW,iBAAiB,YAAY,EAAE,QAAQ,SAAO;AAC5D,YAAI,iBAAiB,SAAS,CAACA,OAAM;AACnC,gBAAM,QAAQ,SAASA,GAAE,OAAO,QAAQ,KAAK;AAC7C,eAAK,uBAAuB;AAG5B,eAAK,WAAW,iBAAiB,YAAY,EAAE,QAAQ,OAAK,EAAE,UAAU,OAAO,QAAQ,CAAC;AACxF,UAAAA,GAAE,OAAO,UAAU,IAAI,QAAQ;AAAA,QACjC,CAAC;AAAA,MACH,CAAC;AAGD,WAAK,WAAW,iBAAiB,gBAAgB,EAAE,QAAQ,YAAU;AACnE,eAAO,iBAAiB,SAAS,CAACA,OAAM;AACtC,gBAAM,OAAO,SAASA,GAAE,OAAO,QAAQ,IAAI;AAC3C,gBAAM,QAAQ,SAASA,GAAE,OAAO,KAAK;AACrC,eAAK,cAAc,IAAI,IAAI;AAC3B,UAAAA,GAAE,OAAO,mBAAmB,cAAc;AAAA,QAC5C,CAAC;AAAA,MACH,CAAC;AAGD,WAAK,WAAW,eAAe,kBAAkB,GAAG,iBAAiB,SAAS,MAAM;AAClF,cAAM,EAAE,OAAO,OAAO,IAAI,KAAK,qBAAqB;AAEpD,2BAAmB;AAAA,UACjB,MAAM;AAAA,UACN,MAAM;AAAA,UACN,aAAa;AAAA,UACb,cAAc;AAAA,QAChB,CAAC;AAGD,aAAK,YAAY,gBAAgB,oBAAoB;AAAA,UACnD;AAAA,UACA;AAAA,QACF,CAAC;AAAA,MACH,CAAC;AAKD,WAAK,WAAW,eAAe,eAAe,GAAG,iBAAiB,SAAS,MAAM;AAC/E,cAAM,UAAU,KAAK,kBAAkB;AACvC,YAAI,CAAC,SAAS;AACZ,kBAAQ,KAAK,0BAA0B;AACvC;AAAA,QACF;AAEA,2BAAmB;AAAA,UACjB,MAAM;AAAA,UACN,MAAM;AAAA,UACN;AAAA,QACF,CAAC;AAGD,aAAK,YAAY,gBAAgB,cAAc;AAAA,UAC7C,MAAM;AAAA,QACR,CAAC;AAAA,MACH,CAAC;AAGD,WAAK,WAAW,eAAe,sBAAsB,GAAG,iBAAiB,SAAS,MAAM;AACtF,cAAM,EAAE,MAAM,OAAO,IAAI,KAAK,yBAAyB;AAEvD,YAAI,QAAQ,OAAO,SAAS,GAAG;AAC7B,6BAAmB;AAAA,YACjB;AAAA,YACA,MAAM;AAAA,YACN;AAAA,UACF,CAAC;AAGD,eAAK,YAAY,gBAAgB,2BAA2B;AAAA,YAC1D;AAAA,YACA,QAAQ,OAAO,IAAI,OAAK,KAAK,SAAS,CAAC,CAAC;AAAA,UAC1C,CAAC;AAAA,QACH;AAAA,MACF,CAAC;AAAA,IACH;AAAA,IAEA,OAAO,mBAAmB;AAAE,aAAO,SAAS,cAAc,sBAAsB;AAAA,IAAG;AAAA,IACnF,OAAO,gBAAgB;AAAE,aAAO,EAAE,QAAQ,GAAG;AAAA,IAAG;AAAA,EAClD;;;ACrpBA,MAAM,sBAAsB;AAErB,MAAM,qBAAN,cAAiC,eAAe;AAAA,IACrD,cAAc;AACZ,YAAM;AACN,WAAK,WAAW,KAAK,aAAa;AAClC,WAAK,iBAAiB;AACtB,WAAK,gBAAgB;AAAA,IACvB;AAAA,IAEA,eAAe;AACb,UAAI;AACF,cAAM,QAAQ,aAAa,QAAQ,mBAAmB;AACtD,eAAO,QAAQ,KAAK,MAAM,KAAK,IAAI,CAAC;AAAA,MACtC,SAASC,IAAG;AACV,eAAO,CAAC;AAAA,MACV;AAAA,IACF;AAAA,IAEA,eAAe;AACb,UAAI;AACF,qBAAa,QAAQ,qBAAqB,KAAK,UAAU,KAAK,QAAQ,CAAC;AAAA,MACzE,SAASA,IAAG;AACV,gBAAQ,KAAK,kCAAkCA,EAAC;AAAA,MAClD;AAAA,IACF;AAAA,IAEA,SAAS;AACP,UAAI,CAAC,KAAK;AAAO;AAEjB,WAAK,WAAW,YAAY;AAAA,eACjB,gBAAgB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cA+IjB,KAAK,SAAS,WAAW,IAAI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBAM3B,KAAK,SAAS,IAAI,CAAC,QAAQC,OAAM;AAAA,qDACIA,EAAC;AAAA,8DACQ,OAAO,WAAW,SAAS,cAAc,OAAO,WAAW,SAAS;AAAA,oBAC9G,OAAO,QAAQ,WAAI;AAAA;AAAA;AAAA,6CAGM,KAAK,YAAY,OAAO,IAAI,CAAC;AAAA,6CAC7B,OAAO,IAAI,SAAM,OAAO,UAAU,OAAO,GAAG,OAAO,OAAO,YAAS,OAAO,KAAK,UAAU,GAAG,EAAE,KAAK,OAAO,KAAK,SAAS,KAAK,QAAQ,MAAM,MAAM,EAAE;AAAA;AAAA;AAAA,wEAGxHA,EAAC;AAAA;AAAA;AAAA,4EAGGA,EAAC;AAAA;AAAA;AAAA;AAAA;AAAA,aAKhE,EAAE,KAAK,EAAE,CAAC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAWL,CAAC,aAAM,aAAM,UAAK,aAAM,aAAM,UAAK,gBAAM,aAAM,aAAM,aAAM,aAAM,aAAM,aAAM,aAAM,UAAK,WAAI,EAAE,IAAI,UAAQ;AAAA,4DAChE,SAAS,KAAK,gBAAgB,cAAc,EAAE,gBAAgB,IAAI,KAAK,IAAI;AAAA,iBACtH,EAAE,KAAK,EAAE,CAAC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAWvB,WAAK,iBAAiB;AAAA,IACxB;AAAA,IAEA,YAAY,MAAM;AAChB,YAAM,MAAM,SAAS,cAAc,KAAK;AACxC,UAAI,cAAc;AAClB,aAAO,IAAI;AAAA,IACb;AAAA,IAEA,mBAAmB;AAEjB,WAAK,WAAW,eAAe,gBAAgB,GAAG,iBAAiB,SAAS,MAAM;AAChF,aAAK,iBAAiB;AACtB,aAAK,gBAAgB;AACrB,aAAK,WAAW,eAAe,aAAa,EAAE,MAAM,UAAU;AAC9D,aAAK,WAAW,eAAe,aAAa,EAAE,QAAQ;AACtD,aAAK,WAAW,iBAAiB,cAAc,EAAE,QAAQ,CAAAC,OAAKA,GAAE,UAAU,OAAO,UAAU,CAAC;AAC5F,aAAK,WAAW,cAAc,cAAc,GAAG,UAAU,IAAI,UAAU;AAAA,MACzE,CAAC;AAGD,WAAK,WAAW,eAAe,mBAAmB,GAAG,iBAAiB,SAAS,MAAM;AACnF,aAAK,WAAW,eAAe,aAAa,EAAE,MAAM,UAAU;AAC9D,aAAK,iBAAiB;AAAA,MACxB,CAAC;AAGD,WAAK,WAAW,eAAe,iBAAiB,GAAG,iBAAiB,SAAS,MAAM;AACjF,cAAM,OAAO,KAAK,WAAW,eAAe,aAAa,EAAE,MAAM,KAAK,KAAK;AAC3E,cAAM,eAAe,KAAK,WAAW,cAAc,uBAAuB;AAC1E,cAAM,OAAO,cAAc,QAAQ,QAAQ;AAC3C,cAAM,eAAe,gBAAgB;AAErC,cAAM,SAAS;AAAA,UACb;AAAA,UACA;AAAA,UACA,MAAM,aAAa,QAAQ;AAAA,UAC3B,MAAM,aAAa,QAAQ;AAAA,UAC3B,QAAQ,aAAa,UAAU;AAAA,UAC/B,OAAO,aAAa,SAAS;AAAA,UAC7B,SAAS,aAAa,WAAW;AAAA,UACjC,SAAS,aAAa,WAAW;AAAA,UACjC,MAAM,aAAa,QAAQ;AAAA,UAC3B,aAAa,aAAa,eAAe;AAAA,UACzC,WAAW,KAAK,IAAI;AAAA,QACtB;AAEA,YAAI,KAAK,mBAAmB,MAAM;AAChC,eAAK,SAAS,KAAK,cAAc,IAAI;AAAA,QACvC,OAAO;AACL,eAAK,SAAS,KAAK,MAAM;AAAA,QAC3B;AAEA,aAAK,aAAa;AAClB,aAAK,WAAW,eAAe,aAAa,EAAE,MAAM,UAAU;AAC9D,aAAK,iBAAiB;AACtB,aAAK,OAAO;AAAA,MACd,CAAC;AAGD,WAAK,WAAW,iBAAiB,cAAc,EAAE,QAAQ,SAAO;AAC9D,YAAI,iBAAiB,SAAS,CAACF,OAAM;AACnC,eAAK,WAAW,iBAAiB,cAAc,EAAE,QAAQ,CAAAE,OAAKA,GAAE,UAAU,OAAO,UAAU,CAAC;AAC5F,UAAAF,GAAE,cAAc,UAAU,IAAI,UAAU;AACxC,eAAK,gBAAgBA,GAAE,cAAc,QAAQ;AAAA,QAC/C,CAAC;AAAA,MACH,CAAC;AAGD,WAAK,WAAW,iBAAiB,cAAc,EAAE,QAAQ,UAAQ;AAC/D,aAAK,iBAAiB,SAAS,CAACA,OAAM;AAEpC,cAAIA,GAAE,OAAO,QAAQ,iBAAiB;AAAG;AAEzC,gBAAM,QAAQ,SAAS,KAAK,QAAQ,KAAK;AACzC,gBAAM,SAAS,KAAK,SAAS,KAAK;AAClC,cAAI,QAAQ;AACV,+BAAmB;AAAA,cACjB,MAAM,OAAO;AAAA,cACb,MAAM,OAAO;AAAA,cACb,QAAQ,OAAO;AAAA,cACf,OAAO,OAAO;AAAA,cACd,SAAS,OAAO;AAAA,cAChB,SAAS,OAAO;AAAA,cAChB,MAAM,OAAO;AAAA,cACb,aAAa,OAAO;AAAA,YACtB,CAAC;AAGD,gBAAI,OAAO,SAAS,UAAU,OAAO,MAAM;AACzC,mBAAK,YAAY,gBAAgB,gBAAgB;AAAA,gBAC/C,MAAM,OAAO;AAAA,gBACb,QAAQ,OAAO;AAAA,gBACf,OAAO,OAAO;AAAA,gBACd,UAAU,KAAK,SAAS,OAAO,OAAO;AAAA,gBACtC,UAAU,KAAK,SAAS,OAAO,OAAO;AAAA,gBACtC,MAAM,OAAO;AAAA,gBACb,cAAc,OAAO;AAAA,cACvB,CAAC;AAAA,YACH;AAGA,iBAAK,WAAW,iBAAiB,cAAc,EAAE,QAAQ,OAAK,EAAE,UAAU,OAAO,QAAQ,CAAC;AAC1F,iBAAK,UAAU,IAAI,QAAQ;AAAA,UAC7B;AAAA,QACF,CAAC;AAAA,MACH,CAAC;AAGD,WAAK,WAAW,iBAAiB,sBAAsB,EAAE,QAAQ,SAAO;AACtE,YAAI,iBAAiB,SAAS,CAACA,OAAM;AACnC,UAAAA,GAAE,gBAAgB;AAClB,gBAAM,QAAQ,SAASA,GAAE,cAAc,QAAQ,KAAK;AACpD,gBAAM,SAAS,KAAK,SAAS,KAAK;AAClC,cAAI,QAAQ;AACV,iBAAK,iBAAiB;AACtB,iBAAK,gBAAgB,OAAO,QAAQ;AACpC,iBAAK,WAAW,eAAe,aAAa,EAAE,MAAM,UAAU;AAC9D,iBAAK,WAAW,eAAe,aAAa,EAAE,QAAQ,OAAO;AAC7D,iBAAK,WAAW,iBAAiB,cAAc,EAAE,QAAQ,CAAAE,OAAK;AAC5D,cAAAA,GAAE,UAAU,OAAO,YAAYA,GAAE,QAAQ,SAAS,OAAO,IAAI;AAAA,YAC/D,CAAC;AAAA,UACH;AAAA,QACF,CAAC;AAAA,MACH,CAAC;AAGD,WAAK,WAAW,iBAAiB,wBAAwB,EAAE,QAAQ,SAAO;AACxE,YAAI,iBAAiB,SAAS,CAACF,OAAM;AACnC,UAAAA,GAAE,gBAAgB;AAClB,gBAAM,QAAQ,SAASA,GAAE,cAAc,QAAQ,KAAK;AACpD,cAAI,QAAQ,qBAAqB,GAAG;AAClC,iBAAK,SAAS,OAAO,OAAO,CAAC;AAC7B,iBAAK,aAAa;AAClB,iBAAK,OAAO;AAAA,UACd;AAAA,QACF,CAAC;AAAA,MACH,CAAC;AAAA,IACH;AAAA,IAEA,OAAO,mBAAmB;AAAE,aAAO,SAAS,cAAc,sBAAsB;AAAA,IAAG;AAAA,IACnF,OAAO,gBAAgB;AAAE,aAAO,EAAE,QAAQ,GAAG;AAAA,IAAG;AAAA,EAClD;;;AC5WA,MAAM,wBAAwB;AAEvB,MAAM,qBAAN,cAAiC,eAAe;AAAA,IACrD,cAAc;AACZ,YAAM;AACN,WAAK,aAAa,KAAK,eAAe;AACtC,WAAK,iBAAiB,KAAK,mBAAmB;AAC9C,WAAK,eAAe;AACpB,WAAK,iBAAiB;AAAA,IACxB;AAAA,IAEA,oBAAoB;AAElB,WAAK,iBAAiB,YAAY,MAAM,KAAK,gBAAgB,GAAG,GAAK;AACrE,WAAK,gBAAgB;AAAA,IACvB;AAAA,IAEA,uBAAuB;AACrB,UAAI,KAAK,gBAAgB;AACvB,sBAAc,KAAK,cAAc;AAAA,MACnC;AAAA,IACF;AAAA,IAEA,iBAAiB;AACf,UAAI;AACF,cAAM,QAAQ,aAAa,QAAQ,qBAAqB;AACxD,eAAO,QAAQ,KAAK,MAAM,KAAK,IAAI,CAAC;AAAA,MACtC,SAASG,IAAG;AACV,eAAO,CAAC;AAAA,MACV;AAAA,IACF;AAAA,IAEA,iBAAiB;AACf,UAAI;AACF,qBAAa,QAAQ,uBAAuB,KAAK,UAAU,KAAK,UAAU,CAAC;AAAA,MAC7E,SAASA,IAAG;AACV,gBAAQ,KAAK,oCAAoCA,EAAC;AAAA,MACpD;AAAA,IACF;AAAA,IAEA,qBAAqB;AACnB,UAAI;AACF,cAAM,QAAQ,aAAa,QAAQ,sBAAsB;AACzD,eAAO,QAAQ,KAAK,MAAM,KAAK,IAAI,EAAE,SAAS,OAAO,QAAQ,SAAS,SAAS,QAAQ;AAAA,MACzF,SAASA,IAAG;AACV,eAAO,EAAE,SAAS,OAAO,QAAQ,SAAS,SAAS,QAAQ;AAAA,MAC7D;AAAA,IACF;AAAA,IAEA,qBAAqB;AACnB,UAAI;AACF,qBAAa,QAAQ,wBAAwB,KAAK,UAAU,KAAK,cAAc,CAAC;AAAA,MAClF,SAASA,IAAG;AACV,gBAAQ,KAAK,yCAAyCA,EAAC;AAAA,MACzD;AAAA,IACF;AAAA,IAEA,kBAAkB;AAChB,YAAM,MAAM,oBAAI,KAAK;AACrB,YAAM,cAAc,GAAG,IAAI,SAAS,EAAE,SAAS,EAAE,SAAS,GAAG,GAAG,CAAC,IAAI,IAAI,WAAW,EAAE,SAAS,EAAE,SAAS,GAAG,GAAG,CAAC;AACjH,YAAM,aAAa,IAAI,OAAO;AAG9B,iBAAW,YAAY,KAAK,YAAY;AACtC,YAAI,CAAC,SAAS;AAAS;AACvB,YAAI,SAAS,QAAQ,CAAC,SAAS,KAAK,SAAS,UAAU;AAAG;AAE1D,YAAI,SAAS,cAAc,aAAa;AAEtC,6BAAmB;AAAA,YACjB,MAAM,SAAS,QAAQ;AAAA,YACvB,MAAM,SAAS,QAAQ;AAAA,YACvB,QAAQ,SAAS,UAAU;AAAA,YAC3B,SAAS,SAAS,WAAW;AAAA,YAC7B,SAAS,SAAS,WAAW;AAAA,UAC/B,CAAC;AAED,cAAI,SAAS,SAAS,UAAU,SAAS,MAAM;AAC7C,iBAAK,YAAY,gBAAgB,gBAAgB;AAAA,cAC/C,MAAM,SAAS;AAAA,cACf,QAAQ,SAAS;AAAA,cACjB,UAAU,KAAK,SAAS,SAAS,OAAO;AAAA,cACxC,UAAU,KAAK,SAAS,SAAS,OAAO;AAAA,YAC1C,CAAC;AAAA,UACH,WAAW,SAAS,SAAS,SAAS;AACpC,iBAAK,YAAY,gBAAgB,kBAAkB,EAAE,OAAO,EAAE,CAAC;AAAA,UACjE;AAAA,QACF;AAAA,MACF;AAAA,IACF;AAAA,IAEA,SAAS;AACP,UAAI,CAAC,KAAK;AAAO;AACjB,YAAM,MAAM,oBAAI,KAAK;AACrB,YAAM,UAAW,IAAI,SAAS,IAAI,KAAK,IAAI,WAAW,KAAK,OAAQ;AACnE,YAAM,cAAc,GAAG,IAAI,SAAS,EAAE,SAAS,EAAE,SAAS,GAAG,GAAG,CAAC,IAAI,IAAI,WAAW,EAAE,SAAS,EAAE,SAAS,GAAG,GAAG,CAAC;AAGjH,YAAM,iBAAiB,KAAK,WAAW,OAAO,CAAAC,OAAKA,GAAE,OAAO,EAAE,IAAI,CAAAA,OAAK;AACrE,cAAM,YAAY,KAAK,eAAeA,GAAE,SAAS;AACjD,cAAM,UAAUA,GAAE,UAAU,KAAK,eAAeA,GAAE,OAAO,IAAI,YAAY;AACzE,cAAM,WAAY,YAAY,OAAQ;AACtC,cAAM,SAAU,UAAU,aAAa,OAAQ;AAC/C,eAAO,4CAA4C,QAAQ,aAAa,KAAK,kBAAkBA,GAAE,WAAW,SAAS,eAAeA,GAAE,QAAQ,UAAU;AAAA,MAC1J,CAAC,EAAE,KAAK,EAAE;AAEV,YAAM,WAAW,CAAC,MAAM,MAAM,MAAM,MAAM,MAAM,MAAM,IAAI;AAE1D,WAAK,WAAW,YAAY;AAAA,eACjB,gBAAgB;AAAA;AAAA;AAAA;AAAA,mGAIoE,MAAM;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,+CAyG1D,WAAW;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBAQ1C,cAAc;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,4CAQc,KAAK,eAAe,UAAU,WAAW,EAAE;AAAA;AAAA,wDAE/B,KAAK,eAAe,MAAM;AAAA;AAAA,yDAEzB,KAAK,eAAe,OAAO;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cAOtE,KAAK,WAAW,WAAW,IAAI;AAAA;AAAA;AAAA;AAAA,gBAI7B,KAAK,WAAW,IAAI,CAAC,MAAMC,OAAM;AAAA,uDACMA,EAAC;AAAA,8CACV,KAAK,UAAU,WAAW,EAAE,sCAAsCA,EAAC;AAAA;AAAA,+CAElE,KAAK,YAAY,KAAK,QAAQ,eAAeA,KAAI,EAAE,CAAC;AAAA;AAAA,sBAE7E,KAAK,SAAS,GAAG,KAAK,UAAU,QAAQ,KAAK,UAAU,EAAE;AAAA,sBACzD,KAAK,OAAO,KAAK,KAAK,IAAI,OAAK,SAAS,CAAC,CAAC,EAAE,KAAK,IAAI,IAAI,OAAO;AAAA,sBAChE,KAAK,QAAQ,MAAM;AAAA;AAAA;AAAA;AAAA,2DAIkBA,EAAC;AAAA;AAAA;AAAA,6DAGCA,EAAC;AAAA;AAAA;AAAA;AAAA;AAAA,aAKjD,EAAE,KAAK,EAAE,CAAC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAuBL,SAAS,IAAI,CAAC,MAAMA,OAAM;AAAA,6EACiCA,EAAC,KAAK,IAAI;AAAA,iBACtE,EAAE,KAAK,EAAE,CAAC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AA4CvB,WAAK,iBAAiB;AAAA,IACxB;AAAA,IAEA,eAAe,MAAM;AACnB,YAAM,CAACC,IAAG,CAAC,IAAI,KAAK,MAAM,GAAG,EAAE,IAAI,MAAM;AACzC,aAAOA,KAAI,KAAK;AAAA,IAClB;AAAA,IAEA,YAAY,MAAM;AAChB,YAAM,MAAM,SAAS,cAAc,KAAK;AACxC,UAAI,cAAc;AAClB,aAAO,IAAI;AAAA,IACb;AAAA,IAEA,mBAAmB;AAEjB,WAAK,WAAW,eAAe,cAAc,GAAG,iBAAiB,SAAS,CAACH,OAAM;AAC/E,aAAK,eAAe,UAAU,CAAC,KAAK,eAAe;AACnD,QAAAA,GAAE,cAAc,UAAU,OAAO,UAAU,KAAK,eAAe,OAAO;AAAA,MACxE,CAAC;AAGD,WAAK,WAAW,eAAe,YAAY,GAAG,iBAAiB,SAAS,MAAM;AAC5E,aAAK,eAAe,SAAS,KAAK,WAAW,eAAe,UAAU,GAAG,SAAS;AAClF,aAAK,eAAe,UAAU,KAAK,WAAW,eAAe,WAAW,GAAG,SAAS;AACpF,aAAK,mBAAmB;AAExB,aAAK,YAAY,gBAAgB,sBAAsB;AAAA,UACrD,SAAS,KAAK,eAAe;AAAA,UAC7B,SAAS,KAAK,eAAe;AAAA,UAC7B,UAAU,KAAK,eAAe;AAAA,QAChC,CAAC;AAAA,MACH,CAAC;AAGD,WAAK,WAAW,eAAe,UAAU,GAAG,iBAAiB,SAAS,MAAM;AAC1E,aAAK,eAAe;AACpB,aAAK,eAAe;AACpB,aAAK,WAAW,eAAe,WAAW,EAAE,MAAM,UAAU;AAAA,MAC9D,CAAC;AAGD,WAAK,WAAW,eAAe,aAAa,GAAG,iBAAiB,SAAS,MAAM;AAC7E,aAAK,WAAW,eAAe,WAAW,EAAE,MAAM,UAAU;AAC5D,aAAK,eAAe;AAAA,MACtB,CAAC;AAGD,WAAK,WAAW,iBAAiB,UAAU,EAAE,QAAQ,SAAO;AAC1D,YAAI,iBAAiB,SAAS,CAACA,OAAM;AACnC,UAAAA,GAAE,cAAc,UAAU,OAAO,UAAU;AAAA,QAC7C,CAAC;AAAA,MACH,CAAC;AAGD,WAAK,WAAW,eAAe,WAAW,GAAG,iBAAiB,UAAU,CAACA,OAAM;AAC7E,cAAM,UAAU,KAAK,WAAW,eAAe,UAAU;AACzD,YAAI,SAAS;AACX,kBAAQ,MAAM,UAAUA,GAAE,OAAO,UAAU,SAAS,UAAU;AAAA,QAChE;AAAA,MACF,CAAC;AAGD,WAAK,WAAW,eAAe,WAAW,GAAG,iBAAiB,SAAS,MAAM;AAC3E,cAAM,eAAe,MAAM,KAAK,KAAK,WAAW,iBAAiB,mBAAmB,CAAC,EAClF,IAAI,SAAO,SAAS,IAAI,QAAQ,GAAG,CAAC;AAEvC,cAAM,OAAO;AAAA,UACX,MAAM,KAAK,WAAW,eAAe,WAAW,GAAG,SAAS;AAAA,UAC5D,WAAW,KAAK,WAAW,eAAe,YAAY,GAAG,SAAS;AAAA,UAClE,SAAS,KAAK,WAAW,eAAe,UAAU,GAAG,SAAS;AAAA,UAC9D,MAAM,aAAa,WAAW,IAAI,OAAO;AAAA,UACzC,MAAM,KAAK,WAAW,eAAe,WAAW,GAAG,SAAS;AAAA,UAC5D,QAAQ,KAAK,WAAW,eAAe,aAAa,GAAG,SAAS;AAAA,UAChE,MAAM,KAAK,WAAW,eAAe,WAAW,GAAG,SAAS;AAAA,UAC5D,SAAS,KAAK,WAAW,eAAe,eAAe,GAAG,SAAS;AAAA,UACnE,SAAS,KAAK,WAAW,eAAe,eAAe,GAAG,SAAS;AAAA,UACnE,SAAS;AAAA,QACX;AAEA,YAAI,KAAK,iBAAiB,MAAM;AAC9B,eAAK,WAAW,KAAK,YAAY,IAAI;AAAA,QACvC,OAAO;AACL,eAAK,WAAW,KAAK,IAAI;AAAA,QAC3B;AAEA,aAAK,eAAe;AACpB,aAAK,WAAW,eAAe,WAAW,EAAE,MAAM,UAAU;AAC5D,aAAK,eAAe;AACpB,aAAK,OAAO;AAAA,MACd,CAAC;AAGD,WAAK,WAAW,iBAAiB,wBAAwB,EAAE,QAAQ,SAAO;AACxE,YAAI,iBAAiB,SAAS,CAACA,OAAM;AACnC,gBAAM,QAAQ,SAASA,GAAE,cAAc,QAAQ,KAAK;AACpD,eAAK,WAAW,KAAK,EAAE,UAAU,CAAC,KAAK,WAAW,KAAK,EAAE;AACzD,eAAK,eAAe;AACpB,UAAAA,GAAE,cAAc,UAAU,OAAO,UAAU,KAAK,WAAW,KAAK,EAAE,OAAO;AAAA,QAC3E,CAAC;AAAA,MACH,CAAC;AAGD,WAAK,WAAW,iBAAiB,sBAAsB,EAAE,QAAQ,SAAO;AACtE,YAAI,iBAAiB,SAAS,CAACA,OAAM;AACnC,gBAAM,QAAQ,SAASA,GAAE,cAAc,QAAQ,KAAK;AACpD,gBAAM,OAAO,KAAK,WAAW,KAAK;AAClC,cAAI,MAAM;AACR,iBAAK,eAAe;AACpB,iBAAK,cAAc,IAAI;AACvB,iBAAK,WAAW,eAAe,WAAW,EAAE,MAAM,UAAU;AAAA,UAC9D;AAAA,QACF,CAAC;AAAA,MACH,CAAC;AAGD,WAAK,WAAW,iBAAiB,wBAAwB,EAAE,QAAQ,SAAO;AACxE,YAAI,iBAAiB,SAAS,CAACA,OAAM;AACnC,gBAAM,QAAQ,SAASA,GAAE,cAAc,QAAQ,KAAK;AACpD,cAAI,QAAQ,uBAAuB,GAAG;AACpC,iBAAK,WAAW,OAAO,OAAO,CAAC;AAC/B,iBAAK,eAAe;AACpB,iBAAK,OAAO;AAAA,UACd;AAAA,QACF,CAAC;AAAA,MACH,CAAC;AAAA,IACH;AAAA,IAEA,iBAAiB;AACf,WAAK,WAAW,eAAe,WAAW,EAAE,QAAQ;AACpD,WAAK,WAAW,eAAe,YAAY,EAAE,QAAQ;AACrD,WAAK,WAAW,eAAe,UAAU,EAAE,QAAQ;AACnD,WAAK,WAAW,eAAe,WAAW,EAAE,QAAQ;AACpD,WAAK,WAAW,eAAe,aAAa,EAAE,QAAQ;AACtD,WAAK,WAAW,eAAe,WAAW,EAAE,QAAQ;AACpD,WAAK,WAAW,eAAe,eAAe,EAAE,QAAQ;AACxD,WAAK,WAAW,eAAe,eAAe,EAAE,QAAQ;AACxD,WAAK,WAAW,iBAAiB,UAAU,EAAE,QAAQ,SAAO,IAAI,UAAU,IAAI,UAAU,CAAC;AACzF,WAAK,WAAW,eAAe,UAAU,EAAE,MAAM,UAAU;AAAA,IAC7D;AAAA,IAEA,cAAc,MAAM;AAClB,WAAK,WAAW,eAAe,WAAW,EAAE,QAAQ,KAAK,QAAQ;AACjE,WAAK,WAAW,eAAe,YAAY,EAAE,QAAQ,KAAK,aAAa;AACvE,WAAK,WAAW,eAAe,UAAU,EAAE,QAAQ,KAAK,WAAW;AACnE,WAAK,WAAW,eAAe,WAAW,EAAE,QAAQ,KAAK,QAAQ;AACjE,WAAK,WAAW,eAAe,aAAa,EAAE,QAAQ,KAAK,UAAU;AACrE,WAAK,WAAW,eAAe,WAAW,EAAE,QAAQ,KAAK,QAAQ;AACjE,WAAK,WAAW,eAAe,eAAe,EAAE,QAAQ,KAAK,WAAW;AACxE,WAAK,WAAW,eAAe,eAAe,EAAE,QAAQ,KAAK,WAAW;AAExE,YAAM,eAAe,KAAK,QAAQ,CAAC,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,CAAC;AACtD,WAAK,WAAW,iBAAiB,UAAU,EAAE,QAAQ,SAAO;AAC1D,YAAI,UAAU,OAAO,YAAY,aAAa,SAAS,SAAS,IAAI,QAAQ,GAAG,CAAC,CAAC;AAAA,MACnF,CAAC;AAED,WAAK,WAAW,eAAe,UAAU,EAAE,MAAM,UAAU,KAAK,SAAS,SAAS,UAAU;AAAA,IAC9F;AAAA,IAEA,OAAO,mBAAmB;AAAE,aAAO,SAAS,cAAc,sBAAsB;AAAA,IAAG;AAAA,IACnF,OAAO,gBAAgB;AAAE,aAAO,EAAE,QAAQ,GAAG;AAAA,IAAG;AAAA,EAClD;;;ACnfA,MAAM,iBAAiB;AAAA,IACrB;AAAA,IAAW;AAAA,IAAW;AAAA,IAAW;AAAA,IACjC;AAAA,IAAW;AAAA,IAAW;AAAA,IAAW;AAAA,IACjC;AAAA,IAAW;AAAA,IAAW;AAAA,IAAW;AAAA,IACjC;AAAA,IAAW;AAAA,IAAW;AAAA,IAAW;AAAA,EACnC;AAGA,MAAM,qBAAqB;AAAA,IACzB,EAAE,OAAO,SAAS,OAAO,WAAQ;AAAA,IACjC,EAAE,OAAO,QAAQ,OAAO,UAAO;AAAA,IAC/B,EAAE,OAAO,SAAS,OAAO,WAAQ;AAAA,IACjC,EAAE,OAAO,SAAS,OAAO,WAAQ;AAAA,IACjC,EAAE,OAAO,SAAS,OAAO,WAAQ;AAAA,IACjC,EAAE,OAAO,SAAS,OAAO,WAAQ;AAAA,IACjC,EAAE,OAAO,UAAU,OAAO,YAAS;AAAA,EACrC;AAGA,MAAM,WAAW,EAAE,GAAG,IAAI,GAAG,IAAI,GAAG,GAAG;AAEhC,MAAM,mBAAN,cAA+B,eAAe;AAAA,IACnD,cAAc;AACZ,YAAM;AAEN,WAAK,SAAS;AACd,WAAK,UAAU;AACf,WAAK,QAAQ;AACb,WAAK,WAAW;AAChB,WAAK,UAAU;AACf,WAAK,gBAAgB;AACrB,WAAK,SAAS;AACd,WAAK,WAAW;AAGhB,WAAK,iBAAiB,SAAS,cAAc,QAAQ;AACrD,WAAK,OAAO,KAAK,eAAe,WAAW,IAAI;AAC/C,WAAK,iBAAiB;AACtB,WAAK,QAAQ;AACb,WAAK,eAAe;AAAA,IACtB;AAAA,IAEA,UAAU,QAAQ;AAChB,UAAI,CAAC,OAAO;AAAQ,cAAM,IAAI,MAAM,yBAAyB;AAC7D,WAAK,UAAU;AAAA,IAEjB;AAAA,IAEA,IAAI,KAAK,MAAM;AACb,YAAM,UAAU,CAAC,CAAC,KAAK;AACvB,WAAK,QAAQ;AAGb,UAAI,CAAC,SAAS;AAEZ,cAAM,CAAC,GAAGI,EAAC,IAAI,KAAK,cAAc;AAClC,aAAK,SAAS;AACd,aAAK,UAAUA;AACf,aAAK,eAAe,QAAQ;AAC5B,aAAK,eAAe,SAASA;AAC7B,aAAK,OAAO;AAAA,MACd;AAAA,IACF;AAAA,IAEA,SAAS;AACP,UAAI,CAAC,KAAK;AAAO;AAEjB,YAAM,SAAS,KAAK,UAAU;AAC9B,YAAM,OAAO,KAAK,KAAK;AACvB,YAAM,CAAC,aAAa,YAAY,IAAI,KAAK,cAAc;AAGvD,YAAM,oBAAoB,mBAAmB,IAAI,SAAO;AACtD,cAAM,WAAW,IAAI,UAAU,GAAG,KAAK,MAAM,IAAI,KAAK,OAAO,KAAK,aAAa;AAC/E,eAAO,kBAAkB,IAAI,KAAK,KAAK,QAAQ,IAAI,IAAI,KAAK;AAAA,MAC9D,CAAC,EAAE,KAAK,EAAE;AAGV,YAAM,kBAAkB,eAAe,IAAI,WAAS;AAClD,cAAM,SAAS,MAAM,YAAY,MAAM,KAAK,cAAc,YAAY,IAAI,WAAW;AACrF,eAAO,4BAA4B,MAAM,iBAAiB,KAAK,uBAAuB,KAAK;AAAA,MAC7F,CAAC,EAAE,KAAK,EAAE;AAEV,WAAK,WAAW,YAAY;AAAA;AAAA,UAEtB,gBAAgB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wCAwFc,OAAO,KAAK,KAAK;AAAA,gBACzC,KAAK,QAAQ,QAAQ,cAAc;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wCAOX,KAAK,UAAU,QAAQ,WAAW,EAAE;AAAA;AAAA;AAAA,wCAGpC,KAAK,UAAU,WAAW,WAAW,EAAE;AAAA;AAAA;AAAA;AAAA,gFAIC,KAAK,aAAa;AAAA,sCAC5D,KAAK,UAAU,WAAW,EAAE;AAAA;AAAA;AAAA;AAAA,gBAIlD,iBAAiB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cAMnB,eAAe;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,0BAUH,KAAK,KAAK,YAAY,KAAK,UAAU,QAAQ,MAAM;AAAA,4BACjD,WAAW,OAAI,YAAY;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qEAOc,KAAK,WAAW,aAAa,EAAE;AAAA,gBACpF,KAAK,WAAW,eAAe,gBAAgB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAU3D,WAAK,YAAY;AACjB,WAAK,iBAAiB;AAAA,IACxB;AAAA,IAEA,cAAc;AACZ,WAAK,iBAAiB,KAAK,WAAW,eAAe,eAAe;AACpE,UAAI,CAAC,KAAK;AAAgB;AAE1B,WAAK,QAAQ,KAAK,eAAe,WAAW,IAAI;AAGhD,UAAI,KAAK,eAAe,UAAU,KAAK,UAAU,KAAK,eAAe,WAAW,KAAK,SAAS;AAC5F,aAAK,eAAe,QAAQ,KAAK;AACjC,aAAK,eAAe,SAAS,KAAK;AAAA,MACpC;AAEA,WAAK,mBAAmB;AACxB,WAAK,eAAe;AACpB,WAAK,eAAe;AAAA,IACtB;AAAA,IAEA,qBAAqB;AACnB,UAAI,CAAC,KAAK;AAAgB;AAC1B,WAAK,eAAe,QAAQ,KAAK,SAAS,KAAK;AAC/C,WAAK,eAAe,SAAS,KAAK,UAAU,KAAK;AAAA,IACnD;AAAA,IAEA,iBAAiB;AACf,UAAI,CAAC,KAAK,SAAS,CAAC,KAAK;AAAM;AAE/B,WAAK,mBAAmB;AAGxB,WAAK,MAAM,YAAY;AACvB,WAAK,MAAM,SAAS,GAAG,GAAG,KAAK,eAAe,OAAO,KAAK,eAAe,MAAM;AAE/E,YAAM,UAAU,KAAK,KAAK,aAAa,GAAG,GAAG,KAAK,QAAQ,KAAK,OAAO,EAAE;AACxE,YAAM,WAAW,KAAK;AACtB,YAAM,YAAY,WAAW;AAE7B,eAAS,IAAI,GAAG,IAAI,KAAK,SAAS,KAAK;AACrC,iBAAS,IAAI,GAAG,IAAI,KAAK,QAAQ,KAAK;AACpC,gBAAM,OAAO,IAAI,KAAK,SAAS,KAAK;AACpC,gBAAMC,KAAI,QAAQ,GAAG;AACrB,gBAAM,IAAI,QAAQ,MAAM,CAAC;AACzB,gBAAM,IAAI,QAAQ,MAAM,CAAC;AACzB,gBAAMC,KAAI,QAAQ,MAAM,CAAC;AAEzB,gBAAM,aAAcA,OAAM;AAE1B,gBAAM,KAAK,IAAI;AACf,gBAAM,KAAK,IAAI;AACf,gBAAM,KAAK,KAAK,WAAW;AAC3B,gBAAM,KAAK,KAAK,WAAW;AAG3B,eAAK,MAAM,YAAY,OAAO,SAAS,CAAC,IAAI,SAAS,CAAC,IAAI,SAAS,CAAC;AACpE,eAAK,MAAM,SAAS,IAAI,IAAI,UAAU,QAAQ;AAE9C,cAAI,KAAK,SAAS;AAChB,gBAAI,CAAC,YAAY;AAEf,oBAAM,OAAO,KAAK,MAAM;AAAA,gBACtB;AAAA,gBAAI;AAAA,gBAAI,YAAY;AAAA,gBACpB;AAAA,gBAAI;AAAA,gBAAI,YAAY;AAAA,cACtB;AACA,mBAAK,aAAa,GAAG,QAAQD,EAAC,IAAI,CAAC,IAAI,CAAC,OAAO;AAC/C,mBAAK,aAAa,GAAG,QAAQA,EAAC,IAAI,CAAC,IAAI,CAAC,KAAK;AAC7C,mBAAK,MAAM,YAAY;AACvB,mBAAK,MAAM,UAAU;AACrB,mBAAK,MAAM,IAAI,IAAI,IAAI,YAAY,KAAK,GAAG,KAAK,KAAK,CAAC;AACtD,mBAAK,MAAM,KAAK;AAGhB,mBAAK,MAAM,YAAY,OAAOA,EAAC,IAAI,CAAC,IAAI,CAAC;AACzC,mBAAK,MAAM,UAAU;AACrB,mBAAK,MAAM,IAAI,IAAI,IAAI,WAAW,GAAG,KAAK,KAAK,CAAC;AAChD,mBAAK,MAAM,KAAK;AAAA,YAClB,OAAO;AAEL,mBAAK,MAAM,YAAY;AACvB,mBAAK,MAAM,UAAU;AACrB,mBAAK,MAAM,IAAI,IAAI,IAAI,WAAW,GAAG,KAAK,KAAK,CAAC;AAChD,mBAAK,MAAM,KAAK;AAAA,YAClB;AAAA,UACF,OAAO;AAEL,gBAAI,CAAC,YAAY;AACf,mBAAK,MAAM,YAAY,OAAOA,EAAC,IAAI,CAAC,IAAI,CAAC;AAAA,YAC3C,OAAO;AACL,mBAAK,MAAM,YAAY,OAAO,SAAS,CAAC,IAAI,SAAS,CAAC,IAAI,SAAS,CAAC;AAAA,YACtE;AACA,iBAAK,MAAM,SAAS,IAAI,IAAI,UAAU,QAAQ;AAAA,UAChD;AAAA,QACF;AAAA,MACF;AAAA,IACF;AAAA,IAEA,aAAa,KAAK;AAChB,UAAI,CAAC,KAAK;AAAgB,eAAO;AACjC,YAAM,OAAO,KAAK,eAAe,sBAAsB;AACvD,YAAM,QAAQ,KAAK,QAAQ,KAAK;AAChC,YAAM,QAAQ,KAAK,SAAS,KAAK;AAGjC,YAAM,UAAU,IAAI,UAAU,IAAI,QAAQ,CAAC,EAAE,UAAU,IAAI;AAC3D,YAAM,UAAU,IAAI,UAAU,IAAI,QAAQ,CAAC,EAAE,UAAU,IAAI;AAE3D,YAAM,IAAI,KAAK,OAAO,UAAU,KAAK,QAAQ,KAAK;AAClD,YAAM,IAAI,KAAK,OAAO,UAAU,KAAK,OAAO,KAAK;AAEjD,UAAI,IAAI,KAAK,IAAI,KAAK,KAAK,KAAK,UAAU,KAAK,KAAK;AAAS,eAAO;AACpE,aAAO,EAAE,GAAG,EAAE;AAAA,IAChB;AAAA,IAEA,QAAQ,KAAK;AACX,YAAM,IAAI,KAAK,aAAa,GAAG;AAC/B,UAAI,CAAC;AAAG;AAER,UAAI,KAAK,UAAU,OAAO;AACxB,aAAK,KAAK,YAAY,KAAK;AAC3B,aAAK,KAAK,SAAS,EAAE,GAAG,EAAE,GAAG,GAAG,CAAC;AAAA,MACnC,OAAO;AACL,aAAK,KAAK,UAAU,EAAE,GAAG,EAAE,GAAG,GAAG,CAAC;AAAA,MACpC;AACA,WAAK,eAAe;AAAA,IACtB;AAAA,IAEA,mBAAmB;AACjB,YAAM,SAAS,KAAK,WAAW,eAAe,eAAe;AAC7D,UAAI,CAAC;AAAQ;AAGb,aAAO,iBAAiB,aAAa,CAACE,OAAM;AAC1C,QAAAA,GAAE,eAAe;AACjB,aAAK,WAAW;AAChB,aAAK,QAAQA,EAAC;AAAA,MAChB,CAAC;AAED,aAAO,iBAAiB,aAAa,CAACA,OAAM;AAC1C,YAAI,KAAK;AAAU,eAAK,QAAQA,EAAC;AAAA,MACnC,CAAC;AAED,aAAO,iBAAiB,WAAW,MAAM;AACvC,aAAK,WAAW;AAAA,MAClB,CAAC;AAGD,aAAO,iBAAiB,cAAc,CAACA,OAAM;AAC3C,QAAAA,GAAE,eAAe;AACjB,aAAK,WAAW;AAChB,aAAK,QAAQA,EAAC;AAAA,MAChB,GAAG,EAAE,SAAS,MAAM,CAAC;AAErB,aAAO,iBAAiB,aAAa,CAACA,OAAM;AAC1C,QAAAA,GAAE,eAAe;AACjB,YAAI,KAAK;AAAU,eAAK,QAAQA,EAAC;AAAA,MACnC,GAAG,EAAE,SAAS,MAAM,CAAC;AAErB,aAAO,iBAAiB,YAAY,MAAM;AACxC,aAAK,WAAW;AAAA,MAClB,CAAC;AAGD,WAAK,WAAW,eAAe,UAAU,GAAG,iBAAiB,SAAS,MAAM;AAC1E,aAAK,QAAQ;AACb,aAAK,OAAO;AAAA,MACd,CAAC;AAED,WAAK,WAAW,eAAe,aAAa,GAAG,iBAAiB,SAAS,MAAM;AAC7E,aAAK,QAAQ;AACb,aAAK,OAAO;AAAA,MACd,CAAC;AAGD,WAAK,WAAW,eAAe,cAAc,GAAG,iBAAiB,SAAS,CAACA,OAAM;AAC/E,aAAK,gBAAgBA,GAAE,OAAO;AAC9B,aAAK,wBAAwB;AAAA,MAC/B,CAAC;AAGD,WAAK,WAAW,iBAAiB,eAAe,EAAE,QAAQ,YAAU;AAClE,eAAO,iBAAiB,SAAS,MAAM;AACrC,eAAK,gBAAgB,OAAO,QAAQ;AACpC,eAAK,WAAW,eAAe,cAAc,EAAE,QAAQ,KAAK;AAC5D,eAAK,wBAAwB;AAAA,QAC/B,CAAC;AAAA,MACH,CAAC;AAGD,WAAK,WAAW,eAAe,aAAa,GAAG,iBAAiB,SAAS,MAAM;AAC7E,aAAK,UAAU,CAAC,KAAK;AACrB,aAAK,OAAO;AAAA,MACd,CAAC;AAGD,WAAK,WAAW,eAAe,mBAAmB,GAAG,iBAAiB,UAAU,CAACA,OAAM;AACrF,cAAM,CAAC,GAAGH,EAAC,IAAIG,GAAE,OAAO,MAAM,MAAM,GAAG,EAAE,IAAI,OAAK,SAAS,GAAG,EAAE,CAAC;AACjE,aAAK,cAAc,GAAGH,EAAC;AAAA,MACzB,CAAC;AAGD,WAAK,WAAW,eAAe,WAAW,GAAG,iBAAiB,SAAS,MAAM;AAC3E,aAAK,aAAa;AAAA,MACpB,CAAC;AAGD,WAAK,WAAW,eAAe,YAAY,GAAG,iBAAiB,SAAS,MAAM;AAC5E,aAAK,WAAW,eAAe,YAAY,GAAG,MAAM;AAAA,MACtD,CAAC;AAGD,WAAK,WAAW,eAAe,YAAY,GAAG,iBAAiB,UAAU,CAACG,OAAM;AAC9E,cAAM,OAAOA,GAAE,OAAO,QAAQ,CAAC;AAC/B,YAAI;AAAM,eAAK,cAAc,IAAI;AAAA,MACnC,CAAC;AAGD,WAAK,WAAW,eAAe,UAAU,GAAG,iBAAiB,SAAS,MAAM;AAC1E,aAAK,cAAc;AAAA,MACrB,CAAC;AAAA,IACH;AAAA,IAEA,0BAA0B;AACxB,WAAK,WAAW,iBAAiB,eAAe,EAAE,QAAQ,YAAU;AAClE,YAAI,OAAO,QAAQ,MAAM,YAAY,MAAM,KAAK,cAAc,YAAY,GAAG;AAC3E,iBAAO,UAAU,IAAI,QAAQ;AAAA,QAC/B,OAAO;AACL,iBAAO,UAAU,OAAO,QAAQ;AAAA,QAClC;AAAA,MACF,CAAC;AAAA,IACH;AAAA,IAEA,cAAc,GAAGH,IAAG;AAElB,YAAM,UAAU,KAAK,KAAK,aAAa,GAAG,GAAG,KAAK,QAAQ,KAAK,OAAO;AAEtE,WAAK,SAAS;AACd,WAAK,UAAUA;AACf,WAAK,eAAe,QAAQ;AAC5B,WAAK,eAAe,SAASA;AAG7B,WAAK,KAAK,aAAa,SAAS,GAAG,CAAC;AAEpC,WAAK,mBAAmB;AACxB,WAAK,eAAe;AAGpB,YAAM,UAAU,KAAK,WAAW,cAAc,4BAA4B;AAC1E,UAAI,SAAS;AACX,gBAAQ,cAAc,SAAS,KAAK,KAAK,YAAY,KAAK,UAAU,QAAQ,MAAM;AAAA,MACpF;AAAA,IACF;AAAA,IAEA,eAAe;AACb,WAAK,KAAK,UAAU,GAAG,GAAG,KAAK,QAAQ,KAAK,OAAO;AACnD,WAAK,eAAe;AAAA,IACtB;AAAA,IAEA,cAAc,MAAM;AAClB,YAAM,SAAS,IAAI,WAAW;AAC9B,aAAO,SAAS,CAAC,OAAO;AACtB,cAAM,MAAM,IAAI,MAAM;AACtB,YAAI,SAAS,MAAM;AAEjB,eAAK,KAAK,UAAU,GAAG,GAAG,KAAK,QAAQ,KAAK,OAAO;AACnD,eAAK,KAAK,wBAAwB;AAClC,eAAK,KAAK,UAAU,KAAK,GAAG,GAAG,KAAK,QAAQ,KAAK,OAAO;AACxD,eAAK,eAAe;AAAA,QACtB;AACA,YAAI,MAAM,GAAG,OAAO;AAAA,MACtB;AACA,aAAO,cAAc,IAAI;AAAA,IAC3B;AAAA,IAEA,MAAM,gBAAgB;AACpB,UAAI,KAAK;AAAU;AAEnB,WAAK,WAAW;AAChB,WAAK,OAAO;AAEZ,UAAI;AACF,cAAM,UAAU,KAAK,KAAK,aAAa,GAAG,GAAG,KAAK,QAAQ,KAAK,OAAO,EAAE;AACxE,cAAM,SAAS,CAAC;AAEhB,iBAAS,IAAI,GAAG,IAAI,KAAK,SAAS,KAAK;AACrC,mBAAS,IAAI,GAAG,IAAI,KAAK,QAAQ,KAAK;AACpC,kBAAM,OAAO,IAAI,KAAK,SAAS,KAAK;AACpC,kBAAMC,KAAI,QAAQ,GAAG;AACrB,kBAAM,IAAI,QAAQ,MAAM,CAAC;AACzB,kBAAM,IAAI,QAAQ,MAAM,CAAC;AACzB,kBAAMC,KAAI,QAAQ,MAAM,CAAC;AAGzB,gBAAIA,KAAI,GAAG;AACT,qBAAO,KAAK;AAAA,gBACV;AAAA,gBACA;AAAA,gBACA,OAAO,KAAK,UAAUD,IAAG,GAAG,CAAC;AAAA,cAC/B,CAAC;AAAA,YACH;AAAA,UACF;AAAA,QACF;AAEA,YAAI,OAAO,SAAS,GAAG;AAErB,gBAAM,KAAK,YAAY,gBAAgB,cAAc;AAAA,YACnD;AAAA,UACF,CAAC;AAAA,QACH;AAAA,MACF,SAAS,KAAK;AACZ,gBAAQ,MAAM,oCAAoC,GAAG;AAAA,MACvD,UAAE;AACA,aAAK,WAAW;AAChB,aAAK,OAAO;AAAA,MACd;AAAA,IACF;AAAA,IAEA,UAAUA,IAAG,GAAG,GAAG;AACjB,cAASA,MAAK,KAAO,KAAK,IAAK,GAAG,SAAS,EAAE,EAAE,SAAS,GAAG,GAAG;AAAA,IAChE;AAAA,IAEA,OAAO,mBAAmB;AACxB,aAAO,SAAS,cAAc,sBAAsB;AAAA,IACtD;AAAA,IAEA,OAAO,gBAAgB;AACrB,aAAO,EAAE,QAAQ,GAAG;AAAA,IACtB;AAAA,IAEA,cAAc;AACZ,aAAO;AAAA,IACT;AAAA,EACF;;;ACvjBO,MAAM,qBAAN,cAAiC,YAAY;AAAA,IAClD,cAAc;AACZ,YAAM;AACN,WAAK,aAAa,EAAE,MAAM,OAAO,CAAC;AAAA,IACpC;AAAA,IAEA,UAAU,QAAQ;AAChB,WAAK,UAAU;AACf,WAAK,OAAO;AAAA,IACd;AAAA,IAEA,IAAI,KAAK,MAAM;AACb,WAAK,QAAQ;AACb,WAAK,OAAO;AAAA,IACd;AAAA,IAEA,SAAS;AACP,UAAI,CAAC,KAAK;AAAO;AACjB,YAAM,WAAW,OAAO,KAAK,KAAK,MAAM,MAAM,EAC3C,OAAO,CAAAG,OAAKA,GAAE,WAAW,OAAO,KAAKA,GAAE,WAAW,SAAS,CAAC,EAC5D,KAAK;AAER,WAAK,WAAW,YAAY;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,YAkBpB,SAAS,IAAI,CAAAA,OAAK;AAAA,6BACDA,EAAC,KAAK,KAAK,SAAS,WAAWA,KAAI,aAAa,EAAE;AAAA,gBAC/D,KAAK,MAAM,OAAOA,EAAC,GAAG,YAAY,iBAAiBA,EAAC;AAAA;AAAA,WAEzD,EAAE,KAAK,EAAE,CAAC;AAAA;AAAA;AAAA;AAAA;AAAA,8CAKyB,KAAK,SAAS,QAAQ,EAAE;AAAA;AAGlE,WAAK,WAAW,iBAAiB,eAAe,EAAE,QAAQ,QAAM;AAC9D,WAAG,iBAAiB,UAAU,MAAM,KAAK,WAAW,CAAC;AAAA,MACvD,CAAC;AAAA,IACH;AAAA,IAEA,aAAa;AACX,WAAK,cAAc,IAAI,YAAY,kBAAkB;AAAA,QACnD,QAAQ;AAAA,UACN,QAAQ;AAAA,YACN,MAAM,KAAK,SAAS,QAAQ;AAAA,YAC5B,QAAQ,KAAK,WAAW,eAAe,QAAQ,GAAG;AAAA,YAClD,MAAM,KAAK,WAAW,eAAe,MAAM,GAAG,SAAS;AAAA,UACzD;AAAA,QACF;AAAA,QACA,SAAS;AAAA,QACT,UAAU;AAAA,MACZ,CAAC,CAAC;AAAA,IACJ;AAAA,EACF;;;ACzDA,iBAAe,OAAO,uBAAuB,iBAAiB;AAC9D,iBAAe,OAAO,wBAAwB,kBAAkB;AAChE,iBAAe,OAAO,oBAAoB,cAAc;AACxD,iBAAe,OAAO,wBAAwB,kBAAkB;AAChE,iBAAe,OAAO,wBAAwB,kBAAkB;AAChE,iBAAe,OAAO,sBAAsB,gBAAgB;AAC5D,iBAAe,OAAO,wBAAwB,kBAAkB;AAGhE,SAAO,cAAc,OAAO,eAAe,CAAC;AAC5C;AAAA,IACE,EAAE,MAAM,uBAAuB,MAAM,kBAAkB,aAAa,wCAAwC;AAAA,IAC5G,EAAE,MAAM,wBAAwB,MAAM,mBAAmB,aAAa,6CAA6C;AAAA,IACnH,EAAE,MAAM,oBAAoB,MAAM,eAAe,aAAa,qCAAqC;AAAA,IACnG,EAAE,MAAM,wBAAwB,MAAM,mBAAmB,aAAa,sBAAsB;AAAA,IAC5F,EAAE,MAAM,wBAAwB,MAAM,mBAAmB,aAAa,gCAAgC;AAAA,IACtG,EAAE,MAAM,sBAAsB,MAAM,uBAAuB,aAAa,oDAAoD;AAAA,EAC9H,EAAE,QAAQ,UAAQ,OAAO,YAAY,KAAK;AAAA,IACxC,GAAG;AAAA,IACH,SAAS;AAAA,IACT,kBAAkB;AAAA,EACpB,CAAC,CAAC;AAGF,UAAQ;AAAA,IACN,sBAAsB,YAAY;AAAA,IAClC;AAAA,IACA;AAAA,EACF;",
  "names": ["a", "h", "r", "e", "pixels", "i", "r", "e", "n", "t", "r", "o", "i", "l", "s", "a", "h", "g", "v", "fontLoadPromises", "getHeightKey", "e", "i", "r", "h", "s", "r", "i", "t", "hsvToRgb", "h", "s", "r", "i", "t", "i", "r", "e", "e", "getHeightKey", "text", "h", "name", "s", "s", "n", "e", "i", "e", "e", "i", "o", "e", "s", "i", "h", "h", "r", "a", "e", "e"]
}
